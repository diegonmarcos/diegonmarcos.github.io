<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dev Mode Test Page</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        h1 {
            margin-top: 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #45a049;
        }
        button.error {
            background: #f44336;
        }
        button.error:hover {
            background: #da190b;
        }
        button.warn {
            background: #ff9800;
        }
        button.warn:hover {
            background: #e68900;
        }
        .info {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-size: 14px;
        }
        .badge {
            display: inline-block;
            background: #4CAF50;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ†Ô∏è Dev Mode Test Page</h1>

        <div class="info">
            <strong>‚úì Dev Mode Active</strong><br>
            This page demonstrates the auto-injected DevTools.<br>
            <br>
            <span class="badge">Eruda Loaded</span>
            <span class="badge">Console Logged</span>
            <span class="badge">Errors Tracked</span>
        </div>

        <h2>Test Console Logging</h2>
        <p>Click buttons to test different console methods. Check the browser console in Eruda (bottom-right icon) or view logs with:</p>
        <code style="background: rgba(0,0,0,0.3); padding: 5px 10px; border-radius: 3px; display: block; margin: 10px 0;">
            ./server.sh console-logs
        </code>

        <div style="margin: 20px 0;">
            <button onclick="testLog()">console.log()</button>
            <button onclick="testInfo()">console.info()</button>
            <button class="warn" onclick="testWarn()">console.warn()</button>
            <button class="error" onclick="testError()">console.error()</button>
            <button class="error" onclick="testUncaught()">Throw Error</button>
            <button class="error" onclick="testPromise()">Unhandled Promise</button>
        </div>

        <h2>Test Objects & Arrays</h2>
        <div style="margin: 20px 0;">
            <button onclick="testObject()">Log Object</button>
            <button onclick="testArray()">Log Array</button>
            <button onclick="testNested()">Log Nested Data</button>
        </div>

        <h2>Viewing Logs</h2>
        <div class="info" style="font-family: monospace; font-size: 12px;">
            # View last 20 logs<br>
            ./server.sh console-logs<br>
            <br>
            # View errors only<br>
            ./server.sh console-errors<br>
            <br>
            # Live tail<br>
            ./server.sh console-tail<br>
            <br>
            # View raw JSON<br>
            jq . browser-console.log
        </div>

        <h2>Features</h2>
        <ul>
            <li>‚úÖ Eruda DevTools auto-loaded (no script tag needed)</li>
            <li>‚úÖ All console output logged to JSONL file</li>
            <li>‚úÖ Uncaught errors tracked</li>
            <li>‚úÖ Promise rejections tracked</li>
            <li>‚úÖ Works with ANY HTML file</li>
            <li>‚úÖ Pure POSIX shell implementation</li>
        </ul>

        <footer style="margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.2); font-size: 12px; opacity: 0.7;">
            Dev Mode powered by Eruda + log-receiver.sh + dev-server.sh
        </footer>
    </div>

    <script>
        // Test functions
        function testLog() {
            console.log('This is a regular log message', new Date());
        }

        function testInfo() {
            console.info('This is an info message with details:', {
                browser: navigator.userAgent,
                timestamp: Date.now()
            });
        }

        function testWarn() {
            console.warn('This is a warning! Something might be wrong.', {
                level: 'warning',
                code: 'WARN_001'
            });
        }

        function testError() {
            console.error('This is an error message!', {
                type: 'TestError',
                message: 'Something went wrong',
                stack: new Error().stack
            });
        }

        function testUncaught() {
            // This will throw an uncaught error
            throw new Error('Uncaught error test - this should be logged!');
        }

        function testPromise() {
            // Unhandled promise rejection
            Promise.reject('Unhandled promise rejection test');
        }

        function testObject() {
            console.log('User object:', {
                id: 123,
                name: 'Test User',
                email: 'test@example.com',
                active: true,
                roles: ['admin', 'user']
            });
        }

        function testArray() {
            console.log('Array data:', [1, 2, 3, 4, 5], ['a', 'b', 'c']);
        }

        function testNested() {
            console.log('Nested structure:', {
                user: {
                    profile: {
                        name: 'John Doe',
                        settings: {
                            theme: 'dark',
                            notifications: true
                        }
                    },
                    posts: [
                        { id: 1, title: 'First Post' },
                        { id: 2, title: 'Second Post' }
                    ]
                }
            });
        }

        // Log page load
        console.log('%c[TEST PAGE] Loaded successfully', 'color: green; font-weight: bold');
        console.info('Page URL:', window.location.href);
        console.info('User Agent:', navigator.userAgent);
    </script>
</body>
</html>
