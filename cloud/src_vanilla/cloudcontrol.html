<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Control | Cloud Portal</title>

    <!-- Matomo Tag Manager -->
    <script>
      var _mtm = window._mtm = window._mtm || [];
      _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
      (function() {
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src='https://analytics.diegonmarcos.com/js/container_odwLIyPV.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Tag Manager -->

    <link rel="stylesheet" href="styles.css">
    <style>:root,[data-theme=minimalistic]{--bg-primary: #000000;--bg-secondary: #0a0a0a;--bg-card: #111111;--bg-card-hover: #1a1a1a;--text-primary: #ffffff;--text-secondary: #888888;--accent-primary: #ff6600;--accent-orange: #ff6600;--accent-blue: #3399ff;--accent-green: #00cc66;--accent-yellow: #ffcc00;--accent-red: #ff3333;--accent-purple: #8b5cf6;--border-color: #333333;--border-highlight: #ff6600;--shadow: rgba(0, 0, 0, 0.5);--glow: rgba(255, 102, 0, 0.3);--font-mono: 'Consolas', 'Monaco', 'Courier New', monospace;--font-main: var(--font-mono);--border-radius: 0px;--border-radius-lg: 0px;--card-padding: 1rem;--transition-speed: 0.15s}[data-theme=blurred]{--bg-primary: #0a0e27;--bg-secondary: #151a33;--bg-card: rgba(26, 31, 58, 0.8);--bg-card-hover: rgba(35, 42, 74, 0.9);--text-primary: #e0e6ff;--text-secondary: #8b95c9;--accent-primary: #4a9eff;--accent-orange: #ff6b35;--accent-blue: #4a9eff;--accent-green: #10b981;--accent-yellow: #fbbf24;--accent-red: #ef4444;--accent-purple: #8b5cf6;--border-color: rgba(255, 255, 255, 0.1);--border-highlight: #4a9eff;--shadow: rgba(0, 0, 0, 0.3);--glow: rgba(74, 158, 255, 0.4);--font-mono: 'Consolas', 'Monaco', 'Courier New', monospace;--font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;--border-radius: 12px;--border-radius-lg: 16px;--card-padding: 1.5rem;--transition-speed: 0.3s}*{margin:0;padding:0;box-sizing:border-box}html,body{height:100%;width:100%;overflow-x:auto}html{min-width:1200px}body{font-family:var(--font-main);background:var(--bg-primary);color:var(--text-primary);min-height:100vh;min-width:1200px;padding:1rem;display:flex;flex-direction:column;font-size:clamp(12px,.9vw,14px);line-height:1.4;transition:background var(--transition-speed) ease,color var(--transition-speed) ease}[data-theme=blurred] body{background:linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);font-size:clamp(13px,1vw,15px);padding:2rem}.container{width:100%;max-width:100%;margin:0 auto;flex:1;display:flex;flex-direction:column}[data-theme=blurred] .container{max-width:1400px}#cards-view{max-width:1600px;width:100%;margin:0 auto}#tree-view{width:100%;overflow-x:auto}#architecture-view{flex:1;width:100%}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes fadeInDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}@keyframes slideIn{from{transform:translateX(400px);opacity:0}to{transform:translateX(0);opacity:1}}@keyframes slideOut{from{transform:translateX(0);opacity:1}to{transform:translateX(400px);opacity:0}}@keyframes slideInScale{from{opacity:0;transform:scale(0.9) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}header{text-align:center;margin-bottom:1.5rem;animation:fadeInDown .6s ease-out}header h1{font-size:1.5rem;font-weight:700;color:var(--accent-primary);text-transform:uppercase;letter-spacing:2px;margin-bottom:.25rem;transition:all var(--transition-speed) ease}[data-theme=blurred] header{margin-bottom:3rem}[data-theme=blurred] header h1{font-size:3rem;text-transform:none;letter-spacing:normal;background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));-webkit-background-clip:text;-webkit-text-fill-color:rgba(0,0,0,0);background-clip:text}.subtitle{color:var(--text-secondary);font-size:.85rem;text-transform:uppercase;letter-spacing:1px;transition:all var(--transition-speed) ease}[data-theme=blurred] .subtitle{font-size:1.2rem;text-transform:none;letter-spacing:normal;font-weight:300}.section-header{text-align:left;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid var(--border-color);transition:all var(--transition-speed) ease}.section-header h2{font-size:1rem;font-weight:600;color:var(--accent-primary);text-transform:uppercase;letter-spacing:1px;transition:all var(--transition-speed) ease}[data-theme=blurred] .section-header{text-align:center;margin-bottom:2rem;border-bottom:none;padding-bottom:0}[data-theme=blurred] .section-header h2{font-size:2rem;text-transform:none;letter-spacing:normal;background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));-webkit-background-clip:text;-webkit-text-fill-color:rgba(0,0,0,0);background-clip:text}.theme-toggle{position:fixed;top:1rem;right:1rem;z-index:1000;display:flex;align-items:center;justify-content:center;width:36px;height:36px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--text-secondary);cursor:pointer;transition:all .3s ease;border-radius:50%}.theme-toggle svg{width:18px;height:18px;transition:transform .5s ease,color .3s ease}.theme-toggle .theme-label{position:absolute;right:100%;margin-right:.5rem;font-family:var(--font-mono);font-size:.7rem;text-transform:uppercase;white-space:nowrap;opacity:0;transform:translateX(10px);transition:opacity .2s ease,transform .2s ease;pointer-events:none}.theme-toggle:hover{color:var(--accent-primary);background:var(--bg-card)}.theme-toggle:hover svg{transform:rotate(180deg)}.theme-toggle:hover .theme-label{opacity:1;transform:translateX(0)}[data-theme=blurred] .theme-toggle{color:var(--text-secondary)}[data-theme=blurred] .theme-toggle:hover{color:var(--accent-blue);background:hsla(0,0%,100%,.1);box-shadow:0 0 20px var(--glow)}[data-theme=blurred] .theme-toggle:hover svg{filter:drop-shadow(0 0 8px var(--accent-blue))}.zoom-controls{position:fixed;top:3.5rem;right:1rem;z-index:1000;display:flex;align-items:center;gap:.25rem;background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--border-radius);padding:.25rem;opacity:.7;transition:all .3s ease}.zoom-controls:hover{opacity:1;border-color:var(--accent-primary)}[data-theme=blurred] .zoom-controls{background:rgba(26,31,58,.9);backdrop-filter:blur(10px);border-radius:20px;padding:.35rem}[data-theme=blurred] .zoom-controls:hover{border-color:var(--accent-blue);box-shadow:0 0 20px var(--glow)}.zoom-btn{display:flex;align-items:center;justify-content:center;width:28px;height:28px;padding:0;border:none;background:rgba(0,0,0,0);color:var(--text-secondary);cursor:pointer;transition:all .2s ease;border-radius:4px}.zoom-btn svg{width:16px;height:16px}.zoom-btn:hover:not(:disabled){color:var(--accent-primary);background:var(--bg-primary)}.zoom-btn:disabled{opacity:.3;cursor:not-allowed}[data-theme=blurred] .zoom-btn{border-radius:50%}[data-theme=blurred] .zoom-btn:hover:not(:disabled){color:var(--accent-blue);background:hsla(0,0%,100%,.1)}.zoom-level{font-family:var(--font-mono);font-size:.65rem;color:var(--text-secondary);min-width:32px;text-align:center;user-select:none}[data-theme=blurred] .zoom-level{font-size:.7rem}.cards-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(var(--card-min-width, 220px), 1fr));gap:calc(1rem*var(--zoom-scale, 1));animation:fadeIn .8s ease-out}[data-theme=blurred] .cards-grid{grid-template-columns:repeat(auto-fit, minmax(var(--card-min-width, 280px), 1fr));gap:calc(2rem*var(--zoom-scale, 1))}.card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--border-radius);padding:calc(var(--card-padding)*var(--zoom-scale, 1));cursor:pointer;transition:all .3s ease,transform .3s ease;position:relative;text-decoration:none;display:block;transform-origin:center center;z-index:1}.card:hover{background:var(--bg-card-hover);border-color:var(--border-highlight);transform:scale(var(--hover-scale, 2));z-index:100;box-shadow:0 20px 60px rgba(0,0,0,.7)}.card:hover .card-icon{color:var(--accent-primary)}.card:hover h3{color:var(--accent-primary)}.card:hover .card-status.online{background:var(--accent-green);color:#000}.card.card-link{text-decoration:none;color:inherit}[data-theme=blurred] .card{border-radius:var(--border-radius-lg);overflow:hidden;backdrop-filter:blur(10px)}[data-theme=blurred] .card::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));opacity:0;transition:opacity .4s ease;z-index:0}[data-theme=blurred] .card::after{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);opacity:0;transition:opacity .4s ease;pointer-events:none}[data-theme=blurred] .card:hover{transform:scale(var(--hover-scale, 2));box-shadow:0 25px 80px var(--shadow),0 0 50px var(--glow);border-color:var(--accent-blue)}[data-theme=blurred] .card:hover::before{opacity:.1}[data-theme=blurred] .card:hover::after{opacity:1}[data-theme=blurred] .card:hover .card-icon{filter:drop-shadow(0 0 12px var(--accent-blue))}[data-theme=blurred] .card:hover h3{color:var(--accent-blue)}[data-theme=blurred] .card:hover p{color:var(--text-primary)}[data-theme=blurred] .card:hover .card-status.online{background:rgba(16,185,129,.25);color:var(--accent-green);box-shadow:0 0 15px rgba(16,185,129,.3)}[data-theme=blurred] .card>*{position:relative;z-index:1}.card-icon{width:calc(32px*var(--zoom-scale, 1));height:calc(32px*var(--zoom-scale, 1));margin-bottom:calc(.75rem*var(--zoom-scale, 1));color:var(--accent-blue);transition:all var(--transition-speed) ease}.card-icon svg{width:100%;height:100%}[data-theme=blurred] .card-icon{width:calc(60px*var(--zoom-scale, 1));height:calc(60px*var(--zoom-scale, 1));margin-bottom:calc(1.5rem*var(--zoom-scale, 1))}.card h3{font-size:calc(.95rem*var(--zoom-scale, 1));margin-bottom:calc(.25rem*var(--zoom-scale, 1));font-weight:600;text-transform:uppercase;letter-spacing:.5px;transition:color var(--transition-speed) ease}[data-theme=blurred] .card h3{font-size:calc(1.5rem*var(--zoom-scale, 1));text-transform:none;letter-spacing:normal;margin-bottom:calc(.75rem*var(--zoom-scale, 1))}.card p{color:var(--text-secondary);font-size:calc(.8rem*var(--zoom-scale, 1));margin-bottom:calc(.75rem*var(--zoom-scale, 1));transition:color var(--transition-speed) ease}[data-theme=blurred] .card p{font-size:calc(.95rem*var(--zoom-scale, 1));line-height:1.6;margin-bottom:calc(1.5rem*var(--zoom-scale, 1))}.card-status{display:inline-block;padding:calc(.2rem*var(--zoom-scale, 1)) calc(.5rem*var(--zoom-scale, 1));font-size:calc(.7rem*var(--zoom-scale, 1));font-weight:600;text-transform:uppercase;letter-spacing:.5px;transition:all var(--transition-speed) ease;border-radius:var(--border-radius)}.card-status.online{background:rgba(0,0,0,0);color:var(--accent-green);border:1px solid var(--accent-green)}.card-status.pending{background:rgba(0,0,0,0);color:var(--accent-yellow);border:1px solid var(--accent-yellow)}[data-theme=blurred] .card-status{padding:calc(.4rem*var(--zoom-scale, 1)) calc(1rem*var(--zoom-scale, 1));font-size:calc(.85rem*var(--zoom-scale, 1));border-radius:20px}[data-theme=blurred] .card-status.online{background:rgba(16,185,129,.15);border-color:rgba(16,185,129,.3)}[data-theme=blurred] .card-status.pending{background:rgba(251,191,36,.15);border-color:rgba(251,191,36,.3)}.card-actions{margin-top:calc(.5rem*var(--zoom-scale, 1));padding-top:calc(.5rem*var(--zoom-scale, 1));border-top:1px solid var(--border-color)}[data-theme=blurred] .card-actions{margin-top:calc(1rem*var(--zoom-scale, 1));padding-top:calc(1rem*var(--zoom-scale, 1))}.code-with-copy{display:flex;align-items:center;gap:calc(.5rem*var(--zoom-scale, 1));background:var(--bg-primary);padding:calc(.4rem*var(--zoom-scale, 1)) calc(.5rem*var(--zoom-scale, 1));border:1px solid var(--border-color);border-radius:var(--border-radius)}[data-theme=blurred] .code-with-copy{background:rgba(0,0,0,.3);border-radius:8px;padding:calc(.75rem*var(--zoom-scale, 1)) calc(1rem*var(--zoom-scale, 1))}.card-code{font-family:var(--font-mono);font-size:calc(.65rem*var(--zoom-scale, 1));color:var(--accent-orange);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[data-theme=blurred] .card-code{color:var(--accent-green);font-size:calc(.75rem*var(--zoom-scale, 1))}.copy-icon{background:none;border:none;color:var(--text-secondary);cursor:pointer;padding:calc(.25rem*var(--zoom-scale, 1));display:flex;align-items:center;justify-content:center;transition:color var(--transition-speed) ease}.copy-icon svg{width:calc(14px*var(--zoom-scale, 1));height:calc(14px*var(--zoom-scale, 1))}.copy-icon:hover{color:var(--accent-primary)}.copy-icon:disabled{opacity:.3;cursor:not-allowed}.vm-buttons{display:flex;gap:calc(.5rem*var(--zoom-scale, 1));margin-top:calc(.5rem*var(--zoom-scale, 1))}.vm-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:calc(.25rem*var(--zoom-scale, 1));padding:calc(.4rem*var(--zoom-scale, 1));background:var(--bg-primary);border:1px solid var(--border-color);border-radius:var(--border-radius);color:var(--text-secondary);font-family:var(--font-mono);font-size:calc(.55rem*var(--zoom-scale, 1));text-transform:uppercase;cursor:pointer;transition:all var(--transition-speed) ease}.vm-btn svg{width:calc(12px*var(--zoom-scale, 1));height:calc(12px*var(--zoom-scale, 1))}.vm-btn:hover:not(:disabled){border-color:var(--accent-primary);color:var(--accent-primary)}.vm-btn:disabled{opacity:.3;cursor:not-allowed}[data-theme=blurred] .vm-btn{border-radius:8px;padding:calc(.5rem*var(--zoom-scale, 1)) calc(.75rem*var(--zoom-scale, 1));backdrop-filter:blur(5px);background:hsla(0,0%,100%,.05);font-size:calc(.6rem*var(--zoom-scale, 1))}[data-theme=blurred] .vm-btn:hover:not(:disabled){background:rgba(74,158,255,.1);border-color:var(--accent-blue);color:var(--accent-blue);box-shadow:0 0 15px rgba(74,158,255,.2)}.card:nth-child(1){animation:fadeIn .4s ease-out .1s backwards}.card:nth-child(2){animation:fadeIn .4s ease-out .2s backwards}.card:nth-child(3){animation:fadeIn .4s ease-out .3s backwards}.card:nth-child(4){animation:fadeIn .4s ease-out .4s backwards}.card:nth-child(5){animation:fadeIn .4s ease-out .5s backwards}.card:nth-child(6){animation:fadeIn .4s ease-out .6s backwards}.card:nth-child(7){animation:fadeIn .4s ease-out .7s backwards}.card:nth-child(8){animation:fadeIn .4s ease-out .8s backwards}.card:nth-child(9){animation:fadeIn .4s ease-out .9s backwards}.card:nth-child(10){animation:fadeIn .4s ease-out 1s backwards}.view-toggle{display:flex;justify-content:center;gap:.5rem;margin-top:1rem}[data-theme=blurred] .view-toggle{gap:.75rem}.tree-controls{display:flex;justify-content:center;align-items:center;gap:.5rem;margin-bottom:1rem;padding-top:.5rem}.tree-controls-group{display:flex;gap:.25rem}.tree-controls-sep{width:1px;height:24px;background:var(--border-color);margin:0 .5rem}.tree-filter-btn{padding:.25rem .5rem;border:1px solid var(--border-color);background:var(--bg-card);color:var(--text-secondary);font-family:var(--font-mono);font-size:.7rem;text-transform:uppercase;cursor:pointer;transition:all var(--transition-speed) ease;border-radius:var(--border-radius)}.tree-filter-btn:hover{border-color:var(--accent-primary);color:var(--accent-primary)}.tree-filter-btn.active{background:var(--accent-primary);border-color:var(--accent-primary);color:#000}[data-theme=blurred] .tree-controls-sep{background:hsla(0,0%,100%,.1)}[data-theme=blurred] .tree-filter-btn{border-radius:12px;backdrop-filter:blur(10px);background:hsla(0,0%,100%,.05)}[data-theme=blurred] .tree-filter-btn:hover{background:hsla(0,0%,100%,.1);border-color:var(--accent-blue);color:var(--accent-blue)}[data-theme=blurred] .tree-filter-btn.active{background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));border-color:rgba(0,0,0,0);color:#fff}.tree-ctrl-btn{display:flex;align-items:center;gap:.25rem;padding:.3rem .6rem;border:1px solid var(--border-color);background:var(--bg-card);color:var(--text-secondary);font-family:var(--font-mono);font-size:.75rem;text-transform:uppercase;cursor:pointer;transition:all var(--transition-speed) ease;border-radius:var(--border-radius)}.tree-ctrl-btn svg{width:12px;height:12px}.tree-ctrl-btn:hover{border-color:var(--accent-primary);color:var(--accent-primary)}[data-theme=blurred] .tree-ctrl-btn{border-radius:15px;backdrop-filter:blur(10px);background:hsla(0,0%,100%,.05)}[data-theme=blurred] .tree-ctrl-btn:hover{background:hsla(0,0%,100%,.1);border-color:var(--accent-blue);color:var(--accent-blue)}.view-btn{display:flex;align-items:center;gap:.25rem;padding:.4rem .8rem;border:1px solid var(--border-color);background:var(--bg-card);color:var(--text-secondary);font-family:var(--font-mono);font-size:.8rem;text-transform:uppercase;cursor:pointer;transition:all var(--transition-speed) ease;border-radius:var(--border-radius)}.view-btn svg{width:14px;height:14px}.view-btn:hover{border-color:var(--accent-primary);color:var(--text-primary)}.view-btn.active{background:var(--accent-primary);border-color:var(--accent-primary);color:#000}[data-theme=blurred] .view-btn{border-radius:20px;padding:.5rem 1rem;backdrop-filter:blur(10px);background:hsla(0,0%,100%,.05);text-transform:none}[data-theme=blurred] .view-btn:hover{background:hsla(0,0%,100%,.1);border-color:var(--accent-blue)}[data-theme=blurred] .view-btn.active{background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));border-color:rgba(0,0,0,0);color:#fff}.view-group{display:flex;flex-direction:column;align-items:center;gap:.35rem}.view-group-label{font-size:.6rem;font-family:var(--font-mono);text-transform:uppercase;letter-spacing:1px;color:var(--text-secondary);opacity:.6}.view-group-buttons{display:flex;gap:.25rem}[data-theme=blurred] .view-group-label{font-size:.65rem;letter-spacing:1.5px;opacity:.5}[data-theme=blurred] .view-group-buttons{gap:.5rem}.view-separator{width:1px;height:40px;background:var(--border-color);margin:0 .75rem;opacity:.4;align-self:center}[data-theme=blurred] .view-separator{background:linear-gradient(180deg, transparent, var(--border-color), transparent);height:50px;opacity:.3;margin:0 1.5rem}.view-content{display:none}.view-content.active{display:block}#tree-view{width:100%}.tree-container{font-family:var(--font-mono);font-size:.8rem;padding:1rem 0}.tree-section{margin-bottom:1.5rem}.tree-section-header{display:flex;align-items:center;gap:.75rem;padding:.5rem 0;margin-bottom:.5rem;border-bottom:1px solid var(--border-color)}.tree-section-header .section-icon{font-size:1rem}.tree-section-header .section-title{font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:1.5px;color:var(--text-secondary)}.tree-list{list-style:none;padding:0;margin:0}.tree-item,.tree-node{position:relative}.tree-item::before,.tree-node::before{content:"";position:absolute;left:0;top:0;bottom:0;width:1px;background:var(--border-color)}.tree-item:last-child::before,.tree-node:last-child::before{height:1.1rem}.tree-row,.node-header{display:flex;align-items:center;gap:.5rem;padding:.35rem .5rem;margin-left:1rem;position:relative;transition:background .15s ease;border-radius:4px}.tree-row::before,.node-header::before{content:"";position:absolute;left:-1rem;top:50%;width:.75rem;height:1px;background:var(--border-color)}.tree-row:hover,.node-header:hover{background:var(--bg-card-hover)}.tree-row:hover .tree-actions,.node-header:hover .tree-actions{opacity:1}.tree-item[data-level="0"]>.tree-row,.tree-item[data-level="0"]>.node-header,[data-level="0"].tree-node>.tree-row,[data-level="0"].tree-node>.node-header{margin-left:0}.tree-item[data-level="0"]>.tree-row::before,.tree-item[data-level="0"]>.node-header::before,[data-level="0"].tree-node>.tree-row::before,[data-level="0"].tree-node>.node-header::before{display:none}.tree-item[data-level="0"]::before,[data-level="0"].tree-node::before{display:none}.tree-item[data-level="1"],[data-level="1"].tree-node{padding-left:1.5rem}.tree-item[data-level="2"],[data-level="2"].tree-node{padding-left:3rem}.tree-item[data-level="3"],[data-level="3"].tree-node{padding-left:4.5rem}.tree-toggle,.expand-icon{width:16px;height:16px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-secondary);flex-shrink:0}.tree-toggle:hover,.expand-icon:hover{color:var(--accent-primary)}.tree-toggle svg,.expand-icon svg{width:10px;height:10px;transition:transform .15s ease}.tree-toggle.expanded svg,.expanded.expand-icon svg{transform:rotate(90deg)}.tree-toggle.empty,.empty.expand-icon{visibility:hidden}.tree-status{width:8px;height:8px;border-radius:50%;flex-shrink:0}.tree-status.on{background:var(--accent-green);box-shadow:0 0 6px var(--accent-green)}.tree-status.dev{background:var(--accent-yellow)}.tree-status.hold{background:var(--accent-orange)}.tree-status.tbd{background:var(--text-secondary);opacity:.4}.tree-status.offline{background:var(--accent-red)}.tree-icon{font-size:.9rem;flex-shrink:0;width:18px;text-align:center}.tree-label,.node-title{color:var(--text-primary);flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tree-label.category,.category.node-title{color:var(--text-secondary);font-size:.7rem;text-transform:uppercase;letter-spacing:.5px}.tree-label.provider,.provider.node-title{font-weight:600;font-size:.85rem}.tree-label.vm,.vm.node-title{color:var(--accent-blue)}.tree-type{font-size:.6rem;padding:.1rem .35rem;background:var(--bg-secondary);border:1px solid var(--border-color);color:var(--text-secondary);border-radius:3px;text-transform:uppercase;flex-shrink:0}.tree-actions{display:flex;gap:.25rem;opacity:0;transition:opacity .15s ease;flex-shrink:0}.tree-action-btn,.node-copy-btn,.node-url-btn{width:22px;height:22px;display:flex;align-items:center;justify-content:center;background:var(--bg-card);border:1px solid var(--border-color);border-radius:4px;color:var(--text-secondary);cursor:pointer;transition:all .15s ease}.tree-action-btn svg,.node-copy-btn svg,.node-url-btn svg{width:12px;height:12px}.tree-action-btn:hover,.node-copy-btn:hover,.node-url-btn:hover{border-color:var(--accent-primary);color:var(--accent-primary)}.tree-action-btn.url-btn:hover,.url-btn.node-copy-btn:hover,.url-btn.node-url-btn:hover{border-color:var(--accent-blue);color:var(--accent-blue)}.tree-action-btn:disabled,.node-copy-btn:disabled,.node-url-btn:disabled{opacity:.3;cursor:not-allowed}.tree-action-btn.copied,.copied.node-copy-btn,.copied.node-url-btn{border-color:var(--accent-green);color:var(--accent-green)}.tree-children{display:none}.tree-children.expanded{display:block}.vm-card-grid{display:grid;grid-template-columns:repeat(3, 1fr);gap:.75rem;padding:.5rem 0}.vm-box{background:var(--bg-card);border:1px solid var(--border-color);border-radius:6px;overflow:hidden}.vm-box.box-services{border-left:3px solid var(--accent-blue)}.vm-box.box-data{border-left:3px solid var(--accent-purple)}.vm-box.box-os{border-left:3px solid var(--accent-green)}.vm-box-header{display:flex;align-items:center;gap:.5rem;padding:.4rem .6rem;background:var(--bg-secondary);border-bottom:1px solid var(--border-color);font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--text-secondary)}.vm-box-header .box-icon{font-size:.8rem}.vm-box-content{padding:.4rem}.vm-box-section:not(:last-child){margin-bottom:.5rem;padding-bottom:.5rem;border-bottom:1px dashed var(--border-color)}.vm-box-section-label{font-size:.55rem;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary);opacity:.7;padding:.15rem .3rem;margin-bottom:.2rem}.vm-item{display:flex;align-items:center;gap:.4rem;padding:.3rem .4rem;border-radius:4px;transition:background .15s ease}.vm-item:hover{background:var(--bg-card-hover)}.vm-item-status{width:8px;height:8px;border-radius:50%;flex-shrink:0;opacity:.5}.vm-item-status.on{background:var(--accent-green)}.vm-item-status.offline{background:var(--accent-red)}.vm-item-status.dev{background:var(--accent-yellow)}.vm-item-status.hold{background:var(--accent-orange)}.vm-item-status.tbd{background:var(--text-secondary);opacity:.3}.vm-item-name{font-size:.7rem;color:var(--text-primary);flex:1;min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vm-live-status{width:8px;height:8px;border-radius:50%;flex-shrink:0;margin-right:.3rem}.vm-live-status.online{background:var(--accent-green);box-shadow:0 0 6px var(--accent-green);animation:pulse-green 2s ease-in-out infinite}.vm-live-status.offline{background:var(--accent-red);box-shadow:0 0 6px var(--accent-red)}.vm-live-status.unknown{background:var(--text-secondary);opacity:.4}@keyframes pulse-green{0%,100%{box-shadow:0 0 4px var(--accent-green)}50%{box-shadow:0 0 10px var(--accent-green)}}.vm-item-actions{display:flex;align-items:center;gap:.2rem;flex-shrink:0}.vm-action-btn{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:3px;color:var(--text-secondary);cursor:pointer;transition:all .15s ease;opacity:.5}.vm-action-btn svg{width:10px;height:10px}.vm-action-btn:hover{opacity:1;border-color:var(--accent-primary);color:var(--accent-primary)}.vm-action-btn.btn-url:hover{border-color:var(--accent-blue);color:var(--accent-blue)}.vm-action-btn.btn-ssh:hover{border-color:var(--accent-green);color:var(--accent-green)}.vm-action-btn:disabled{opacity:.2;cursor:not-allowed}.vm-action-btn:disabled:hover{border-color:var(--border-color);color:var(--text-secondary)}.vm-action-btn.copied{border-color:var(--accent-green);color:var(--accent-green);opacity:1}.vm-os-info{display:flex;align-items:center;gap:.5rem;padding:.4rem}.vm-os-info .os-icon{font-size:1.2rem}.vm-os-info .os-details{flex:1}.vm-os-info .os-details .os-name{font-size:.75rem;font-weight:600;color:var(--text-primary)}.vm-os-info .os-details .os-ip{font-size:.65rem;color:var(--text-secondary);font-family:var(--font-mono)}.os-subsection{padding:.3rem .4rem;border-top:1px dashed var(--border-color)}.os-subsection:first-of-type{margin-top:.3rem}.os-subsection-header{display:flex;align-items:center;gap:.3rem;font-size:.55rem;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary);opacity:.8;margin-bottom:.2rem}.os-subsection-header .subsection-icon{font-size:.65rem}.os-subsection-items{display:flex;flex-wrap:wrap;gap:.25rem}.os-tag{display:inline-flex;align-items:center;gap:.2rem;padding:.15rem .4rem;font-size:.6rem;font-family:var(--font-mono);border-radius:3px;background:var(--bg-secondary);border:1px solid var(--border-color);color:var(--text-secondary)}.os-tag.tag-network{border-color:rgba(138,180,248,.3);color:var(--accent-blue)}.os-tag.tag-partition{border-color:rgba(129,199,132,.3);color:var(--accent-green)}[data-theme=blurred] .vm-box{background:hsla(0,0%,100%,.03);backdrop-filter:blur(10px);border-color:hsla(0,0%,100%,.08);border-radius:10px}[data-theme=blurred] .vm-box.box-services{border-left-color:var(--accent-blue)}[data-theme=blurred] .vm-box.box-data{border-left-color:var(--accent-purple)}[data-theme=blurred] .vm-box.box-os{border-left-color:var(--accent-green)}[data-theme=blurred] .vm-box-header{background:hsla(0,0%,100%,.02);border-bottom-color:hsla(0,0%,100%,.06)}[data-theme=blurred] .vm-box-section{border-bottom-color:hsla(0,0%,100%,.05)}[data-theme=blurred] .vm-item:hover{background:hsla(0,0%,100%,.05)}[data-theme=blurred] .vm-action-btn{background:hsla(0,0%,100%,.02);border-color:hsla(0,0%,100%,.1)}[data-theme=blurred] .vm-action-btn:hover{background:hsla(0,0%,100%,.08)}.tree-columns{display:flex;gap:1.5rem;padding:.5rem 0}.tree-columns .tree-column{flex:1;min-width:0}.tree-columns .tree-column .column-header{font-size:.65rem;text-transform:uppercase;letter-spacing:1px;color:var(--text-secondary);padding:.25rem .5rem;margin-bottom:.25rem;border-bottom:1px solid var(--border-color)}.tree-columns .tree-column .column-items{display:flex;flex-direction:column;gap:.15rem}.tree-service{display:flex;align-items:center;gap:.4rem;padding:.25rem .4rem;border-radius:4px;transition:background .15s ease}.tree-service:hover{background:var(--bg-card-hover)}.tree-service:hover .tree-actions{opacity:1}.tree-service .service-status{width:6px;height:6px;border-radius:50%;flex-shrink:0}.tree-service .service-status.on{background:var(--accent-green);box-shadow:0 0 4px var(--accent-green)}.tree-service .service-status.dev{background:var(--accent-yellow)}.tree-service .service-status.hold{background:var(--accent-orange)}.tree-service .service-status.tbd{background:var(--text-secondary);opacity:.4}.tree-service .service-name{font-size:.75rem;color:var(--text-primary);min-width:10rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tree-service .tree-actions{opacity:0}.tree-provider,.tree-vps{background:var(--bg-card);border:1px solid var(--border-color);border-radius:6px;margin-bottom:1rem;overflow:hidden}.tree-provider>.tree-row,.tree-provider>.node-header,.tree-vps>.tree-row,.tree-vps>.node-header{padding:.6rem .75rem;margin-left:0;border-bottom:1px solid var(--border-color)}.tree-provider>.tree-row::before,.tree-provider>.node-header::before,.tree-vps>.tree-row::before,.tree-vps>.node-header::before{display:none}.tree-provider>.tree-children,.tree-vps>.tree-children{padding:.5rem 0}.tree-section-divider{width:100%;display:flex;align-items:center;gap:1rem;margin:1.5rem 0 1rem}.tree-section-divider::before,.tree-section-divider::after{content:"";flex:1;height:1px;background:var(--border-color)}.tree-section-divider .divider-label{font-size:.65rem;color:var(--text-secondary);text-transform:uppercase;letter-spacing:1px;padding:.2rem .6rem;background:var(--bg-card);border:1px solid var(--border-color)}[data-theme=blurred] .tree-container{padding:1.5rem 0}[data-theme=blurred] .tree-section-header{border-bottom-color:hsla(0,0%,100%,.1)}[data-theme=blurred] .tree-item::before,[data-theme=blurred] .tree-node::before{background:hsla(0,0%,100%,.1)}[data-theme=blurred] .tree-row::before,[data-theme=blurred] .node-header::before{background:hsla(0,0%,100%,.1)}[data-theme=blurred] .tree-row:hover,[data-theme=blurred] .node-header:hover{background:hsla(0,0%,100%,.05)}[data-theme=blurred] .tree-provider,[data-theme=blurred] .tree-vps{background:hsla(0,0%,100%,.03);backdrop-filter:blur(10px);border-color:hsla(0,0%,100%,.08);border-radius:12px}[data-theme=blurred] .tree-provider>.tree-row,[data-theme=blurred] .tree-provider>.node-header,[data-theme=blurred] .tree-vps>.tree-row,[data-theme=blurred] .tree-vps>.node-header{border-bottom-color:hsla(0,0%,100%,.06)}[data-theme=blurred] .tree-status.online{box-shadow:0 0 8px var(--accent-green)}[data-theme=blurred] .tree-type{background:hsla(0,0%,100%,.05);border-color:hsla(0,0%,100%,.1);border-radius:8px}[data-theme=blurred] .tree-action-btn,[data-theme=blurred] .node-copy-btn,[data-theme=blurred] .node-url-btn{background:hsla(0,0%,100%,.05);border-color:hsla(0,0%,100%,.1);border-radius:6px}[data-theme=blurred] .tree-action-btn:hover,[data-theme=blurred] .node-copy-btn:hover,[data-theme=blurred] .node-url-btn:hover{background:hsla(0,0%,100%,.1)}[data-theme=blurred] .tree-section-divider::before,[data-theme=blurred] .tree-section-divider::after{background:linear-gradient(90deg, transparent, var(--border-color), transparent)}[data-theme=blurred] .tree-section-divider .divider-label{background:hsla(0,0%,100%,.05);border-color:hsla(0,0%,100%,.1);border-radius:12px;backdrop-filter:blur(10px)}.node-badge{font-size:.6rem;padding:.1rem .35rem;border-radius:3px;text-transform:uppercase;flex-shrink:0;margin-left:auto}.node-badge.on{background:rgba(0,0,0,0);color:var(--accent-green);border:1px solid var(--accent-green)}.node-badge.dev{background:rgba(0,0,0,0);color:var(--accent-yellow);border:1px solid var(--accent-yellow)}.node-badge.hold{background:rgba(0,0,0,0);color:var(--accent-orange);border:1px solid var(--accent-orange)}.node-badge.tbd{background:rgba(0,0,0,0);color:var(--text-secondary);border:1px solid var(--border-color)}.expand-icon{font-size:.65rem;width:12px}.expand-icon.expanded{transform:rotate(90deg)}.tree-children{padding-left:1rem;display:none}.tree-children.expanded{display:block}.tree-container[data-filter=on] .tree-service[data-mode=dev],.tree-container[data-filter=on] .tree-service[data-mode=hold],.tree-container[data-filter=on] .tree-service[data-mode=tbd],.tree-container[data-filter=on] .tree-node[data-mode=dev],.tree-container[data-filter=on] .tree-node[data-mode=hold],.tree-container[data-filter=on] .tree-node[data-mode=tbd]{display:none}.tree-container[data-filter=offline] .tree-service[data-mode=dev],.tree-container[data-filter=offline] .tree-service[data-mode=hold],.tree-container[data-filter=offline] .tree-service[data-mode=tbd],.tree-container[data-filter=offline] .tree-node[data-mode=dev],.tree-container[data-filter=offline] .tree-node[data-mode=hold],.tree-container[data-filter=offline] .tree-node[data-mode=tbd]{display:none}.tree-container[data-filter=offline] .tree-service[data-mode=on]:not([data-offline=true]),.tree-container[data-filter=offline] .tree-node[data-mode=on]:not([data-offline=true]){display:none}.ssh-modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);backdrop-filter:blur(10px);display:flex;align-items:center;justify-content:center;z-index:2000;animation:fadeIn .3s ease-out}.ssh-modal{background:var(--bg-card);border-radius:16px;padding:2.5rem;max-width:600px;width:90%;box-shadow:0 20px 60px rgba(0,0,0,.5);border:1px solid rgba(74,158,255,.3);animation:slideInScale .3s ease-out}.ssh-modal h3{color:var(--accent-blue);margin-bottom:1.5rem;font-size:1.5rem}.ssh-command{background:rgba(0,0,0,.3);border-radius:8px;padding:1rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:1rem;border:1px solid rgba(74,158,255,.2)}.ssh-command code{flex:1;color:var(--accent-green);font-family:"Courier New",monospace;font-size:.9rem;word-break:break-all}.copy-btn{padding:.5rem 1rem;background:var(--accent-blue);color:#fff;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:all .3s ease;white-space:nowrap}.copy-btn:hover{background:var(--accent-purple);transform:scale(1.05)}.ssh-instruction{color:var(--text-secondary);margin-bottom:1rem;font-size:1rem}.ssh-options{display:flex;gap:1rem;margin-bottom:1.5rem}.ssh-option-btn{flex:1;padding:1rem;background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:1rem;transition:all .3s ease}.ssh-option-btn:hover{transform:translateY(-2px);box-shadow:0 10px 30px rgba(74,158,255,.4)}.close-modal-btn{width:100%;padding:.75rem;background:hsla(0,0%,100%,.1);color:var(--text-primary);border:1px solid hsla(0,0%,100%,.2);border-radius:8px;cursor:pointer;font-weight:500;transition:all .3s ease}.close-modal-btn:hover{background:hsla(0,0%,100%,.15);border-color:hsla(0,0%,100%,.3)}.notification{position:fixed;top:20px;right:20px;background:linear-gradient(135deg, var(--accent-blue), var(--accent-purple));color:#fff;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 10px 30px rgba(0,0,0,.3);z-index:1000;animation:slideIn .3s ease-out;font-weight:500}.notification.closing{animation:slideOut .3s ease-out}#monitoring-view{max-width:1400px;width:100%;margin:0 auto;padding:0 1rem}.monitoring-grid{display:flex;flex-direction:column;gap:2rem}.monitoring-section{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--border-radius);padding:1.5rem}[data-theme=blurred] .monitoring-section{backdrop-filter:blur(10px);border-radius:var(--border-radius-lg)}.monitoring-section-title{font-size:1rem;font-weight:600;color:var(--accent-primary);text-transform:uppercase;letter-spacing:1px;margin-bottom:1rem;padding-bottom:.5rem;border-bottom:1px solid var(--border-color)}[data-theme=blurred] .monitoring-section-title{color:var(--accent-blue);text-transform:none;font-size:1.2rem}.vm-status-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:1rem}.vm-status-card{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--border-radius);padding:1rem;transition:all var(--transition-speed) ease}.vm-status-card:hover{border-color:var(--accent-blue)}[data-theme=blurred] .vm-status-card{background:hsla(0,0%,100%,.03);border-radius:12px}.vm-status-header{display:flex;align-items:center;gap:.75rem;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:1px solid var(--border-color)}.vm-icon{font-size:1.5rem}.vm-name{flex:1;font-weight:600;font-size:.9rem;text-transform:uppercase}[data-theme=blurred] .vm-name{text-transform:none;font-size:1rem}.vm-status-indicator{width:12px;height:12px;border-radius:50%;animation:pulse 2s infinite}.vm-status-indicator.online{background:var(--accent-green);box-shadow:0 0 8px var(--accent-green)}.vm-status-indicator.pending{background:var(--accent-yellow);box-shadow:0 0 8px var(--accent-yellow)}.vm-status-indicator.offline{background:var(--accent-red);box-shadow:0 0 8px var(--accent-red)}.vm-status-details{display:flex;flex-direction:column;gap:.5rem}.vm-stat{display:flex;justify-content:space-between;font-size:.8rem}.vm-stat .stat-label{color:var(--text-secondary)}.vm-stat .stat-value{color:var(--text-primary);font-family:var(--font-mono)}.service-health-grid{display:flex;flex-direction:column;gap:.5rem}.service-health-row{display:grid;grid-template-columns:1fr 1.5fr auto;gap:1rem;padding:.75rem 1rem;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--border-radius);align-items:center;font-size:.85rem}[data-theme=blurred] .service-health-row{background:hsla(0,0%,100%,.02);border-radius:8px}.service-name{font-weight:600;text-transform:uppercase}[data-theme=blurred] .service-name{text-transform:none}.service-url{color:var(--text-secondary);font-family:var(--font-mono);font-size:.75rem}.service-status{padding:.25rem .75rem;font-size:.7rem;font-weight:600;text-transform:uppercase;border-radius:var(--border-radius)}.service-status.online{background:rgba(0,204,102,.15);color:var(--accent-green);border:1px solid var(--accent-green)}.service-status.pending{background:rgba(255,204,0,.15);color:var(--accent-yellow);border:1px solid var(--accent-yellow)}[data-theme=blurred] .service-status{border-radius:12px}#resources-view{max-width:1400px;width:100%;margin:0 auto;padding:0 1rem}.resources-summary{display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:1.5rem;margin-bottom:2rem}.summary-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--border-radius);padding:1.5rem}.summary-card h4{font-size:1rem;font-weight:600;color:var(--accent-primary);text-transform:uppercase;margin-bottom:1rem}[data-theme=blurred] .summary-card{backdrop-filter:blur(10px);border-radius:var(--border-radius-lg);background:linear-gradient(135deg, rgba(74, 158, 255, 0.1), rgba(139, 92, 246, 0.1))}[data-theme=blurred] .summary-card h4{color:var(--text-primary);text-transform:none}.summary-stats{display:flex;flex-direction:column;gap:.75rem}.summary-stat{display:flex;align-items:center;gap:.75rem}.summary-stat .stat-icon{font-size:1.25rem}.summary-stat .stat-label{color:var(--text-secondary);font-size:.85rem;width:80px}.summary-stat .stat-value{color:var(--accent-blue);font-family:var(--font-mono);font-weight:600}.resources-section{background:var(--bg-card);border:1px solid var(--border-color);border-radius:var(--border-radius);padding:1.5rem;margin-bottom:1.5rem}[data-theme=blurred] .resources-section{backdrop-filter:blur(10px);border-radius:var(--border-radius-lg)}.resources-section-title{font-size:1rem;font-weight:600;color:var(--accent-primary);text-transform:uppercase;letter-spacing:1px;margin-bottom:1rem}[data-theme=blurred] .resources-section-title{color:var(--accent-blue);text-transform:none;font-size:1.2rem}.resources-table-container{overflow-x:auto}.resources-table{width:100%;border-collapse:collapse;font-size:.8rem}.resources-table th,.resources-table td{padding:.75rem .5rem;text-align:left;border-bottom:1px solid var(--border-color)}.resources-table th{color:var(--text-secondary);font-weight:600;text-transform:uppercase;font-size:.7rem;letter-spacing:.5px;background:var(--bg-secondary)}[data-theme=blurred] .resources-table th{background:hsla(0,0%,100%,.03);text-transform:none;font-size:.8rem}.resources-table td{font-family:var(--font-mono)}.service-row,.vm-row{background:var(--bg-card)}.service-row:hover,.vm-row:hover{background:var(--bg-card-hover)}.component-row{background:var(--bg-secondary)}.component-row td{font-size:.75rem;color:var(--text-secondary)}.component-name{padding-left:1rem;color:var(--text-secondary)}.ai-service,.ai-vm{border-left:3px solid var(--accent-purple)}.resources-category{margin-bottom:3rem}.resources-category-title{font-size:1.5rem;font-weight:700;color:var(--accent-primary);text-transform:uppercase;letter-spacing:2px;margin-bottom:1.5rem;padding-bottom:.5rem;border-bottom:2px solid var(--accent-primary)}[data-theme=blurred] .resources-category-title{color:var(--accent-blue);text-transform:none;background:linear-gradient(135deg, var(--accent-blue), var(--accent-green));-webkit-background-clip:text;-webkit-text-fill-color:rgba(0,0,0,0);background-clip:text;border-bottom-color:var(--accent-blue)}.ai-category .resources-category-title{color:var(--accent-purple);border-bottom-color:var(--accent-purple)}[data-theme=blurred] .ai-category .resources-category-title{background:linear-gradient(135deg, var(--accent-purple), var(--accent-blue));-webkit-background-clip:text;-webkit-text-fill-color:rgba(0,0,0,0);background-clip:text;border-bottom-color:var(--accent-purple)}.ai-card{border-left:3px solid var(--accent-purple)}[data-theme=blurred] .ai-card{background:linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(74, 158, 255, 0.1))}.ai-section{border-left:3px solid var(--accent-purple)}.totals-row{background:var(--bg-secondary);font-weight:600}.totals-row td{border-top:1px solid var(--border-color);color:var(--accent-primary)}[data-theme=blurred] .totals-row{background:hsla(0,0%,100%,.03)}[data-theme=blurred] .totals-row td{color:var(--accent-blue)}.totals-row.total-final{background:var(--bg-card)}.totals-row.total-final td{border-top:2px solid var(--accent-primary);font-size:.85rem}[data-theme=blurred] .totals-row.total-final{background:rgba(74,158,255,.1)}[data-theme=blurred] .totals-row.total-final td{border-top-color:var(--accent-blue)}.health-badge{padding:.2rem .5rem;font-size:.65rem;font-weight:600;text-transform:uppercase;border-radius:var(--border-radius)}.health-badge.online{background:rgba(0,204,102,.15);color:var(--accent-green);border:1px solid var(--accent-green)}.health-badge.pending{background:rgba(255,204,0,.15);color:var(--accent-yellow);border:1px solid var(--accent-yellow)}.health-badge.offline{background:rgba(255,51,51,.15);color:var(--accent-red);border:1px solid var(--accent-red)}[data-theme=blurred] .health-badge{border-radius:10px}.status-table td{font-size:.75rem}.status-badge{padding:.2rem .5rem;font-size:.65rem;font-weight:600;text-transform:uppercase;border-radius:var(--border-radius)}.status-badge.on{background:rgba(0,204,102,.15);color:var(--accent-green);border:1px solid var(--accent-green)}.status-badge.dev{background:rgba(74,158,255,.15);color:var(--accent-blue);border:1px solid var(--accent-blue)}.status-badge.hold{background:rgba(139,92,246,.15);color:var(--accent-purple);border:1px solid var(--accent-purple)}[data-theme=blurred] .status-badge{border-radius:10px}
</style>
    <style>
        /* Dashboard-specific styles */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
        }

        /* Wake-on-Demand Button Styles */
        .wake-btn{display:inline-flex;align-items:center;gap:.3rem;padding:.3rem .6rem;background:var(--bg-secondary);border:1px solid var(--accent-green);border-radius:var(--border-radius);color:var(--accent-green);font-size:.7rem;font-weight:600;cursor:pointer;transition:all .2s ease}.wake-btn:hover:not(:disabled){background:var(--accent-green);color:#000}.wake-btn:disabled{opacity:.5;cursor:not-allowed;border-color:var(--border-color);color:var(--text-secondary)}.wake-btn svg{width:12px;height:12px}.wake-btn .spinner{width:12px;height:12px;border:2px solid rgba(0,0,0,0);border-top-color:currentColor;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}[data-theme=blurred] .wake-btn{border-radius:8px;background:rgba(16,185,129,.1)}[data-theme=blurred] .wake-btn:hover:not(:disabled){background:var(--accent-green);box-shadow:0 0 15px rgba(16,185,129,.3)}.vm-dormant{background:rgba(255,200,0,.02)}[data-theme=blurred] .vm-dormant{background:rgba(255,200,0,.05)}

        .dashboard-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .dashboard-title h2 {
            margin: 0;
            font-size: 1.2rem;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-green);
            animation: pulse 2s infinite;
        }

        .status-dot.disconnected {
            background: var(--accent-red);
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; box-shadow: 0 0 4px var(--accent-green); }
            50% { opacity: 0.6; box-shadow: 0 0 8px var(--accent-green); }
        }

        .dashboard-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .auto-refresh-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .auto-refresh-toggle input {
            accent-color: var(--accent-primary);
        }

        .refresh-btn {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.4rem 0.8rem;
            background: var(--accent-primary);
            border: none;
            border-radius: var(--border-radius);
            color: #000;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .refresh-btn:hover {
            transform: scale(1.02);
        }

        .refresh-btn.loading svg {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .last-updated {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        /* GitHub OAuth Login */
        .github-login-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: #24292e;
            border: 1px solid #444;
            border-radius: var(--border-radius);
            color: #fff;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .github-login-btn:hover {
            background: #2f363d;
            border-color: #666;
        }

        .github-login-btn svg {
            width: 16px;
            height: 16px;
        }

        .github-login-btn.logged-in {
            background: var(--accent-green);
            border-color: var(--accent-green);
            color: #000;
        }

        /* Authelia TOTP Button */
        .authelia-login-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: #1a237e;
            border: 1px solid #3949ab;
            border-radius: var(--border-radius);
            color: #fff;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.8rem;
            transition: all 0.2s;
            text-decoration: none;
        }

        .authelia-login-btn:hover {
            background: #283593;
            border-color: #5c6bc0;
        }

        .auth-buttons {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .user-avatar {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .logout-btn {
            padding: 0.2rem 0.4rem;
            background: transparent;
            border: 1px solid currentColor;
            border-radius: 4px;
            color: inherit;
            cursor: pointer;
            font-size: 0.65rem;
            margin-left: 0.5rem;
        }

        .logout-btn:hover {
            background: rgba(0,0,0,0.2);
        }

        /* Reboot Button */
        .reboot-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
            padding: 0.3rem 0.6rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-secondary);
            cursor: not-allowed;
            font-size: 0.7rem;
            font-weight: 500;
            transition: all 0.2s;
            opacity: 0.5;
        }

        .reboot-btn svg {
            width: 12px;
            height: 12px;
        }

        .reboot-btn.enabled {
            opacity: 1;
            cursor: pointer;
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }

        .reboot-btn.enabled:hover {
            background: var(--accent-orange);
            color: #000;
        }

        .reboot-btn.loading svg {
            animation: spin 1s linear infinite;
        }

        .reboot-btn.success {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        /* Live status badge that gets updated by JS */
        .live-status {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .live-status.checking {
            background: rgba(156, 163, 175, 0.15);
            color: var(--text-tertiary);
        }

        .live-status.online {
            background: rgba(74, 222, 128, 0.15);
            color: var(--accent-green);
        }

        .live-status.offline {
            background: rgba(248, 113, 113, 0.15);
            color: var(--accent-red);
        }

        .live-status.pending {
            background: rgba(251, 191, 36, 0.15);
            color: var(--accent-yellow);
        }

        .live-status.dev {
            background: rgba(96, 165, 250, 0.15);
            color: var(--accent-blue);
        }

        .live-status.hold {
            background: rgba(251, 191, 36, 0.15);
            color: var(--accent-yellow);
        }

        .live-status.dormant {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        .live-status.online .live-dot {
            animation: pulse-dot 2s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { box-shadow: 0 0 2px currentColor; }
            50% { box-shadow: 0 0 6px currentColor; }
        }

        /* Tab Navigation Styles */
        .dashboard-tabs {
            display: flex;
            gap: 0.5rem;
            margin: 1.5rem 0;
            padding: 0.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
        }

        [data-theme=blurred] .dashboard-tabs {
            backdrop-filter: blur(10px);
            background: rgba(26, 31, 58, 0.8);
            border-radius: 16px;
            padding: 0.75rem;
            gap: 0.75rem;
        }

        .tab-btn {
            flex: 1;
            padding: 0.6rem 1rem;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-secondary);
            font-family: var(--font-mono);
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
            background: var(--bg-card);
        }

        .tab-btn.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: #000;
        }

        [data-theme=blurred] .tab-btn {
            border-radius: 12px;
            text-transform: none;
            font-size: 0.95rem;
            letter-spacing: normal;
        }

        [data-theme=blurred] .tab-btn:hover {
            background: rgba(74, 158, 255, 0.1);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        [data-theme=blurred] .tab-btn.active {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-color: transparent;
            color: #fff;
            box-shadow: 0 0 20px var(--glow);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* Infrastructure View Toggle */
        .infra-view-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .infra-view-content.active {
            display: block;
        }

        .infra-view-toggle .view-btn {
            min-width: 100px;
        }

        /* Type category cards for By Type view */
        .infra-type-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .infra-type-table th,
        .infra-type-table td {
            padding: 0.75rem 0.5rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .infra-type-table th {
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 0.5px;
            background: var(--bg-secondary);
        }

        [data-theme=blurred] .infra-type-table th {
            background: rgba(255, 255, 255, 0.03);
        }

        .infra-type-table td {
            font-family: var(--font-mono);
        }

        .infra-type-table tr:hover {
            background: var(--bg-card-hover);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Cost Sub-tabs */
        .cost-subtabs {
            display: flex;
            gap: 0.5rem;
            margin: 0 0 1.5rem 0;
            padding: 0.5rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        [data-theme=blurred] .cost-subtabs {
            backdrop-filter: blur(10px);
            background: rgba(26, 31, 58, 0.6);
            border-radius: 12px;
            padding: 0.75rem;
        }

        .cost-subtab-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: calc(var(--border-radius) - 2px);
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cost-subtab-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
            background: var(--bg-card);
        }

        .cost-subtab-btn.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: #000;
        }

        [data-theme=blurred] .cost-subtab-btn.active {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-color: transparent;
            color: #fff;
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.3);
        }

        .cost-subtab-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .cost-subtab-content.active {
            display: block;
        }

        /* Status Sub-tabs (Frontend/Backend) */
        .status-subtabs {
            display: flex;
            gap: 0.5rem;
            margin: 0 0 1rem 0;
            padding: 0.5rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        [data-theme=blurred] .status-subtabs {
            backdrop-filter: blur(10px);
            background: rgba(26, 31, 58, 0.6);
            border-radius: 12px;
            padding: 0.75rem;
        }

        .status-subtab-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: calc(var(--border-radius) - 2px);
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .status-subtab-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
            background: var(--bg-card);
        }

        .status-subtab-btn.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: #000;
        }

        [data-theme=blurred] .status-subtab-btn.active {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-color: transparent;
            color: #fff;
            box-shadow: 0 0 15px rgba(74, 158, 255, 0.3);
        }

        .status-subtab-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .status-subtab-content.active {
            display: block;
        }

        /* View Toggle (Cards/List) */
        .view-toggle-inline {
            display: flex;
            gap: 0.5rem;
            margin: 0 0 1rem 0;
            justify-content: flex-end;
        }

        .view-toggle-btn {
            padding: 0.4rem 1rem;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-secondary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-toggle-btn:hover {
            border-color: var(--accent-primary);
            color: var(--text-primary);
        }

        .view-toggle-btn.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: #000;
        }

        [data-theme=blurred] .view-toggle-btn.active {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-purple));
            border-color: transparent;
            color: #fff;
        }

        /* ============================================
           COST TAB STYLES
           ============================================ */

        .cost-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .cost-summary-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all var(--transition-speed) ease;
        }

        .cost-summary-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        [data-theme=blurred] .cost-summary-card {
            backdrop-filter: blur(10px);
            background: rgba(26, 31, 58, 0.6);
            border-radius: 16px;
        }

        [data-theme=blurred] .cost-summary-card:hover {
            background: rgba(35, 42, 74, 0.8);
            border-color: var(--accent-blue);
            box-shadow: 0 8px 32px var(--glow);
        }

        .cost-card-icon {
            color: var(--accent-primary);
            flex-shrink: 0;
        }

        [data-theme=blurred] .cost-card-icon {
            color: var(--accent-blue);
        }

        .cost-card-content {
            flex: 1;
        }

        .cost-card-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .cost-card-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            font-family: var(--font-mono);
        }

        .cost-card-sublabel {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .cost-block-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .cost-block-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        [data-theme=blurred] .cost-block-row {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .cost-block-label {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .cost-block-value {
            color: var(--text-primary);
            font-weight: 600;
            font-family: var(--font-mono);
        }

        .model-distribution-bar {
            height: 40px;
            display: flex;
            border-radius: var(--border-radius);
            overflow: hidden;
            background: var(--bg-secondary);
            margin-bottom: 1rem;
        }

        .model-dist-segment {
            height: 100%;
            transition: width 0.5s ease;
        }

        .model-opus {
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
        }

        .model-sonnet {
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
        }

        .model-haiku {
            background: linear-gradient(90deg, #10b981, #34d399);
        }

        .model-distribution-legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
        }

        .model-legend-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
        }

        [data-theme=blurred] .model-legend-item {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .model-legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .model-legend-dot.model-opus {
            background: #8b5cf6;
        }

        .model-legend-dot.model-sonnet {
            background: #3b82f6;
        }

        .model-legend-dot.model-haiku {
            background: #10b981;
        }

        .model-legend-label {
            flex: 1;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .model-legend-value {
            font-weight: 600;
            font-family: var(--font-mono);
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .model-legend-percent {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-left: 0.5rem;
        }

        /* ============================================
           PERFORMANCE TAB STYLES
           ============================================ */

        .vm-metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .vm-metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1rem;
        }

        [data-theme=blurred] .vm-metric-card {
            backdrop-filter: blur(10px);
            background: rgba(26, 31, 58, 0.6);
            border-radius: 16px;
        }

        .vm-metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .vm-metric-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .vm-metric-ip {
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .metric-gauges {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }

        .gauge {
            text-align: center;
        }

        .gauge-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(
                var(--gauge-color, var(--accent-primary)) calc(var(--gauge-percent, 0) * 1%),
                var(--bg-secondary) 0
            );
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 0.5rem;
            position: relative;
        }

        .gauge-circle::before {
            content: '';
            position: absolute;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--bg-card);
        }

        .gauge-value {
            position: relative;
            z-index: 1;
            font-family: var(--font-mono);
            font-size: 0.85rem;
            font-weight: 600;
        }

        .gauge-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .capacity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1rem;
        }

        .capacity-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1rem;
        }

        [data-theme=blurred] .capacity-card {
            backdrop-filter: blur(10px);
            background: rgba(26, 31, 58, 0.6);
            border-radius: 12px;
        }

        .capacity-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .capacity-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .capacity-status {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-weight: 600;
        }

        .status-ok { background: rgba(81, 207, 102, 0.2); color: #51cf66; }
        .status-warning { background: rgba(255, 193, 7, 0.2); color: #ffc107; }
        .status-danger { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }
        .status-dev { background: rgba(74, 158, 255, 0.2); color: #4a9eff; }
        .status-hold { background: rgba(134, 142, 150, 0.2); color: #868e96; }

        .capacity-bar {
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .capacity-fill {
            height: 100%;
            transition: width 0.5s ease;
        }

        .capacity-fill[data-level="ok"] {
            background: linear-gradient(90deg, #51cf66, #69db7c);
        }
        .capacity-fill[data-level="warning"] {
            background: linear-gradient(90deg, #ffc107, #ffdd57);
        }
        .capacity-fill[data-level="danger"] {
            background: linear-gradient(90deg, #ff6b6b, #ff8787);
        }

        .capacity-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .table-separator td {
            border-top: 2px solid var(--border-color);
            padding-top: 1rem;
        }

        .table-total td {
            background: var(--bg-secondary);
            font-weight: 600;
        }

        .loading-placeholder {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        /* Performance Page Styles */
        .percentage-cell {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .percentage-bar {
            flex: 1;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            min-width: 100px;
        }

        .percentage-fill {
            height: 100%;
            transition: width 0.5s ease;
        }

        .percentage-fill[data-level="ok"] {
            background: linear-gradient(90deg, #51cf66, #69db7c);
        }

        .percentage-fill[data-level="warning"] {
            background: linear-gradient(90deg, #ffc107, #ffdd57);
        }

        .percentage-fill[data-level="danger"] {
            background: linear-gradient(90deg, #ff6b6b, #ff8787);
        }

        .percentage-text {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            font-weight: 600;
            min-width: 45px;
            text-align: right;
        }

        .percentage-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 0.5rem;
        }

        .resource-value {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .percentage-labels .percentage-text {
            font-size: 0.75rem;
            color: var(--accent-blue);
        }

        .resource-breakdown {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .resource-value {
            font-family: var(--font-mono);
            font-weight: 600;
        }

        .resource-percent {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .kill-btn {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.4rem 0.8rem;
            background: var(--bg-secondary);
            border: 1px solid var(--accent-red);
            border-radius: var(--border-radius);
            color: var(--accent-red);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .kill-btn svg {
            width: 14px;
            height: 14px;
        }

        .kill-btn:hover:not(:disabled) {
            background: var(--accent-red);
            color: #000;
        }

        .kill-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: var(--border-color);
            color: var(--text-secondary);
        }

        [data-theme=blurred] .kill-btn {
            border-radius: 12px;
        }

        [data-theme=blurred] .kill-btn:hover:not(:disabled) {
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
        }

        /* ============================================
           HTOP-STYLE RESOURCE MONITOR
           ============================================ */
        .htop-monitor {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            padding: 0.5rem;
        }

        .htop-loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        /* VM Card */
        .htop-vm-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .htop-vm-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }

        .htop-vm-header:hover {
            background: var(--bg-hover);
        }

        .htop-vm-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .htop-vm-name {
            font-weight: 600;
            font-size: 1rem;
            color: var(--text-primary);
        }

        .htop-vm-specs {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-family: var(--font-mono);
        }

        .htop-vm-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .htop-vm-badge {
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .htop-vm-badge.active { background: rgba(81, 207, 102, 0.2); color: #51cf66; }
        .htop-vm-badge.stopped { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }
        .htop-vm-badge.dormant { background: rgba(255, 193, 7, 0.2); color: #ffc107; }

        /* Resource Bars Grid */
        .htop-bars-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
            padding: 1rem;
        }

        .htop-bar-item {
            display: flex;
            flex-direction: column;
            gap: 0.35rem;
        }

        .htop-bar-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
        }

        .htop-bar-name {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .htop-bar-value {
            font-family: var(--font-mono);
            color: var(--text-primary);
            font-weight: 600;
        }

        .htop-bar {
            height: 10px;
            background: var(--bg-primary);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .htop-bar-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }

        .htop-bar-fill.cpu { background: linear-gradient(90deg, #4dabf7, #228be6); }
        .htop-bar-fill.ram { background: linear-gradient(90deg, #69db7c, #40c057); }
        .htop-bar-fill.storage { background: linear-gradient(90deg, #ffd43b, #fab005); }
        .htop-bar-fill.vram { background: linear-gradient(90deg, #da77f2, #be4bdb); }

        .htop-bar-fill.warning { background: linear-gradient(90deg, #ffc107, #ffdd57) !important; }
        .htop-bar-fill.danger { background: linear-gradient(90deg, #ff6b6b, #ff8787) !important; }

        /* Services Breakdown */
        .htop-services {
            border-top: 1px solid var(--border-color);
            padding: 0.75rem 1rem;
            background: var(--bg-primary);
        }

        .htop-services-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .htop-service-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .htop-service-row {
            display: grid;
            grid-template-columns: 1fr 120px 80px;
            align-items: center;
            gap: 0.75rem;
            padding: 0.4rem 0.6rem;
            background: var(--bg-secondary);
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .htop-service-name {
            color: var(--text-primary);
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .htop-service-bar {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .htop-service-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #69db7c, #40c057);
            border-radius: 3px;
        }

        .htop-service-value {
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: right;
        }

        .htop-no-services {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-style: italic;
            padding: 0.5rem 0;
        }

        /* Blurred theme adjustments */
        [data-theme=blurred] .htop-vm-card {
            border-radius: 16px;
            backdrop-filter: blur(10px);
        }

        [data-theme=blurred] .htop-bar {
            border-radius: 8px;
        }

        /* ==================== AI Cost Visualizations ==================== */
        .ai-cost-hero {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .ai-cost-hero-main {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }

        .ai-cost-hero-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }

        .ai-cost-hero-value {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #a855f7, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
        }

        .ai-cost-hero-period {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .ai-cost-hero-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
        }

        .ai-cost-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .ai-cost-card-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ai-cost-card-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .ai-cost-card-delta {
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .ai-cost-card-delta.positive { color: #ff6b6b; }
        .ai-cost-card-delta.negative { color: #51cf66; }

        /* Charts Section */
        .ai-charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 900px) {
            .ai-charts-section { grid-template-columns: 1fr; }
        }

        .ai-chart-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
        }

        .ai-chart-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Donut Chart */
        .ai-donut-container {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        @media (max-width: 600px) {
            .ai-donut-container { flex-direction: column; }
        }

        .ai-donut-chart {
            position: relative;
            width: 160px;
            height: 160px;
            flex-shrink: 0;
        }

        .ai-donut-svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .ai-donut-svg circle {
            fill: none;
            stroke-width: 12;
            stroke-linecap: round;
        }

        .ai-donut-bg {
            stroke: var(--bg-tertiary);
        }

        .ai-donut-opus { stroke: #a855f7; }
        .ai-donut-sonnet { stroke: #3b82f6; }
        .ai-donut-haiku { stroke: #22c55e; }

        .ai-donut-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .ai-donut-value {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .ai-donut-label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .ai-donut-legend {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .ai-donut-legend-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .ai-donut-legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .ai-donut-legend-name {
            flex: 1;
            font-size: 0.875rem;
            color: var(--text-primary);
        }

        .ai-donut-legend-value {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .ai-donut-legend-pct {
            font-size: 0.75rem;
            color: var(--text-secondary);
            min-width: 45px;
            text-align: right;
        }

        /* Token Stats Grid */
        .ai-token-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .ai-token-card {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: 8px;
        }

        .ai-token-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4ade80;
            flex-shrink: 0;
        }

        .ai-token-icon svg {
            width: 24px;
            height: 24px;
        }

        .ai-token-content {
            flex: 1;
            min-width: 0;
        }

        .ai-token-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .ai-token-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .ai-token-bar {
            height: 4px;
            background: var(--bg-secondary);
            border-radius: 2px;
            overflow: hidden;
        }

        .ai-token-bar-fill {
            height: 100%;
            border-radius: 2px;
        }

        /* Bar Chart */
        .ai-bar-chart {
            height: 200px;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            gap: 4px;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .ai-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            max-width: 50px;
        }

        .ai-bar-fill {
            width: 100%;
            background: linear-gradient(180deg, #a855f7 0%, #3b82f6 100%);
            border-radius: 4px 4px 0 0;
            min-height: 4px;
            transition: height 0.3s ease;
        }

        .ai-bar-label {
            font-size: 0.65rem;
            color: var(--text-secondary);
            white-space: nowrap;
        }

        .ai-bar-value {
            font-size: 0.65rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Weekly Bars */
        .ai-weekly-bars {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            padding: 1rem 0;
        }

        .ai-weekly-row {
            display: grid;
            grid-template-columns: 60px 1fr 80px;
            align-items: center;
            gap: 1rem;
        }

        .ai-weekly-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .ai-weekly-bar {
            height: 24px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
        }

        .ai-weekly-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #a855f7, #3b82f6);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 0.5rem;
        }

        .ai-weekly-value {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: right;
        }

        /* Session List */
        .ai-session-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .ai-session-item {
            display: grid;
            grid-template-columns: 1fr 80px 80px;
            gap: 1rem;
            padding: 0.75rem;
            background: var(--bg-tertiary);
            border-radius: 6px;
            align-items: center;
        }

        .ai-session-name {
            font-size: 0.875rem;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ai-session-tokens {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: right;
        }

        .ai-session-cost {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--accent-primary);
            text-align: right;
        }

        /* AI Tables */
        .ai-table {
            width: 100%;
            border-collapse: collapse;
        }

        .ai-table th {
            text-align: left;
            padding: 0.75rem 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border-color);
        }

        .ai-table td {
            padding: 0.75rem 1rem;
            font-size: 0.875rem;
            border-bottom: 1px solid var(--border-color);
        }

        .ai-table tr:hover {
            background: var(--bg-hover);
        }

        .ai-table .cost {
            font-family: var(--font-mono);
            font-weight: 600;
            color: var(--accent-primary);
        }

        .ai-mini-bar {
            height: 6px;
            background: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
            min-width: 80px;
        }

        .ai-mini-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #a855f7, #3b82f6);
            border-radius: 3px;
        }

        /* VM Actions (for Status page) */
        .vm-actions-inline {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .vm-action-btn {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 0;
        }

        .vm-action-btn svg {
            width: 14px;
            height: 14px;
        }

        .vm-action-btn:hover:not(:disabled) {
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        .vm-action-btn.btn-ssh:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .vm-action-btn.btn-url:hover {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .vm-action-btn.btn-reset:hover {
            border-color: var(--accent-orange);
            color: var(--accent-orange);
        }

        .vm-action-btn.btn-reset.loading {
            animation: spin 1s linear infinite;
        }

        .vm-action-btn.btn-reset.success {
            border-color: var(--success);
            color: var(--success);
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .vm-action-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .ip-address {
            font-family: var(--font-mono);
            font-size: 0.85rem;
            color: var(--text-primary);
        }

        /* Hierarchical Services Table (Status page) */
        .services-hierarchical .service-parent-row {
            background: var(--bg-card);
            font-weight: 500;
        }

        .services-hierarchical .service-child-row {
            background: var(--bg-secondary);
        }

        .services-hierarchical .service-child-row td {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .child-service-name {
            padding-left: 2rem;
            color: var(--text-secondary);
        }

        [data-theme=blurred] .services-hierarchical .service-child-row {
            background: rgba(0, 0, 0, 0.2);
        }

        /* Resource Usage Bars (Performance tab) */
        .usage-bar {
            display: inline-block;
            width: 60px;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            vertical-align: middle;
            margin-right: 0.5rem;
        }

        .usage-fill {
            display: block;
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .usage-val {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-family: var(--font-mono);
        }

        .usage-bar-sm {
            display: inline-block;
            width: 40px;
            height: 6px;
            background: var(--bg-secondary);
            border-radius: 3px;
            overflow: hidden;
            vertical-align: middle;
            margin-right: 0.35rem;
            opacity: 0.8;
        }

        #vm-resources-oci-p-flex_1 .service-row,
        #vm-resources-oci-f-micro_1 .service-row,
        #vm-resources-oci-f-micro_2 .service-row,
        #vm-resources-gcp-f-micro_1 .service-row {
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .live-status {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.75rem;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-secondary);
            opacity: 0.4;
        }

        .live-status.checking .live-dot {
            animation: pulse-checking 2s ease-in-out infinite;
        }

        .live-status.online .live-dot {
            background: var(--accent-green);
            box-shadow: 0 0 6px var(--accent-green);
            opacity: 1;
        }

        .live-status.offline .live-dot {
            background: var(--accent-red);
            box-shadow: 0 0 6px var(--accent-red);
            opacity: 1;
        }

        @keyframes pulse-checking {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 0.8; }
        }
    </style>
    <script>
        // Apply saved theme immediately
        (function() {
            var theme = localStorage.getItem('cloud-dashboard-theme') || 'blurred';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
</head>
<body>
    <div class="container">
        <header class="main-header">
            <h1>Cloud Portal</h1>
            <!-- Cloud Infrastructure Banner -->
            <div class="header-banner">
                <svg viewBox="0 0 800 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:rgba(56,189,248,0.1)"/>
                            <stop offset="50%" style="stop-color:rgba(139,92,246,0.15)"/>
                            <stop offset="100%" style="stop-color:rgba(56,189,248,0.1)"/>
                        </linearGradient>
                        <linearGradient id="lineGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:rgba(56,189,248,0.3)"/>
                            <stop offset="50%" style="stop-color:rgba(139,92,246,0.5)"/>
                            <stop offset="100%" style="stop-color:rgba(56,189,248,0.3)"/>
                        </linearGradient>
                    </defs>
                    <path d="M50 60 L150 40 L250 70 L350 35 L450 60 L550 30 L650 55 L750 45" stroke="url(#lineGrad)" stroke-width="1.5" fill="none" opacity="0.6"/>
                    <path d="M50 80 L150 90 L250 75 L350 95 L450 80 L550 100 L650 85 L750 90" stroke="url(#lineGrad)" stroke-width="1.5" fill="none" opacity="0.4"/>
                    <circle cx="150" cy="40" r="8" fill="rgba(56,189,248,0.8)" opacity="0.9"/>
                    <circle cx="350" cy="35" r="10" fill="rgba(139,92,246,0.8)" opacity="0.9"/>
                    <circle cx="550" cy="30" r="7" fill="rgba(56,189,248,0.8)" opacity="0.9"/>
                    <circle cx="250" cy="70" r="6" fill="rgba(56,189,248,0.6)" opacity="0.8"/>
                    <circle cx="450" cy="60" r="9" fill="rgba(139,92,246,0.7)" opacity="0.85"/>
                    <circle cx="650" cy="55" r="7" fill="rgba(56,189,248,0.7)" opacity="0.85"/>
                    <rect x="140" y="75" width="20" height="30" rx="2" fill="rgba(56,189,248,0.3)" stroke="rgba(56,189,248,0.6)" stroke-width="1"/>
                    <line x1="143" y1="82" x2="157" y2="82" stroke="rgba(56,189,248,0.8)" stroke-width="1"/>
                    <line x1="143" y1="88" x2="157" y2="88" stroke="rgba(56,189,248,0.6)" stroke-width="1"/>
                    <rect x="340" y="70" width="20" height="30" rx="2" fill="rgba(139,92,246,0.3)" stroke="rgba(139,92,246,0.6)" stroke-width="1"/>
                    <line x1="343" y1="77" x2="357" y2="77" stroke="rgba(139,92,246,0.8)" stroke-width="1"/>
                    <line x1="343" y1="83" x2="357" y2="83" stroke="rgba(139,92,246,0.6)" stroke-width="1"/>
                    <rect x="540" y="65" width="20" height="30" rx="2" fill="rgba(56,189,248,0.3)" stroke="rgba(56,189,248,0.6)" stroke-width="1"/>
                    <line x1="543" y1="72" x2="557" y2="72" stroke="rgba(56,189,248,0.8)" stroke-width="1"/>
                    <line x1="543" y1="78" x2="557" y2="78" stroke="rgba(56,189,248,0.6)" stroke-width="1"/>
                    <circle cx="350" cy="35" r="15" fill="none" stroke="rgba(139,92,246,0.4)" stroke-width="1" opacity="0.5"/>
                    <circle cx="450" cy="60" r="14" fill="none" stroke="rgba(139,92,246,0.3)" stroke-width="1" opacity="0.4"/>
                </svg>
            </div>
            <p class="subtitle">Cloud Control Center</p>
            <!-- Level 1: Main Navigation Links -->
            <div class="nav-level1">
                <a href="index.html" class="nav-main-btn">Products</a>
                <a href="cloudcontrol.html" class="nav-main-btn active">Cloud Control</a>
                <a href="security-arch.html" class="nav-main-btn">Architecture</a>
            </div>
            <!-- Level 2: Dashboard Tabs -->
            <div class="nav-level2 active" id="nav-cloudcontrol">
                <button class="view-btn active" data-dash-tab="resources">Monitor</button>
                <button class="view-btn" data-dash-tab="orchestrate">Orchestrate</button>
                <button class="view-btn" data-dash-tab="cost">Cost</button>
                <button class="view-btn" data-dash-tab="security">Security</button>
                <button class="view-btn" data-dash-tab="infra">Infrastructure</button>
            </div>
        </header>

        <!-- Dashboard Controls -->
        <div class="dashboard-header">
            <div class="dashboard-title">
                <div class="status-dot" id="connection-status"></div>
                <h2>Live Monitoring</h2>
            </div>
            <div class="dashboard-controls">
                <span class="last-updated">Last: <span id="last-updated">--:--:--</span></span>
                <label class="auto-refresh-toggle">
                    <input type="checkbox" id="auto-refresh" checked>
                    Auto (30s)
                </label>
                <button class="refresh-btn" id="refresh-btn" onclick="refreshAll()">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M23 4v6h-6M1 20v-6h6"/>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                    </svg>
                    Refresh
                </button>
                <div class="auth-buttons">
                    <!-- GitHub SSO (PRIMARY - via OAuth2 Proxy) -->
                    <a href="https://auth.diegonmarcos.com/oauth2/start?rd=https://cloud.diegonmarcos.com/cloud_dash.html" class="github-login-btn" title="Login with GitHub SSO (Primary)">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                        </svg>
                        <span>GitHub SSO</span>
                    </a>
                    <!-- Authelia TOTP (BACKUP - Local 2FA) -->
                    <a href="https://auth.diegonmarcos.com/authelia/" class="authelia-login-btn" title="Backup: Local TOTP 2FA">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
                        </svg>
                        <span>TOTP</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Status Tab Content (hidden) -->
        <div id="status-tab" class="tab-content">

        <!-- VMs Section -->
        <div class="resources-category">
            <h3 class="resources-category-title">VMs</h3>
            <div class="resources-section">
                <div class="resources-table-container">
                    <table class="resources-table status-table">
                        <thead><tr><th>Mode</th><th>Host</th><th>VM</th><th>IP</th><th>Status</th><th>Actions</th></tr></thead>
                        <tbody id="vms-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Services Section -->
        <div class="resources-category">
            <h3 class="resources-category-title">Services</h3>
            <div class="resources-section">
                <div class="resources-table-container">
                    <table class="resources-table status-table services-hierarchical">
                        <thead><tr><th>VM</th><th>Name</th><th>URL</th><th>IP:PORT</th><th>Proxy Name</th><th>STATUS</th></tr></thead>
                        <tbody id="services-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Backlog Section -->
        <div class="resources-category">
            <h3 class="resources-category-title">Backlog (DEV/HOLD)</h3>
            <div class="resources-section">
                <div class="resources-table-container">
                    <table class="resources-table status-table">
                        <thead><tr><th>Service</th><th>Status</th><th>VM</th><th>Notes</th></tr></thead>
                        <tbody id="backlog-tbody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        </div><!-- End Status Tab -->

        <!-- Resources Tab Content (htop-style) -->
        <div id="resources-tab" class="tab-content active">
            <!-- VM Summary -->
            <div class="resources-category">
                <h3 class="resources-category-title">VM Overview</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table" style="font-size: 0.85rem;">
                            <thead>
                                <tr>
                                    <th style="width: 18%;">VM</th>
                                    <th style="width: 12%;">CPU</th>
                                    <th style="width: 14%;">RAM</th>
                                    <th style="width: 14%;">Storage</th>
                                    <th style="width: 10%;">VRAM</th>
                                    <th style="width: 12%;">Status</th>
                                    <th style="width: 20%;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="vm-row">
                                    <td><span style="display: inline-block; width: 8px; height: 8px; background: #F80000; border-radius: 50%; margin-right: 0.5rem;"></span>OCI Paid Flex 1</td>
                                    <td>2 vCPU</td>
                                    <td>3.6 / 8 GB</td>
                                    <td>165 / 242 GB</td>
                                    <td>-</td>
                                    <td><span class="health-badge healthy">Active</span></td>
                                    <td>
                                        <div class="vm-actions-inline">
                                            <button class="vm-action-btn btn-url" onclick="window.open('https://cloud.oracle.com/compute/instances', '_blank')" title="Open cloud console">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-ssh" onclick="copyToClipboard('ssh -i ~/.ssh/id_rsa ubuntu@130.110.251.193', 'SSH copied!')" title="Copy SSH command">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-reset" onclick="resetVM('oci-p-flex_1')" title="Reboot/Start VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-shutdown" onclick="shutdownVM('oci-p-flex_1')" title="Shutdown VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="vm-row">
                                    <td><span style="display: inline-block; width: 8px; height: 8px; background: #F80000; border-radius: 50%; margin-right: 0.5rem;"></span>OCI Free Micro 1</td>
                                    <td>1 OCPU</td>
                                    <td>0.6 / 1 GB</td>
                                    <td>13 / 47 GB</td>
                                    <td>-</td>
                                    <td><span class="health-badge healthy">Active</span></td>
                                    <td>
                                        <div class="vm-actions-inline">
                                            <button class="vm-action-btn btn-url" onclick="window.open('https://cloud.oracle.com/compute/instances', '_blank')" title="Open cloud console">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-ssh" onclick="copyToClipboard('ssh -i ~/.ssh/id_rsa ubuntu@129.151.228.66', 'SSH copied!')" title="Copy SSH command">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-reset" onclick="resetVM('oci-f-micro_1')" title="Reboot/Start VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-shutdown" onclick="shutdownVM('oci-f-micro_1')" title="Shutdown VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="vm-row">
                                    <td><span style="display: inline-block; width: 8px; height: 8px; background: #F80000; border-radius: 50%; margin-right: 0.5rem;"></span>OCI Free Micro 2</td>
                                    <td>1 OCPU</td>
                                    <td>0.55 / 1 GB</td>
                                    <td>9 / 47 GB</td>
                                    <td>-</td>
                                    <td><span class="health-badge healthy">Active</span></td>
                                    <td>
                                        <div class="vm-actions-inline">
                                            <button class="vm-action-btn btn-url" onclick="window.open('https://cloud.oracle.com/compute/instances', '_blank')" title="Open cloud console">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-ssh" onclick="copyToClipboard('ssh -i ~/.ssh/id_rsa ubuntu@84.235.234.87', 'SSH copied!')" title="Copy SSH command">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-reset" onclick="resetVM('oci-f-micro_2')" title="Reboot/Start VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-shutdown" onclick="shutdownVM('oci-f-micro_2')" title="Shutdown VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="vm-row">
                                    <td><span style="display: inline-block; width: 8px; height: 8px; background: #4285F4; border-radius: 50%; margin-right: 0.5rem;"></span>GCP Free Micro 1</td>
                                    <td>0.25 vCPU</td>
                                    <td>0.7 / 1 GB</td>
                                    <td>6 / 30 GB</td>
                                    <td>-</td>
                                    <td><span class="health-badge healthy">Active</span></td>
                                    <td>
                                        <div class="vm-actions-inline">
                                            <button class="vm-action-btn btn-url" onclick="window.open('https://console.cloud.google.com/compute/instances', '_blank')" title="Open cloud console">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-ssh" onclick="copyToClipboard('gcloud compute ssh arch-1 --zone=us-central1-a', 'SSH copied!')" title="Copy SSH command">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-reset" onclick="resetVM('gcp-f-micro_1')" title="Reboot/Start VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-shutdown" onclick="shutdownVM('gcp-f-micro_1')" title="Shutdown VM">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr class="vm-row" style="opacity: 0.6;">
                                    <td><span style="display: inline-block; width: 8px; height: 8px; background: #F80000; border-radius: 50%; margin-right: 0.5rem;"></span>OCI Free ARM 1</td>
                                    <td>4 OCPU</td>
                                    <td>- / 24 GB</td>
                                    <td>- / 200 GB</td>
                                    <td>-</td>
                                    <td><span class="health-badge pending">Pending</span></td>
                                    <td>
                                        <div class="vm-actions-inline">
                                            <button class="vm-action-btn btn-url" disabled title="VM pending">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-ssh" disabled title="VM pending">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-reset" disabled title="VM pending">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                                            </button>
                                            <button class="vm-action-btn btn-shutdown" disabled title="VM pending">
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"/><line x1="12" y1="2" x2="12" y2="12"/></svg>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Resource Usage by VM (Detailed) -->
            <div class="resources-category">
                <h3 class="resources-category-title">Service Breakdown by VM</h3>

                <!-- OCI Paid Flex 1 -->
                <div class="resources-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="width: 8px; height: 8px; background: #F80000; border-radius: 50%;"></span>
                        OCI Paid Flex 1
                        <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(1 OCPU, 8 GB RAM, 242 GB)</span>
                    </h4>
                    <div class="resources-table-container">
                        <table class="resources-table" style="font-size: 0.85rem;">
                            <thead>
                                <tr>
                                    <th style="width: 32%;">Name</th>
                                    <th style="width: 17%;">CPU</th>
                                    <th style="width: 17%;">RAM</th>
                                    <th style="width: 17%;">Storage</th>
                                    <th style="width: 17%;">VRAM</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="totals-row" style="background: var(--bg-tertiary); font-size: 0.8rem; color: var(--text-secondary);">
                                    <td>Absolute</td>
                                    <td>2 vCPU</td>
                                    <td>3.6 / 8 GB</td>
                                    <td>165 / 242 GB</td>
                                    <td>-</td>
                                </tr>
                                <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                    <td>VM Total</td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 15%; background: var(--accent-blue);"></span></span> <span class="usage-val">15%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 45%; background: var(--accent-green);"></span></span> <span class="usage-val">45%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 68%; background: var(--accent-orange);"></span></span> <span class="usage-val">68%</span></td>
                                    <td>-</td>
                                </tr>
                                <tr class="service-row"><td class="component-name"> syncthing</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-blue);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 12%; background: var(--accent-green);"></span></span> <span class="usage-val">12%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 41%; background: var(--accent-orange);"></span></span> <span class="usage-val">41%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> photoprism</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-green);"></span></span> <span class="usage-val">15%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 21%; background: var(--accent-orange);"></span></span> <span class="usage-val">21%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> n8n-infra</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-blue);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 8%; background: var(--accent-green);"></span></span> <span class="usage-val">8%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-orange);"></span></span> <span class="usage-val">1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> gitea</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-green);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 4%; background: var(--accent-orange);"></span></span> <span class="usage-val">4%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> radicale</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> cryptpad</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-green);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-orange);"></span></span> <span class="usage-val">1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> flask-api</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-green);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> vaultwarden</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> terminal</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> redis</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-green);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> openvpn</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-green);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td><td>-</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- OCI Free Micro 1 -->
                <div class="resources-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="width: 8px; height: 8px; background: #F80000; border-radius: 50%;"></span>
                        OCI Free Micro 1
                        <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(1 OCPU, 1 GB RAM, 47 GB)</span>
                    </h4>
                    <div class="resources-table-container">
                        <table class="resources-table" style="font-size: 0.85rem;">
                            <thead>
                                <tr>
                                    <th style="width: 32%;">Name</th>
                                    <th style="width: 17%;">CPU</th>
                                    <th style="width: 17%;">RAM</th>
                                    <th style="width: 17%;">Storage</th>
                                    <th style="width: 17%;">VRAM</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="totals-row" style="background: var(--bg-tertiary); font-size: 0.8rem; color: var(--text-secondary);">
                                    <td>Absolute</td>
                                    <td>1 OCPU</td>
                                    <td>0.6 / 1 GB</td>
                                    <td>13 / 47 GB</td>
                                    <td>-</td>
                                </tr>
                                <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                    <td>VM Total</td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 60%; background: var(--accent-orange);"></span></span> <span class="usage-val">60%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 27%; background: var(--accent-green);"></span></span> <span class="usage-val">27%</span></td>
                                    <td>-</td>
                                </tr>
                                <tr class="service-row"><td class="component-name"> mailu-imap</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-blue);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 20%; background: var(--accent-orange);"></span></span> <span class="usage-val">20%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-green);"></span></span> <span class="usage-val">15%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> mailu-admin</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 12%; background: var(--accent-orange);"></span></span> <span class="usage-val">12%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> mailu-webmail</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 4%; background: var(--accent-green);"></span></span> <span class="usage-val">4%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> mailu-smtp</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-green);"></span></span> <span class="usage-val">5%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> mailu-front</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 8%; background: var(--accent-orange);"></span></span> <span class="usage-val">8%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-green);"></span></span> <span class="usage-val">2%</span></td><td>-</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- OCI Free Micro 2 -->
                <div class="resources-section" style="margin-bottom: 1.5rem;">
                    <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="width: 8px; height: 8px; background: #F80000; border-radius: 50%;"></span>
                        OCI Free Micro 2
                        <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(1 OCPU, 1 GB RAM, 47 GB)</span>
                    </h4>
                    <div class="resources-table-container">
                        <table class="resources-table" style="font-size: 0.85rem;">
                            <thead>
                                <tr>
                                    <th style="width: 32%;">Name</th>
                                    <th style="width: 17%;">CPU</th>
                                    <th style="width: 17%;">RAM</th>
                                    <th style="width: 17%;">Storage</th>
                                    <th style="width: 17%;">VRAM</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="totals-row" style="background: var(--bg-tertiary); font-size: 0.8rem; color: var(--text-secondary);">
                                    <td>Absolute</td>
                                    <td>1 OCPU</td>
                                    <td>0.55 / 1 GB</td>
                                    <td>9 / 47 GB</td>
                                    <td>-</td>
                                </tr>
                                <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                    <td>VM Total</td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 10%; background: var(--accent-blue);"></span></span> <span class="usage-val">10%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 55%; background: var(--accent-orange);"></span></span> <span class="usage-val">55%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 20%; background: var(--accent-green);"></span></span> <span class="usage-val">20%</span></td>
                                    <td>-</td>
                                </tr>
                                <tr class="service-row"><td class="component-name"> matomo-db</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 30%; background: var(--accent-orange);"></span></span> <span class="usage-val">30%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-green);"></span></span> <span class="usage-val">15%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> matomo-app</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 25%; background: var(--accent-orange);"></span></span> <span class="usage-val">25%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-green);"></span></span> <span class="usage-val">5%</span></td><td>-</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- GCP Free Micro 1 -->
                <div class="resources-section">
                    <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span style="width: 8px; height: 8px; background: #4285F4; border-radius: 50%;"></span>
                        GCP Free Micro 1
                        <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(0.25 vCPU, 1 GB RAM, 30 GB)</span>
                    </h4>
                    <div class="resources-table-container">
                        <table class="resources-table" style="font-size: 0.85rem;">
                            <thead>
                                <tr>
                                    <th style="width: 32%;">Name</th>
                                    <th style="width: 17%;">CPU</th>
                                    <th style="width: 17%;">RAM</th>
                                    <th style="width: 17%;">Storage</th>
                                    <th style="width: 17%;">VRAM</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="totals-row" style="background: var(--bg-tertiary); font-size: 0.8rem; color: var(--text-secondary);">
                                    <td>Absolute</td>
                                    <td>0.25 vCPU</td>
                                    <td>0.7 / 1 GB</td>
                                    <td>6 / 30 GB</td>
                                    <td>-</td>
                                </tr>
                                <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                    <td>VM Total</td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 20%; background: var(--accent-blue);"></span></span> <span class="usage-val">20%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 70%; background: var(--accent-orange);"></span></span> <span class="usage-val">70%</span></td>
                                    <td><span class="usage-bar"><span class="usage-fill" style="width: 20%; background: var(--accent-green);"></span></span> <span class="usage-val">20%</span></td>
                                    <td>-</td>
                                </tr>
                                <tr class="service-row"><td class="component-name"> npm</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 8%; background: var(--accent-blue);"></span></span> <span class="usage-val">8%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 25%; background: var(--accent-orange);"></span></span> <span class="usage-val">25%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-green);"></span></span> <span class="usage-val">10%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> authelia</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-blue);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-orange);"></span></span> <span class="usage-val">15%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-green);"></span></span> <span class="usage-val">5%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> authelia-redis</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-green);"></span></span> <span class="usage-val">3%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> wireguard</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td>-</td></tr>
                                <tr class="service-row"><td class="component-name"> oauth2-proxy</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-blue);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td>-</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Orchestrate Tab Content (Dockge Docker Management) -->
        <div id="orchestrate-tab" class="tab-content">
            <div class="resources-category">
                <h3 class="resources-category-title">Docker Container Management</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1rem;">Manage Docker containers across VMs using Dockge</p>

                <div class="resources-section">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                        <!-- OCI Paid Flex 1 Dockge -->
                        <div class="dockge-card" style="background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem;">
                            <h4 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="width: 10px; height: 10px; background: #F80000; border-radius: 50%;"></span>
                                OCI Paid Flex 1
                            </h4>
                            <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1rem;">130.110.251.193 - Main production server</p>
                            <a href="https://dockge.diegonmarcos.com" target="_blank" class="vm-action-btn btn-url" style="display: inline-flex; padding: 0.5rem 1rem; text-decoration: none;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-right: 0.5rem;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                Open Dockge
                            </a>
                        </div>

                        <!-- GCP Arch 1 Dockge -->
                        <div class="dockge-card" style="background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 1rem;">
                            <h4 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;">
                                <span style="width: 10px; height: 10px; background: #4285F4; border-radius: 50%;"></span>
                                GCP Free Micro 1
                            </h4>
                            <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 1rem;">34.55.55.234 - NPM Proxy & Services</p>
                            <a href="https://dockge-gcp.diegonmarcos.com" target="_blank" class="vm-action-btn btn-url" style="display: inline-flex; padding: 0.5rem 1rem; text-decoration: none;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px; margin-right: 0.5rem;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                Open Dockge
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="resources-category" style="margin-top: 1.5rem;">
                <h3 class="resources-category-title">Quick Actions</h3>
                <div class="resources-section">
                    <div style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
                        <button class="vm-action-btn" style="padding: 0.5rem 1rem;" onclick="window.open('https://dockge.diegonmarcos.com', '_blank')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="9" y1="3" x2="9" y2="21"/></svg>
                            View All Stacks
                        </button>
                        <button class="vm-action-btn" style="padding: 0.5rem 1rem;" onclick="alert('Feature coming soon: Pull latest images')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            Pull Images
                        </button>
                        <button class="vm-action-btn" style="padding: 0.5rem 1rem;" onclick="alert('Feature coming soon: Restart all containers')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                            Restart All
                        </button>
                    </div>
                </div>
            </div>
        </div><!-- End Orchestrate Tab -->

        <!-- Cost Tab Content -->
        <div id="cost-tab" class="tab-content">
            <!-- Cost Sub-tabs -->
            <div class="cost-subtabs">
                <button class="cost-subtab-btn active" data-subtab="cost-infra">Infrastructure</button>
                <button class="cost-subtab-btn" data-subtab="cost-ai">AI Costs</button>
            </div>

            <!-- Infrastructure Cost Sub-tab -->
            <div id="cost-infra" class="cost-subtab-content active">
            <!-- Cloud Infrastructure Costs - Super Enhanced -->
            <div class="resources-category">
                <h3 class="resources-category-title">
                    <span>Cloud Infrastructure Costs</span>
                    <span id="cloud-costs-updated" style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal; margin-left: 1rem;"></span>
                </h3>

                <!-- Big Hero Banner (like AI Costs) -->
                <div class="ai-cost-hero">
                    <div class="ai-cost-hero-main">
                        <div class="ai-hero-total">
                            <span class="ai-hero-label">Total Cloud Spend (All Time)</span>
                            <span class="ai-hero-value" id="cloud-all-time-spend">0.83</span>
                            <span class="ai-hero-tokens" id="cloud-total-resources">2 VMs running across 2 providers</span>
                        </div>
                    </div>
                    <div class="ai-cost-hero-cards">
                        <div class="ai-hero-card">
                            <div class="ai-hero-card-value" id="cloud-total-month">0.83</div>
                            <div class="ai-hero-card-label">This Month</div>
                            <div class="ai-hero-card-sub" id="cloud-month-label">Dec 2025 (8 days)</div>
                        </div>
                        <div class="ai-hero-card">
                            <div class="ai-hero-card-value" id="cloud-projected" style="color: var(--accent-orange);">3.22</div>
                            <div class="ai-hero-card-label">Projected</div>
                            <div class="ai-hero-card-sub">Full month estimate</div>
                        </div>
                        <div class="ai-hero-card">
                            <div class="ai-hero-card-value" id="cloud-ytd">0.83</div>
                            <div class="ai-hero-card-label">Year to Date</div>
                            <div class="ai-hero-card-sub">2025 Total</div>
                        </div>
                        <div class="ai-hero-card">
                            <div class="ai-hero-card-value" id="cloud-savings" style="color: var(--success);">44.17</div>
                            <div class="ai-hero-card-label">Savings</div>
                            <div class="ai-hero-card-sub">98% vs Market</div>
                        </div>
                    </div>
                </div>

                <!-- Provider Distribution Donut (like AI Costs model distribution) -->
                <div class="resources-category">
                    <h3 class="resources-category-title">Provider Cost Distribution (Current Month)</h3>
                    <div class="resources-section">
                        <div class="ai-donut-container">
                            <div class="ai-donut-chart">
                                <svg viewBox="0 0 100 100" class="ai-donut-svg">
                                    <circle cx="50" cy="50" r="40" fill="none" stroke="#1a1a2e" stroke-width="15"/>
                                    <circle cx="50" cy="50" r="40" fill="none" stroke="#F80000" stroke-width="15"
                                        stroke-dasharray="251 251" stroke-dashoffset="0" class="cloud-donut-oci"
                                        transform="rotate(-90 50 50)"/>
                                    <circle cx="50" cy="50" r="40" fill="none" stroke="#4285F4" stroke-width="15"
                                        stroke-dasharray="0 251" stroke-dashoffset="-251" class="cloud-donut-gcp"
                                        transform="rotate(-90 50 50)"/>
                                </svg>
                                <div class="ai-donut-center">
                                    <span class="ai-donut-value" id="cloud-donut-total">0.83</span>
                                    <span class="ai-donut-label">Total</span>
                                </div>
                            </div>
                            <div class="ai-donut-legend" id="cloud-donut-legend">
                                <div class="ai-donut-legend-item">
                                    <span class="ai-donut-legend-dot" style="background: #F80000;"></span>
                                    <span class="ai-donut-legend-name">Oracle Cloud (OCI)</span>
                                    <span class="ai-donut-legend-value" id="cloud-oci-cost">0.83</span>
                                    <span class="ai-donut-legend-pct" id="cloud-oci-pct">100%</span>
                                </div>
                                <div class="ai-donut-legend-item">
                                    <span class="ai-donut-legend-dot" style="background: #4285F4;"></span>
                                    <span class="ai-donut-legend-name">Google Cloud (GCP)</span>
                                    <span class="ai-donut-legend-value" id="cloud-gcp-cost">0.00</span>
                                    <span class="ai-donut-legend-pct" id="cloud-gcp-pct">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resource Usage by VM -->
                <div class="resources-category">
                    <h3 class="resources-category-title">Resource Usage by VM</h3>

                    <!-- OCI Paid Flex 1 -->
                    <div class="resources-section" style="margin-bottom: 1.5rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span style="width: 8px; height: 8px; background: #F80000; border-radius: 50%;"></span>
                            OCI Paid Flex 1
                            <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(1 OCPU, 8 GB RAM, 242 GB)</span>
                        </h4>
                        <div class="resources-table-container">
                            <table class="resources-table" style="font-size: 0.85rem;">
                                <thead>
                                    <tr>
                                        <th style="width: 40%;">Name</th>
                                        <th style="width: 20%;">CPU</th>
                                        <th style="width: 20%;">RAM</th>
                                        <th style="width: 20%;">Storage</th>
                                    </tr>
                                </thead>
                                <tbody id="vm-resources-oci-p-flex_1">
                                    <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                        <td>VM</td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 15%; background: var(--accent-blue);"></span></span> <span class="usage-val">15%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 45%; background: var(--accent-green);"></span></span> <span class="usage-val">45%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 68%; background: var(--accent-orange);"></span></span> <span class="usage-val">68%</span></td>
                                    </tr>
                                    <tr class="service-row"><td class="component-name"> n8n-infra</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-blue);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 8%; background: var(--accent-green);"></span></span> <span class="usage-val">8%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-orange);"></span></span> <span class="usage-val">1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> syncthing</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-blue);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 12%; background: var(--accent-green);"></span></span> <span class="usage-val">12%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 41%; background: var(--accent-orange);"></span></span> <span class="usage-val">41%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> flask-api</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-green);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> photoprism</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-green);"></span></span> <span class="usage-val">15%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 21%; background: var(--accent-orange);"></span></span> <span class="usage-val">21%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> radicale</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> gitea</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-green);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 4%; background: var(--accent-orange);"></span></span> <span class="usage-val">4%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> vaultwarden</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> terminal</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> cryptpad</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-green);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-orange);"></span></span> <span class="usage-val">1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> openvpn</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-green);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> redis</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-green);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-orange);"></span></span> <span class="usage-val">&lt;1%</span></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- OCI Free Micro 1 -->
                    <div class="resources-section" style="margin-bottom: 1.5rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span style="width: 8px; height: 8px; background: #F80000; border-radius: 50%;"></span>
                            OCI Free Micro 1
                            <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(1 OCPU, 1 GB RAM, 47 GB)</span>
                        </h4>
                        <div class="resources-table-container">
                            <table class="resources-table" style="font-size: 0.85rem;">
                                <thead>
                                    <tr>
                                        <th style="width: 40%;">Name</th>
                                        <th style="width: 20%;">CPU</th>
                                        <th style="width: 20%;">RAM</th>
                                        <th style="width: 20%;">Storage</th>
                                    </tr>
                                </thead>
                                <tbody id="vm-resources-oci-f-micro_1">
                                    <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                        <td>VM</td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 60%; background: var(--accent-orange);"></span></span> <span class="usage-val">60%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 27%; background: var(--accent-green);"></span></span> <span class="usage-val">27%</span></td>
                                    </tr>
                                    <tr class="service-row"><td class="component-name"> mailu-front</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 8%; background: var(--accent-orange);"></span></span> <span class="usage-val">8%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-green);"></span></span> <span class="usage-val">2%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> mailu-admin</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 12%; background: var(--accent-orange);"></span></span> <span class="usage-val">12%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> mailu-imap</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 2%; background: var(--accent-blue);"></span></span> <span class="usage-val">2%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 20%; background: var(--accent-orange);"></span></span> <span class="usage-val">20%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-green);"></span></span> <span class="usage-val">15%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> mailu-smtp</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-green);"></span></span> <span class="usage-val">5%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> mailu-webmail</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 0%; background: var(--accent-blue);"></span></span> <span class="usage-val">&lt;1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 4%; background: var(--accent-green);"></span></span> <span class="usage-val">4%</span></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- OCI Free Micro 2 -->
                    <div class="resources-section" style="margin-bottom: 1.5rem;">
                        <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span style="width: 8px; height: 8px; background: #F80000; border-radius: 50%;"></span>
                            OCI Free Micro 2
                            <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(1 OCPU, 1 GB RAM, 47 GB)</span>
                        </h4>
                        <div class="resources-table-container">
                            <table class="resources-table" style="font-size: 0.85rem;">
                                <thead>
                                    <tr>
                                        <th style="width: 40%;">Name</th>
                                        <th style="width: 20%;">CPU</th>
                                        <th style="width: 20%;">RAM</th>
                                        <th style="width: 20%;">Storage</th>
                                    </tr>
                                </thead>
                                <tbody id="vm-resources-oci-f-micro_2">
                                    <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                        <td>VM</td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 10%; background: var(--accent-blue);"></span></span> <span class="usage-val">10%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 55%; background: var(--accent-orange);"></span></span> <span class="usage-val">55%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 20%; background: var(--accent-green);"></span></span> <span class="usage-val">20%</span></td>
                                    </tr>
                                    <tr class="service-row"><td class="component-name"> matomo-app</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 25%; background: var(--accent-orange);"></span></span> <span class="usage-val">25%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-green);"></span></span> <span class="usage-val">5%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> matomo-db</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 30%; background: var(--accent-orange);"></span></span> <span class="usage-val">30%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-green);"></span></span> <span class="usage-val">15%</span></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- GCP Free Micro 1 -->
                    <div class="resources-section">
                        <h4 style="color: var(--text-primary); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span style="width: 8px; height: 8px; background: #4285F4; border-radius: 50%;"></span>
                            GCP Free Micro 1
                            <span style="font-size: 0.75rem; color: var(--text-secondary); font-weight: normal;">(0.25 vCPU, 1 GB RAM, 30 GB)</span>
                        </h4>
                        <div class="resources-table-container">
                            <table class="resources-table" style="font-size: 0.85rem;">
                                <thead>
                                    <tr>
                                        <th style="width: 40%;">Name</th>
                                        <th style="width: 20%;">CPU</th>
                                        <th style="width: 20%;">RAM</th>
                                        <th style="width: 20%;">Storage</th>
                                    </tr>
                                </thead>
                                <tbody id="vm-resources-gcp-f-micro_1">
                                    <tr class="vm-row" style="background: var(--bg-card); font-weight: 600;">
                                        <td>VM</td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 20%; background: var(--accent-blue);"></span></span> <span class="usage-val">20%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 70%; background: var(--accent-orange);"></span></span> <span class="usage-val">70%</span></td>
                                        <td><span class="usage-bar"><span class="usage-fill" style="width: 35%; background: var(--accent-green);"></span></span> <span class="usage-val">35%</span></td>
                                    </tr>
                                    <tr class="service-row"><td class="component-name"> npm</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 8%; background: var(--accent-blue);"></span></span> <span class="usage-val">8%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 25%; background: var(--accent-orange);"></span></span> <span class="usage-val">25%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-green);"></span></span> <span class="usage-val">10%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> authelia</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-blue);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 15%; background: var(--accent-orange);"></span></span> <span class="usage-val">15%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-green);"></span></span> <span class="usage-val">5%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> authelia-redis</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-blue);"></span></span> <span class="usage-val">1%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-green);"></span></span> <span class="usage-val">3%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> wireguard</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 5%; background: var(--accent-blue);"></span></span> <span class="usage-val">5%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td></tr>
                                    <tr class="service-row"><td class="component-name"> oauth2-proxy</td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 3%; background: var(--accent-blue);"></span></span> <span class="usage-val">3%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 10%; background: var(--accent-orange);"></span></span> <span class="usage-val">10%</span></td><td><span class="usage-bar-sm"><span class="usage-fill" style="width: 1%; background: var(--accent-green);"></span></span> <span class="usage-val">1%</span></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Monthly Cost Bar Chart (like AI Daily Cost) -->
                <div class="resources-category">
                    <h3 class="resources-category-title">Monthly Cost Trend</h3>
                    <div class="resources-section">
                        <div class="ai-bar-chart" id="cloud-monthly-chart" style="height: 150px; display: flex; align-items: flex-end; gap: 0.5rem; padding: 1rem 0;">
                            <!-- Rendered by JS -->
                        </div>
                        <div class="ai-chart-legend">
                            <span class="ai-legend-item"><span class="ai-legend-dot" style="background: #F80000;"></span>OCI</span>
                            <span class="ai-legend-item"><span class="ai-legend-dot" style="background: #4285F4;"></span>GCP</span>
                        </div>
                    </div>
                </div>

                <!-- Service Details Table -->
                <div class="resources-category">
                    <h3 class="resources-category-title">Service Breakdown (Current Month)</h3>
                    <div class="resources-section">
                        <div class="resources-table-container">
                            <table class="resources-table" id="cloud-services-table">
                                <thead>
                                    <tr>
                                        <th>Provider</th>
                                        <th>Service</th>
                                        <th>Description</th>
                                        <th>Usage</th>
                                        <th>Cost</th>
                                        <th>Visual</th>
                                    </tr>
                                </thead>
                                <tbody id="cloud-services-tbody">
                                    <tr>
                                        <td colspan="6" style="text-align: center; color: var(--text-secondary);">
                                            Loading cloud costs data...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Free Tier Usage (like Weekly Breakdown) -->
                <div class="resources-category">
                    <h3 class="resources-category-title">Free Tier Utilization</h3>
                    <div class="resources-section">
                        <div id="cloud-free-tier-container" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                            <!-- OCI Free Tier -->
                            <div style="background: var(--bg-tertiary); border-radius: 12px; padding: 1rem; border-left: 4px solid #F80000;">
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                    <div style="width: 32px; height: 32px; background: #F80000; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" width="18" height="18">
                                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">Oracle Cloud (OCI)</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Always Free Tier</div>
                                    </div>
                                </div>
                                <div id="oci-free-tier-bars">
                                    <div style="margin-bottom: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Compute (ARM)</span><span style="color: var(--accent-orange);">100%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 100%; background: linear-gradient(90deg, #F80000, #ff6666); border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">4 OCPU + 24 GB of 4 OCPU + 24 GB</div>
                                    </div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Block Storage</span><span style="color: var(--success);">25%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 25%; background: #22c55e; border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">~94 GB of 200 GB (2x47 GB free micro)</div>
                                    </div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Object Storage</span><span style="color: var(--success);">1%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 1%; background: #22c55e; border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">< 1 GB of 20 GB</div>
                                    </div>
                                    <div>
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>VCN Egress</span><span style="color: var(--success);">0%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 0.01%; background: #22c55e; border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">< 1 GB of 10 TB/month</div>
                                    </div>
                                </div>
                            </div>
                            <!-- GCP Free Tier -->
                            <div style="background: var(--bg-tertiary); border-radius: 12px; padding: 1rem; border-left: 4px solid #4285F4;">
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                    <div style="width: 32px; height: 32px; background: #4285F4; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" width="18" height="18">
                                            <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div style="font-weight: 600; color: var(--text-primary);">Google Cloud (GCP)</div>
                                        <div style="font-size: 0.75rem; color: var(--text-secondary);">Free Tier</div>
                                    </div>
                                </div>
                                <div id="gcp-free-tier-bars">
                                    <div style="margin-bottom: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Compute Engine</span><span style="color: var(--accent-orange);">100%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 100%; background: linear-gradient(90deg, #4285F4, #66aaff); border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">1 e2-micro of 1 e2-micro (730 hrs/mo)</div>
                                    </div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Cloud Storage</span><span style="color: var(--success);">10%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 10%; background: #22c55e; border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">< 1 GB of 5 GB</div>
                                    </div>
                                    <div style="margin-bottom: 0.75rem;">
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Cloud DNS</span><span style="color: var(--success);">4%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 4%; background: #22c55e; border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">1 zone of 25 zones</div>
                                    </div>
                                    <div>
                                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.25rem;">
                                            <span>Network Egress</span><span style="color: var(--accent-orange);">50%</span>
                                        </div>
                                        <div style="height: 8px; background: var(--bg-secondary); border-radius: 4px; overflow: hidden;">
                                            <div style="height: 100%; width: 50%; background: #fbbf24; border-radius: 4px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">~0.5 GB of 1 GB/month</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Market Comparison (Enhanced) -->
                <div class="resources-category">
                    <h3 class="resources-category-title">Market Comparison</h3>
                    <div class="resources-section">
                        <div id="cloud-market-comparison" style="background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, var(--bg-tertiary) 100%); border-radius: 12px; padding: 1.5rem; border: 1px solid rgba(34, 197, 94, 0.3);">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; align-items: center;">
                                <div style="text-align: center;">
                                    <div style="font-size: 2.5rem; font-weight: 700; color: var(--success);">98%</div>
                                    <div style="color: var(--text-secondary); font-size: 0.9rem;">Cost Savings</div>
                                </div>
                                <div>
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                            <span style="color: var(--text-secondary);">Your Cost</span>
                                            <span style="font-weight: 600; color: var(--success);">0.83/mo</span>
                                        </div>
                                        <div style="height: 12px; background: var(--bg-secondary); border-radius: 6px; overflow: hidden;">
                                            <div style="height: 100%; width: 2%; background: linear-gradient(90deg, #22c55e, #4ade80); border-radius: 6px;"></div>
                                        </div>
                                    </div>
                                    <div style="margin-bottom: 1rem;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                            <span style="color: var(--text-secondary);">AWS Equivalent</span>
                                            <span style="color: #ff6b6b;">45.00/mo</span>
                                        </div>
                                        <div style="height: 12px; background: var(--bg-secondary); border-radius: 6px; overflow: hidden;">
                                            <div style="height: 100%; width: 100%; background: linear-gradient(90deg, #ff6b6b, #ff8888); border-radius: 6px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-tertiary); margin-top: 0.25rem;">t3.medium + 50GB EBS</div>
                                    </div>
                                    <div>
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                                            <span style="color: var(--text-secondary);">Azure Equivalent</span>
                                            <span style="color: #f472b6;">42.00/mo</span>
                                        </div>
                                        <div style="height: 12px; background: var(--bg-secondary); border-radius: 6px; overflow: hidden;">
                                            <div style="height: 100%; width: 93%; background: linear-gradient(90deg, #f472b6, #f9a8d4); border-radius: 6px;"></div>
                                        </div>
                                        <div style="font-size: 0.7rem; color: var(--text-tertiary); margin-top: 0.25rem;">B2s + 50GB SSD</div>
                                    </div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
                                    <div style="font-size: 1.5rem; font-weight: 600; color: var(--success);">44.17</div>
                                    <div style="color: var(--text-secondary); font-size: 0.8rem;">Monthly Savings</div>
                                    <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-tertiary);">530/year saved</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div><!-- End Infrastructure Cost Sub-tab -->

            <!-- AI Cost Sub-tab -->
            <div id="cost-ai" class="cost-subtab-content">

            <!-- AI Cost Hero Summary -->
            <div class="ai-cost-hero">
                <div class="ai-cost-hero-main">
                    <div class="ai-hero-total">
                        <span class="ai-hero-label">Total AI Spend (All Time)</span>
                        <span class="ai-hero-value" id="ai-total-spend">$1,679.87</span>
                        <span class="ai-hero-tokens" id="ai-total-tokens">1.97B tokens processed</span>
                    </div>
                </div>
                <div class="ai-cost-hero-cards">
                    <div class="ai-hero-card">
                        <div class="ai-hero-card-value" id="ai-month-spend">$953.86</div>
                        <div class="ai-hero-card-label">This Month</div>
                        <div class="ai-hero-card-sub" id="ai-month-days">Dec 2025 (8 days)</div>
                    </div>
                    <div class="ai-hero-card">
                        <div class="ai-hero-card-value" id="ai-week-spend">$335.69</div>
                        <div class="ai-hero-card-label">This Week</div>
                        <div class="ai-hero-card-sub">Week of Dec 7</div>
                    </div>
                    <div class="ai-hero-card">
                        <div class="ai-hero-card-value" id="ai-today-spend">$88.91</div>
                        <div class="ai-hero-card-label">Today</div>
                        <div class="ai-hero-card-sub" id="ai-today-date">Dec 8, 2025</div>
                    </div>
                    <div class="ai-hero-card">
                        <div class="ai-hero-card-value" id="ai-avg-daily">$76.36</div>
                        <div class="ai-hero-card-label">Avg Daily</div>
                        <div class="ai-hero-card-sub">Last 21 days</div>
                    </div>
                </div>
            </div>

            <!-- Daily Cost Bar Chart -->
            <div class="resources-category">
                <h3 class="resources-category-title">Daily Cost Trend (Last 21 Days)</h3>
                <div class="resources-section">
                    <div class="ai-bar-chart" id="ai-daily-chart">
                        <!-- Bars will be rendered by JS -->
                    </div>
                    <div class="ai-chart-legend">
                        <span class="ai-legend-item"><span class="ai-legend-dot" style="background: #a855f7;"></span>Opus</span>
                        <span class="ai-legend-item"><span class="ai-legend-dot" style="background: #3b82f6;"></span>Sonnet</span>
                        <span class="ai-legend-item"><span class="ai-legend-dot" style="background: #22c55e;"></span>Haiku</span>
                    </div>
                </div>
            </div>

            <!-- Model Distribution Donut -->
            <div class="resources-category">
                <h3 class="resources-category-title">Model Cost Distribution (All Time)</h3>
                <div class="resources-section">
                    <div class="ai-donut-container">
                        <div class="ai-donut-chart">
                            <svg viewBox="0 0 100 100" class="ai-donut-svg">
                                <circle cx="50" cy="50" r="40" fill="none" stroke="#1a1a2e" stroke-width="15"/>
                                <circle cx="50" cy="50" r="40" fill="none" stroke="#a855f7" stroke-width="15"
                                    stroke-dasharray="205 251" stroke-dashoffset="0" class="ai-donut-opus"/>
                                <circle cx="50" cy="50" r="40" fill="none" stroke="#3b82f6" stroke-width="15"
                                    stroke-dasharray="43 251" stroke-dashoffset="-205" class="ai-donut-sonnet"/>
                                <circle cx="50" cy="50" r="40" fill="none" stroke="#22c55e" stroke-width="15"
                                    stroke-dasharray="3 251" stroke-dashoffset="-248" class="ai-donut-haiku"/>
                            </svg>
                            <div class="ai-donut-center">
                                <span class="ai-donut-value">$1,679</span>
                                <span class="ai-donut-label">Total</span>
                            </div>
                        </div>
                        <div class="ai-donut-legend">
                            <div class="ai-donut-legend-item">
                                <span class="ai-donut-legend-dot" style="background: #a855f7;"></span>
                                <span class="ai-donut-legend-name">Claude Opus 4.5</span>
                                <span class="ai-donut-legend-value">$1,372.18</span>
                                <span class="ai-donut-legend-pct">81.7%</span>
                            </div>
                            <div class="ai-donut-legend-item">
                                <span class="ai-donut-legend-dot" style="background: #3b82f6;"></span>
                                <span class="ai-donut-legend-name">Claude Sonnet 4.5</span>
                                <span class="ai-donut-legend-value">$287.32</span>
                                <span class="ai-donut-legend-pct">17.1%</span>
                            </div>
                            <div class="ai-donut-legend-item">
                                <span class="ai-donut-legend-dot" style="background: #22c55e;"></span>
                                <span class="ai-donut-legend-name">Claude Haiku 4.5</span>
                                <span class="ai-donut-legend-value">$19.82</span>
                                <span class="ai-donut-legend-pct">1.2%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Token Usage Statistics -->
            <div class="resources-category">
                <h3 class="resources-category-title">Token Usage Statistics</h3>
                <div class="resources-section">
                    <div class="ai-token-grid">
                        <div class="ai-token-card">
                            <div class="ai-token-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                                </svg>
                            </div>
                            <div class="ai-token-content">
                                <div class="ai-token-value" id="ai-input-tokens">1.12M</div>
                                <div class="ai-token-label">Input Tokens</div>
                                <div class="ai-token-bar">
                                    <div class="ai-token-bar-fill" style="width: 0.06%; background: #4ade80;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="ai-token-card">
                            <div class="ai-token-icon" style="color: #f472b6;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                            </div>
                            <div class="ai-token-content">
                                <div class="ai-token-value" id="ai-output-tokens">3.25M</div>
                                <div class="ai-token-label">Output Tokens</div>
                                <div class="ai-token-bar">
                                    <div class="ai-token-bar-fill" style="width: 0.16%; background: #f472b6;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="ai-token-card">
                            <div class="ai-token-icon" style="color: #fbbf24;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83"/>
                                    <circle cx="12" cy="12" r="4"/>
                                </svg>
                            </div>
                            <div class="ai-token-content">
                                <div class="ai-token-value" id="ai-cache-create">152.9M</div>
                                <div class="ai-token-label">Cache Creation</div>
                                <div class="ai-token-bar">
                                    <div class="ai-token-bar-fill" style="width: 7.75%; background: #fbbf24;"></div>
                                </div>
                            </div>
                        </div>
                        <div class="ai-token-card">
                            <div class="ai-token-icon" style="color: #2dd4bf;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 4v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.342a2 2 0 0 0-.602-1.43l-4.44-4.342A2 2 0 0 0 13.56 2H6a2 2 0 0 0-2 2z"/>
                                    <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
                                </svg>
                            </div>
                            <div class="ai-token-content">
                                <div class="ai-token-value" id="ai-cache-read">1.82B</div>
                                <div class="ai-token-label">Cache Read (92%)</div>
                                <div class="ai-token-bar">
                                    <div class="ai-token-bar-fill" style="width: 92%; background: #2dd4bf;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Weekly Breakdown -->
            <div class="resources-category">
                <h3 class="resources-category-title">Weekly Cost Breakdown</h3>
                <div class="resources-section">
                    <div class="ai-weekly-bars" id="ai-weekly-chart">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Session Cost Breakdown -->
            <div class="resources-category">
                <h3 class="resources-category-title">Top Projects by Cost</h3>
                <div class="resources-section">
                    <div class="ai-session-list" id="ai-session-list">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </div>

            <!-- Monthly Cost Table -->
            <div class="resources-category">
                <h3 class="resources-category-title">Monthly Summary</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Month</th>
                                    <th>Opus</th>
                                    <th>Sonnet</th>
                                    <th>Haiku</th>
                                    <th>Total</th>
                                    <th>Visual</th>
                                </tr>
                            </thead>
                            <tbody id="monthly-cost-table">
                                <tr>
                                    <td colspan="6" style="text-align: center; color: var(--text-secondary);">
                                        Loading monthly data...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Daily Cost Table with Visual Bars -->
            <div class="resources-category">
                <h3 class="resources-category-title">Daily Cost Log (Last 21 Days)</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Opus</th>
                                    <th>Sonnet</th>
                                    <th>Haiku</th>
                                    <th>Total</th>
                                    <th>Visual</th>
                                </tr>
                            </thead>
                            <tbody id="daily-cost-table">
                                <tr>
                                    <td colspan="6" style="text-align: center; color: var(--text-secondary);">
                                        Loading daily data...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>



            <!-- AI Model Pricing Reference -->
            <div class="resources-category">
                <h3 class="resources-category-title">AI Model Pricing Reference</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Provider</th>
                                    <th>Model</th>
                                    <th>Input $/1M</th>
                                    <th>Output $/1M</th>
                                    <th>Cache Read</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td colspan="7" style="background: var(--bg-tertiary); font-weight: bold;">Anthropic (Claude)</td></tr>
                                <tr>
                                    <td>Anthropic</td>
                                    <td><strong>Claude Opus 4.5</strong></td>
                                    <td>$15.00</td>
                                    <td>$75.00</td>
                                    <td>$1.50</td>
                                    <td>API</td>
                                    <td><span class="status-badge on">Active</span></td>
                                </tr>
                                <tr>
                                    <td>Anthropic</td>
                                    <td><strong>Claude Sonnet 4.5</strong></td>
                                    <td>$3.00</td>
                                    <td>$15.00</td>
                                    <td>$0.30</td>
                                    <td>API</td>
                                    <td><span class="status-badge on">Active</span></td>
                                </tr>
                                <tr>
                                    <td>Anthropic</td>
                                    <td><strong>Claude Haiku 4.5</strong></td>
                                    <td>$0.80</td>
                                    <td>$4.00</td>
                                    <td>$0.08</td>
                                    <td>API</td>
                                    <td><span class="status-badge on">Active</span></td>
                                </tr>
                                <tr><td colspan="7" style="background: var(--bg-tertiary); font-weight: bold;">Google (Gemini)</td></tr>
                                <tr>
                                    <td>Google</td>
                                    <td><strong>Gemini 2.0 Flash</strong></td>
                                    <td>$0.10</td>
                                    <td>$0.40</td>
                                    <td>$0.025</td>
                                    <td>API</td>
                                    <td><span class="status-badge pending">Planned</span></td>
                                </tr>
                                <tr><td colspan="7" style="background: var(--bg-tertiary); font-weight: bold;">Local (Self-hosted)</td></tr>
                                <tr>
                                    <td>Local</td>
                                    <td><strong>DeepSeek R1</strong></td>
                                    <td>$0.00</td>
                                    <td>$0.00</td>
                                    <td>-</td>
                                    <td>Local</td>
                                    <td><span class="status-badge dev">Dev</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            </div><!-- End AI Cost Sub-tab -->

        </div><!-- End Cost Tab -->

        <!-- Security Tab Content -->
        <div id="security-tab" class="tab-content">
            <!-- Security Services Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">Security Services</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Service</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                    <th>Location</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>MyVault</strong></td>
                                    <td>Password Manager</td>
                                    <td>Bitwarden EU - Secure credential storage</td>
                                    <td>vault.bitwarden.eu (SaaS)</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Authelia</strong></td>
                                    <td>2FA Gateway</td>
                                    <td>TOTP authentication for protected services</td>
                                    <td>GCP Micro 1 (34.55.55.234:9091)</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>OAuth2 Proxy</strong></td>
                                    <td>Admin Auth</td>
                                    <td>GitHub OAuth2 for cloud_dash, photos, mail</td>
                                    <td>GCP Micro 1</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>NPM + SSL</strong></td>
                                    <td>TLS Termination</td>
                                    <td>Let's Encrypt certificates with auto-renewal</td>
                                    <td>GCP Micro 1 (Central NPM)</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Docker Networks</strong></td>
                                    <td>Network Isolation</td>
                                    <td>Segmented: public_net, private_net, db_bridge</td>
                                    <td>OCI Flex 1</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>SSH Keys</strong></td>
                                    <td>Access Control</td>
                                    <td>Key-based auth for all VMs - no passwords</td>
                                    <td>All VMs</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Cloud Firewalls</strong></td>
                                    <td>Network Security</td>
                                    <td>OCI Security Lists + GCP Firewall Rules</td>
                                    <td>OCI + GCP</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Gmail SMTP Relay</strong></td>
                                    <td>Notifications</td>
                                    <td>App Password auth for Authelia alerts</td>
                                    <td>Gmail (SaaS)</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Security Layers Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">Security Layers</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Layer</th>
                                    <th>Components</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1. Network Edge</strong></td>
                                    <td>Cloud Firewalls, UFW, Fail2Ban</td>
                                    <td>Block unauthorized access at perimeter</td>
                                </tr>
                                <tr>
                                    <td><strong>2. Traffic Routing</strong></td>
                                    <td>NPM Proxy, TLS/SSL, Rate Limiting</td>
                                    <td>Secure transport and HTTPS termination</td>
                                </tr>
                                <tr>
                                    <td><strong>3. Authentication</strong></td>
                                    <td>Authelia 2FA, OAuth 2.0 (GitHub)</td>
                                    <td>Verify identity with multi-factor auth</td>
                                </tr>
                                <tr>
                                    <td><strong>4. Application</strong></td>
                                    <td>Docker Networks, Container Isolation</td>
                                    <td>Limit blast radius with segmentation</td>
                                </tr>
                                <tr>
                                    <td><strong>5. Data</strong></td>
                                    <td>Encrypted volumes, Separate DBs</td>
                                    <td>Protect data at rest</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Docker Networks Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">Docker Network Segmentation</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>VM</th>
                                    <th>Network Name</th>
                                    <th>Subnet</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>oci-f-micro_1</td>
                                    <td>mail_network</td>
                                    <td>172.20.0.0/24</td>
                                    <td>Mail services (Mailu)</td>
                                </tr>
                                <tr>
                                    <td>oci-f-micro_2</td>
                                    <td>matomo_network</td>
                                    <td>172.21.0.0/24</td>
                                    <td>Analytics stack</td>
                                </tr>
                                <tr>
                                    <td>gcp-f-micro_1</td>
                                    <td>proxy_network</td>
                                    <td>172.23.0.0/24</td>
                                    <td>NPM proxy + Authelia</td>
                                </tr>
                                <tr>
                                    <td>oci-p-flex_1</td>
                                    <td>dev_network</td>
                                    <td>172.24.0.0/24</td>
                                    <td>Dev services (n8n, sync, git)</td>
                                </tr>
                                <tr>
                                    <td>oci-f-arm_1</td>
                                    <td>ai_network</td>
                                    <td>172.22.0.0/24</td>
                                    <td>AI services (future)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- VPN Tunneling Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">VPN & Tunneling</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Service</th>
                                    <th>Protocol</th>
                                    <th>Port</th>
                                    <th>Purpose</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>WireGuard Tunnel</strong></td>
                                    <td>WireGuard</td>
                                    <td>51820/UDP</td>
                                    <td>GCP to OCI secure tunnel for backend services</td>
                                    <td><span class="status-badge on">ON</span></td>
                                </tr>
                                <tr>
                                    <td><strong>OpenVPN</strong></td>
                                    <td>OpenVPN</td>
                                    <td>1194/UDP</td>
                                    <td>Client VPN for admin access</td>
                                    <td><span class="status-badge dev">DEV</span></td>
                                </tr>
                                <tr>
                                    <td><strong>Cloudflare Tunnel</strong></td>
                                    <td>cloudflared</td>
                                    <td>-</td>
                                    <td>Zero-trust access (alternative)</td>
                                    <td><span class="status-badge hold">HOLD</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Authelia 2FA Flow Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">Authelia 2FA Flow</h3>
                <div class="resources-section" style="font-family: var(--font-mono); font-size: 0.75rem; line-height: 1.6; white-space: pre; overflow-x: auto; padding: 1.5rem; background: var(--bg-secondary);">Browser Request: photos.diegonmarcos.com
        |
        v
+-----------------+
|   CLOUDFLARE    |  DNS: 34.55.55.234 (GCP)
+-----------------+
        |
        v
+-----------------+
|   GCP NPM       |  Nginx Proxy Manager
|   auth_request  |---> Authelia (localhost:9091)
+-----------------+           |
        |                     v
        |            [No Session?]
        |                     |
        v                     v
  REDIRECT 302     auth.diegonmarcos.com
        |                (Login + TOTP)
        |                     |
        v                     v
[Cookie Set]      authelia_session cookie
        |          (domain: diegonmarcos.com)
        v
+-----------------+
|  WireGuard VPN  |  10.0.0.1 -> 10.0.0.2
+-----------------+
        |
        v
+-----------------+
|  OCI Photoprism |  Backend service (10.0.0.2:2342)
+-----------------+</div>
            </div>

            <!-- SSO Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">SSO Across Subdomains</h3>
                <div class="resources-section">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">Single Sign-On via shared Authelia session cookie (domain: diegonmarcos.com)</p>
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Protected Subdomain</th>
                                    <th>Service</th>
                                    <th>Auth Level</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>photos.diegonmarcos.com</td>
                                    <td>Photoprism Gallery</td>
                                    <td>2FA (TOTP)</td>
                                    <td><span class="status-badge on">Protected</span></td>
                                </tr>
                                <tr>
                                    <td>cloud.diegonmarcos.com</td>
                                    <td>Cloud Dashboard</td>
                                    <td>OAuth2 (GitHub)</td>
                                    <td><span class="status-badge on">Protected</span></td>
                                </tr>
                                <tr>
                                    <td>n8n.diegonmarcos.com</td>
                                    <td>n8n Workflows</td>
                                    <td>2FA (TOTP)</td>
                                    <td><span class="status-badge dev">DEV</span></td>
                                </tr>
                                <tr>
                                    <td>sync.diegonmarcos.com</td>
                                    <td>Syncthing</td>
                                    <td>Basic Auth</td>
                                    <td><span class="status-badge on">Protected</span></td>
                                </tr>
                                <tr>
                                    <td>mail.diegonmarcos.com</td>
                                    <td>Mailu Admin</td>
                                    <td>2FA (TOTP)</td>
                                    <td><span class="status-badge on">Protected</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- API OAuth Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">API OAuth Integration</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table">
                            <thead>
                                <tr>
                                    <th>Application</th>
                                    <th>OAuth Provider</th>
                                    <th>Scopes</th>
                                    <th>Purpose</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Cloud Dashboard</strong></td>
                                    <td>GitHub OAuth2</td>
                                    <td>read:user, workflow</td>
                                    <td>Admin authentication, workflow dispatch</td>
                                </tr>
                                <tr>
                                    <td><strong>MyPhotos</strong></td>
                                    <td>GitHub OAuth2</td>
                                    <td>read:user</td>
                                    <td>Access control for photo gallery</td>
                                </tr>
                                <tr>
                                    <td><strong>MyMail</strong></td>
                                    <td>GitHub OAuth2</td>
                                    <td>read:user</td>
                                    <td>Admin panel authentication</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div><!-- End Security Tab -->

        <!-- Infrastructure Tab Content (Status View) -->
        <div id="infra-tab" class="tab-content">

        <!-- Infrastructure View Toggle -->
        <div class="infra-view-toggle" style="display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 1.5rem;">
            <button class="view-btn active" data-infra-view="by-vm">By VM</button>
            <button class="view-btn" data-infra-view="by-type">By Type</button>
        </div>

        <!-- BY VM VIEW -->
        <div id="infra-by-vm-view" class="infra-view-content active">
            <!-- VMs Section -->
            <div class="resources-category">
                <h3 class="resources-category-title">VMs</h3>
                <div class="resources-section">
                    <div class="resources-table-container">
                        <table class="resources-table status-table">
                            <thead><tr><th>Host</th><th>VM</th><th>IP</th><th>OS</th><th>Actions</th></tr></thead>
                            <tbody id="infra-vms-tbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Services Section (Grouped by VM) -->
            <div class="resources-category">
                <h3 class="resources-category-title">Services</h3>
                <div id="infra-services-by-vm-container"></div>
            </div>
        </div>

        <!-- BY TYPE VIEW -->
        <div id="infra-by-type-view" class="infra-view-content" style="display: none;">
            <!-- A120) Security Services -->
            <div class="resources-category">
                <h3 class="resources-category-title">A120) Security Services</h3>
                <div class="resources-section">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.85rem;">Backup, security, and data protection services</p>
                    <div id="infra-type-security"></div>
                </div>
            </div>

            <!-- A120b) Auth & Proxy Services -->
            <div class="resources-category">
                <h3 class="resources-category-title">A120b) Auth & Proxy Services</h3>
                <div class="resources-section">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.85rem;">Web servers, OAuth2, Authelia 2FA, VPN, and reverse proxies</p>
                    <div id="infra-type-auth-proxy"></div>
                </div>
            </div>

            <!-- A121) Audit -->
            <div class="resources-category">
                <h3 class="resources-category-title">A121) Audit & Analytics</h3>
                <div class="resources-section">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.85rem;">Analytics, logging, and audit services</p>
                    <div id="infra-type-audit"></div>
                </div>
            </div>

            <!-- A122) Data & API & MCP -->
            <div class="resources-category">
                <h3 class="resources-category-title">A122) Data & API & MCP</h3>
                <div class="resources-section">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.85rem;">APIs, caching, databases, and Model Context Protocol services</p>
                    <div id="infra-type-data-api"></div>
                </div>
            </div>

            <!-- A123) Others -->
            <div class="resources-category">
                <h3 class="resources-category-title">A123) Other Services</h3>
                <div class="resources-section">
                    <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.85rem;">User-facing and miscellaneous services</p>
                    <div id="infra-type-others"></div>
                </div>
            </div>
        </div>

        </div><!-- End Infrastructure Tab -->

    </div>

    <!-- Load local data as fallback (generated by cloud_dash.py --export js) -->
    <script src="cloud_dash_data.js"></script>
    <script src="ccusage_data.js"></script>
    <script src="cloud_costs_data.js"></script>

    <script>
        // =================================================================
        // CONFIGURATION
        // =================================================================
        const apiUrl = 'http://34.55.55.234:5000/api';
        const GITHUB_CLIENT_ID = 'Ov23liOg9JhezyYUCHmS';
        const GITHUB_REDIRECT_URI = window.location.href.split('?')[0];

        // =================================================================
        // STATE
        // =================================================================
        const isGitHubPages = window.location.hostname.includes('github.io');
        let autoRefreshInterval = null;
        let isLoading = false;
        let isLoggedIn = false;
        let githubUser = null;

        // =================================================================
        // DATA SOURCE: Try API first, fallback to local .js files
        // =================================================================

        // =================================================================
        // RENDER TABLES FROM CONFIG (JSON is source of truth!)
        // =================================================================
        function renderTablesFromConfig() {
            if (typeof CONFIG === 'undefined') {
                console.error('CONFIG not loaded');
                return;
            }

            // ===== RENDER VMs TABLE =====
            const vmsTbody = document.getElementById('vms-tbody');
            if (vmsTbody) {
                vmsTbody.innerHTML = '';
                Object.values(CONFIG.virtualMachines || {}).forEach(vm => {
                    const statusBadge = vm.status === 'active' ? 'on' : vm.status === 'pending' ? 'tbd' : vm.status === 'hold' ? 'hold' : 'dev';
                    const provider = CONFIG.providers?.[vm.provider];
                    const hostName = provider?.name || vm.provider || 'Unknown';
                    const ip = vm.network?.publicIp || 'pending';

                    // Actions column with SSH copy and URL open buttons
                    const sshCommand = vm.ssh?.command || `ssh ${vm.ssh?.user || 'root'}@${ip}`;
                    const consoleUrl = vm.ociInstanceId ? `https://cloud.oracle.com/compute/instances/${vm.ociInstanceId}` : (provider?.consoleUrl || '');

                    vmsTbody.innerHTML += `
                        <tr class="vm-row">
                            <td><span class="status-badge ${statusBadge}">${statusBadge.toUpperCase()}</span></td>
                            <td>${hostName}</td>
                            <td><strong>${vm.name}</strong></td>
                            <td><code class="ip-address">${ip}</code></td>
                            <td><span class="live-status checking" data-vm="${vm.id}"><span class="live-dot"></span>Checking...</span></td>
                            <td>
                                <div class="vm-actions-inline">
                                    <button class="vm-action-btn btn-ssh" onclick="copyToClipboard('${sshCommand.replace(/'/g, "\\'")}', 'SSH command copied!')" title="Copy SSH command">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                                        </svg>
                                    </button>
                                    <button class="vm-action-btn btn-url" onclick="window.open('${consoleUrl}', '_blank')" ${!consoleUrl ? 'disabled' : ''} title="Open cloud console">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                            <polyline points="15 3 21 3 21 9"/>
                                            <line x1="10" y1="14" x2="21" y2="3"/>
                                        </svg>
                                    </button>
                                    <button class="vm-action-btn btn-reset" data-vm-reset="${vm.id}" onclick="resetVM('${vm.id}')" title="Reset VM (reboot if running, start if stopped)">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M23 4v6h-6M1 20v-6h6"/>
                                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>`;
                });
            }

            // ===== RENDER SERVICES TABLE (UNIFIED HIERARCHICAL) =====
            const servicesTbody = document.getElementById('services-tbody');
            const backlogTbody = document.getElementById('backlog-tbody');

            if (servicesTbody && backlogTbody) {
                servicesTbody.innerHTML = '';
                backlogTbody.innerHTML = '';

                // Get all parent services (those without parentService property)
                const parentServices = Object.values(CONFIG.services || {})
                    .filter(svc => !svc.parentService);

                parentServices.forEach(parent => {
                    // Skip if DEV/HOLD - goes to backlog
                    if (parent.status === 'dev' || parent.status === 'hold') {
                        const vm = CONFIG.virtualMachines?.[parent.vmId];
                        backlogTbody.innerHTML += `
                            <tr>
                                <td><strong>${parent.displayName || parent.name}</strong></td>
                                <td><span class="status-badge ${parent.status}">${parent.status.toUpperCase()}</span></td>
                                <td>${vm?.name || 'TBD'}</td>
                                <td>${parent.notes || '-'}</td>
                            </tr>
                        `;
                        return;
                    }

                    // Get child services
                    const children = Object.values(CONFIG.services || {})
                        .filter(svc => svc.parentService === parent.id);

                    const vm = CONFIG.virtualMachines?.[parent.vmId];
                    const vmName = vm?.name || '-';

                    // Find the NPM proxy serving this service
                    const npmService = Object.values(CONFIG.services || {})
                        .find(svc => svc.vmId === vm?.id && svc.id.includes('npm'));
                    const proxyName = npmService?.displayName || npmService?.name || '-';

                    const url = parent.urls?.gui || parent.urls?.api || parent.network?.domain || '-';
                    const ip = vm?.network?.publicIp || '-';

                    // Parent row
                    const appChild = children.find(c => c.id.endsWith('-app'));
                    const statusServiceId = appChild?.id || parent.id;

                    servicesTbody.innerHTML += `
                        <tr class="service-parent-row">
                            <td><strong>${vmName}</strong></td>
                            <td><strong>${parent.displayName || parent.name}</strong></td>
                            <td>${url !== '-' ? `<a href="${url}" target="_blank" style="color: var(--accent-blue)">${url}</a>` : '-'}</td>
                            <td>-</td>
                            <td>${proxyName}</td>
                            <td><span class="live-status checking" data-service="${statusServiceId}"><span class="live-dot"></span>Checking...</span></td>
                        </tr>
                    `;

                    // Child rows (indented)
                    children.forEach(child => {
                        const port = child.network?.proxyAddress?.split(':')[1] || '-';
                        const ipPort = port !== '-' ? `${ip}:${port}` : '-';

                        servicesTbody.innerHTML += `
                            <tr class="service-child-row">
                                <td></td>
                                <td class="child-service-name"> ${child.displayName || child.name}</td>
                                <td>-</td>
                                <td><code>${ipPort}</code></td>
                                <td>-</td>
                                <td><span class="status-badge ${child.status}">${child.status.toUpperCase()}</span></td>
                            </tr>
                        `;
                    });
                });
            }

            console.log('Tables rendered from CONFIG');
        }

        function copyToClipboard(text, message) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification(message || 'Copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }

        // =================================================================
        // REFRESH FUNCTION
        // Single mode: Try API first, fallback to local .js files on error
        // =================================================================
        function refreshAll() {
            fetchFromAPI();  // Always try API first, falls back to local on error
        }

        function fetchFromLocal() {
            console.log('fetchFromLocal() called');
            const connectionStatus = document.getElementById('connection-status');
            connectionStatus.classList.add('disconnected');

            if (typeof CONFIG === 'undefined') {
                console.error('CONFIG not loaded - cloud_dash_data.js missing');
                document.getElementById('last-updated').textContent = 'No local data';
                return;
            }

            console.log('CONFIG loaded, virtualMachines:', Object.keys(CONFIG.virtualMachines || {}));
            console.log('CONFIG loaded, services:', Object.keys(CONFIG.services || {}));

            // Helper function to determine VM status
            // Priority: 1. Live runtimeStatus from API  2. Wake-on-demand = Dormant  3. Static status from config
            function getVMStatus(vm) {
                // Check if we have live runtime status from API
                const liveStatus = CONFIG.runtimeStatus?.vms?.[vm.id];
                if (liveStatus?.Online !== undefined) {
                    return liveStatus.Online ? 'Online' : 'Offline';
                }
                // Wake-on-demand VMs are dormant by default (unless live status says otherwise)
                if (vm.availability === 'wake-on-demand') {
                    return 'Dormant';
                }
                // Fall back to static config status
                switch (vm.status) {
                    case 'active': return 'Online';  // Config says VM should be running
                    case 'pending': return 'Pending';
                    case 'hold': return 'Hold';
                    case 'tbd': return 'TBD';
                    default: return 'Unknown';
                }
            }

            // Convert CONFIG to API-like format
            const data = {
                vms: [{
                    category: 'All VMs',
                    vms: Object.values(CONFIG.virtualMachines || {}).map(vm => ({
                        id: vm.id,
                        status: getVMStatus(vm)
                    }))
                }],
                services: [{
                    category: 'All Services',
                    services: Object.values(CONFIG.services || {})
                        .filter(svc => svc.parentService)
                        .map(svc => ({
                            id: svc.id,
                            health_status: svc.status === 'on' ? 'healthy' :
                                           svc.status === 'dev' ? 'development' :
                                           svc.status === 'hold' ? 'hold' : 'tbd'
                        }))
                }]
            };

            console.log('Data for updateDashboard:', JSON.stringify(data, null, 2));
            try {
                updateDashboard(data);
            } catch (e) {
                console.error('updateDashboard ERROR:', e);
            }
            // Show config lastUpdated timestamp if available, otherwise current time
            const configDate = CONFIG.lastUpdated ? `Config: ${CONFIG.lastUpdated}` : '';
            document.getElementById('last-updated').textContent = new Date().toLocaleTimeString() + ' (local)' + (configDate ? ` | ${configDate}` : '');
            console.log('fetchFromLocal() completed');
        }

        // Fetch full config from API and render tables (for API mode without local JS file)
        async function fetchConfigFromAPI() {
            try {
                const response = await fetch(`${apiUrl}/config`);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const config = await response.json();
                window.CONFIG = config;
                renderTablesFromConfig();
            } catch (error) {
                console.error('Failed to fetch config from API:', error);
            }
        }

        async function fetchFromAPI() {
            if (isLoading) return;
            isLoading = true;

            const refreshBtn = document.getElementById('refresh-btn');
            const connectionStatus = document.getElementById('connection-status');
            refreshBtn.classList.add('loading');

            try {
                const response = await fetch(`${apiUrl}/dashboard/summary`);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const apiData = await response.json();

                // API already returns data in the correct format for updateDashboard()
                // Format: { vms: [{category, vms: [{id, status}]}], services: [{category, services: [{id, health_status}]}] }
                connectionStatus.classList.remove('disconnected');
                updateDashboard(apiData);
                document.getElementById('last-updated').textContent = new Date().toLocaleTimeString();
            } catch (error) {
                console.error('API Error:', error);
                console.log('Falling back to local .js files...');
                connectionStatus.classList.add('disconnected');
                // Fallback to local data on API error
                fetchFromLocal();
            } finally {
                refreshBtn.classList.remove('loading');
                isLoading = false;
            }
        }

        function updateDashboard(data) {
            console.log('updateDashboard() called with', data.vms[0]?.vms?.length, 'VMs and', data.services[0]?.services?.length, 'services');

            // Update VM statuses
            data.vms.forEach(cat => {
                cat.vms.forEach(vm => {
                    const el = document.querySelector(`[data-vm="${vm.id}"]`);
                    console.log(`VM ${vm.id}: element found = ${!!el}, status = ${vm.status}`);
                    if (el) {
                        const status = vm.status.toLowerCase().replace(' ', '-');
                        const statusMap = {
                            'online': { class: 'online', label: 'Online' },
                            'offline': { class: 'offline', label: 'Offline' },
                            'dormant': { class: 'dormant', label: 'Dormant' },
                            'no-ssh': { class: 'pending', label: 'No SSH' },
                            'pending': { class: 'pending', label: 'Pending' },
                            'hold': { class: 'hold', label: 'Hold' },
                            'tbd': { class: 'pending', label: 'TBD' },
                            'unknown': { class: 'pending', label: 'Unknown' }
                        };
                        const s = statusMap[status] || { class: 'checking', label: vm.status };
                        el.className = 'live-status ' + s.class;
                        el.innerHTML = `<span class="live-dot"></span>${s.label}`;
                    }
                });
            });

            // Update Service statuses
            data.services.forEach(cat => {
                cat.services.forEach(svc => {
                    const el = document.querySelector(`[data-service="${svc.id}"]`);
                    console.log(`Service ${svc.id}: element found = ${!!el}, status = ${svc.health_status}`);
                    if (el) {
                        const statusMap = {
                            'healthy': { class: 'online', label: 'Healthy' },
                            'error': { class: 'offline', label: 'Error' },
                            'development': { class: 'dev', label: 'Dev' },
                            'hold': { class: 'hold', label: 'Hold' },
                            'tbd': { class: 'pending', label: 'TBD' },
                            'no_url': { class: 'pending', label: 'N/A' }
                        };
                        const s = statusMap[svc.health_status] || { class: 'checking', label: svc.health_status };
                        el.className = 'live-status ' + s.class;
                        el.innerHTML = `<span class="live-dot"></span>${s.label}`;
                    }
                });
            });
            console.log('updateDashboard() completed');
        }

        // =================================================================
        // AUTO-REFRESH
        // API mode: fetch every 30s
        // Local mode: reload page every 30s
        // =================================================================
        document.getElementById('auto-refresh').addEventListener('change', function() {
            if (this.checked) {
                autoRefreshInterval = setInterval(refreshAll, 30000);
            } else {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        });


        // =================================================================
        // GitHub OAuth Functions
        // =================================================================
        function handleGitHubLogin() {
            if (isLoggedIn) {
                // Logout
                logout();
            } else {
                // Login - redirect to GitHub OAuth
                const authUrl = `https://github.com/login/oauth/authorize?client_id=${GITHUB_CLIENT_ID}&redirect_uri=${encodeURIComponent(GITHUB_REDIRECT_URI)}&scope=read:user`;
                window.location.href = authUrl;
            }
        }

        function logout() {
            isLoggedIn = false;
            githubUser = null;
            localStorage.removeItem('github_token');
            localStorage.removeItem('github_user');
            updateLoginUI();
            updateRebootButtons();
        }

        function updateLoginUI() {
            const btn = document.getElementById('github-login-btn');
            const text = document.getElementById('github-login-text');

            if (isLoggedIn && githubUser) {
                btn.classList.add('logged-in');
                btn.innerHTML = `
                    <img src="${githubUser.avatar_url}" alt="" class="user-avatar">
                    <span>${githubUser.login}</span>
                    <button class="logout-btn" onclick="event.stopPropagation(); logout();">Logout</button>
                `;
            } else {
                btn.classList.remove('logged-in');
                btn.innerHTML = `
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                    </svg>
                    <span>Login</span>
                `;
            }
        }

        function updateRebootButtons() {
            const buttons = document.querySelectorAll('.reboot-btn');
            buttons.forEach(btn => {
                if (isLoggedIn) {
                    btn.disabled = false;
                    btn.classList.add('enabled');
                } else {
                    btn.disabled = true;
                    btn.classList.remove('enabled');
                }
            });
        }

        async function handleOAuthCallback() {
            // Check for error in URL
            const urlParams = new URLSearchParams(window.location.search);
            const error = urlParams.get('error');

            if (error) {
                window.history.replaceState({}, document.title, window.location.pathname);
                alert('GitHub login failed: ' + error);
                return;
            }

            // The backend callback already stored token in localStorage via JavaScript redirect
            // Just clean up the URL if there's a code param (shouldn't happen but just in case)
            const code = urlParams.get('code');
            if (code) {
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        function checkExistingLogin() {
            const token = localStorage.getItem('github_token');
            const user = localStorage.getItem('github_user');

            if (token && user) {
                try {
                    githubUser = JSON.parse(user);
                    isLoggedIn = true;
                    updateLoginUI();
                    updateRebootButtons();
                } catch (e) {
                    logout();
                }
            }
        }

        // Reboot VM function
        async function rebootVM(vmId) {
            if (!isLoggedIn) {
                alert('Please login with GitHub to reboot VMs');
                return;
            }

            const btn = document.querySelector(`[data-vm-reboot="${vmId}"]`);
            if (!btn || btn.classList.contains('loading')) return;

            if (!confirm(`Are you sure you want to reboot ${vmId}?`)) return;

            btn.classList.add('loading');
            btn.disabled = true;

            try {
                const token = localStorage.getItem('github_token');
                const response = await fetch(`${apiUrl}/vm/${vmId}/reboot`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    btn.classList.remove('loading');
                    btn.classList.add('success');
                    btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>Rebooting`;

                    setTimeout(() => {
                        btn.classList.remove('success');
                        btn.classList.add('enabled');
                        btn.disabled = false;
                        btn.innerHTML = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>Reboot`;
                    }, 3000);
                } else {
                    throw new Error(await response.text());
                }
            } catch (error) {
                console.error('Reboot error:', error);
                alert(`Reboot failed: ${error.message}`);
                btn.classList.remove('loading');
                btn.disabled = false;
            }
        }

        // Add click handlers to reboot buttons
        function initRebootButtons() {
            document.querySelectorAll('.reboot-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const vmId = btn.getAttribute('data-vm-reboot');
                    if (vmId) rebootVM(vmId);
                });
            });
        }

        // Reset VM function (reboot if running, start if stopped)
        async function resetVM(vmId) {
            if (!isLoggedIn) {
                alert('Please login with GitHub to reset VMs');
                return;
            }

            const btn = document.querySelector(`[data-vm-reset="${vmId}"]`);
            if (!btn || btn.classList.contains('loading')) return;

            if (!confirm(`Reset ${vmId}?\n\nThis will reboot if running, or start if stopped.`)) return;

            btn.classList.add('loading');

            try {
                const token = localStorage.getItem('github_token');
                const response = await fetch(`${apiUrl}/vm/${vmId}/reset`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();

                if (response.ok) {
                    btn.classList.remove('loading');
                    btn.classList.add('success');

                    // Show appropriate message based on action taken
                    const action = data.action || 'reset';
                    setTimeout(() => {
                        btn.classList.remove('success');
                        alert(`VM ${vmId}: ${action === 'started' ? 'Starting up...' : 'Rebooting...'}`);
                    }, 500);
                } else {
                    throw new Error(data.error || 'Reset failed');
                }
            } catch (error) {
                console.error('Reset error:', error);
                alert(`Reset failed: ${error.message}`);
                btn.classList.remove('loading');
            }
        }

        // Shutdown VM function (stop VM)
        async function shutdownVM(vmId) {
            if (!isLoggedIn) {
                alert('Please login with GitHub to shutdown VMs');
                return;
            }

            const btn = document.querySelector(`[onclick*="shutdownVM('${vmId}')"]`);
            if (!btn || btn.classList.contains('loading')) return;

            if (!confirm(`Shutdown ${vmId}?\n\nThis will stop the VM.`)) return;

            btn.classList.add('loading');

            try {
                const token = localStorage.getItem('github_token');
                const response = await fetch(`${apiUrl}/vm/${vmId}/stop`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();

                if (response.ok) {
                    btn.classList.remove('loading');
                    btn.classList.add('success');
                    setTimeout(() => {
                        btn.classList.remove('success');
                        alert(`VM ${vmId}: Shutting down...`);
                    }, 500);
                } else {
                    throw new Error(data.error || 'Shutdown failed');
                }
            } catch (error) {
                console.error('Shutdown error:', error);
                alert(`Shutdown failed: ${error.message}`);
                btn.classList.remove('loading');
            }
        }

        // ============================================
        // WAKE-ON-DEMAND FUNCTIONS
        // ============================================

        async function checkDevServerStatus() {
            try {
                const resp = await fetch(`${apiUrl}/wake/status`);
                const data = await resp.json();

                const statusEl = document.getElementById('dev-server-status');
                const textEl = document.getElementById('dev-server-status-text');
                const wakeBtn = document.getElementById('wake-dev-btn');

                if (data.state === 'RUNNING') {
                    statusEl.className = 'live-status online';
                    textEl.textContent = 'Running';
                    wakeBtn.disabled = true;
                    wakeBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>Running';
                } else if (data.state === 'STOPPED') {
                    statusEl.className = 'live-status offline';
                    textEl.textContent = 'Sleeping';
                    wakeBtn.disabled = false;
                    wakeBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>Wake';
                } else {
                    statusEl.className = 'live-status checking';
                    textEl.textContent = data.state || 'Unknown';
                }
            } catch (e) {
                console.error('Failed to check dev server status:', e);
            }
        }

        async function wakeDevServer() {
            const wakeBtn = document.getElementById('wake-dev-btn');
            const statusEl = document.getElementById('dev-server-status');
            const textEl = document.getElementById('dev-server-status-text');

            wakeBtn.disabled = true;
            wakeBtn.innerHTML = '<span class="spinner"></span> Waking...';
            statusEl.className = 'live-status checking';
            textEl.textContent = 'Waking...';

            try {
                const resp = await fetch(`${apiUrl}/wake/trigger`, { method: 'POST' });
                const data = await resp.json();

                if (data.success) {
                    // Poll for running status
                    let attempts = 0;
                    const maxAttempts = 24; // 2 minutes (24 * 5s)

                    const checkInterval = setInterval(async () => {
                        attempts++;
                        const statusResp = await fetch(`${apiUrl}/wake/status`);
                        const statusData = await statusResp.json();

                        if (statusData.state === 'RUNNING') {
                            clearInterval(checkInterval);
                            statusEl.className = 'live-status online';
                            textEl.textContent = 'Running';
                            wakeBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>Running';
                        } else if (attempts >= maxAttempts) {
                            clearInterval(checkInterval);
                            statusEl.className = 'live-status checking';
                            textEl.textContent = 'Timeout';
                            wakeBtn.disabled = false;
                            wakeBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>Wake';
                        }
                    }, 5000);
                } else {
                    throw new Error(data.message || 'Wake failed');
                }
            } catch (e) {
                console.error('Failed to wake dev server:', e);
                alert(`Failed to wake dev server: ${e.message}`);
                wakeBtn.disabled = false;
                wakeBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>Wake';
                statusEl.className = 'live-status offline';
                textEl.textContent = 'Sleeping';
            }
        }

        // ============================================
        // COST TAB FUNCTIONS
        // ============================================

        async function loadCostData() {
            // Use CCUSAGE_DATA if available (local JSON export)
            if (typeof CCUSAGE_DATA !== 'undefined') {
                loadCostDataFromCcusage();
                return;
            }
            // Fallback to API
            try {
                const [aiDailyResp, aiMonthlyResp] = await Promise.all([
                    fetch(`${apiUrl}/costs/ai/daily`),
                    fetch(`${apiUrl}/costs/ai/monthly`)
                ]);
                const aiDailyData = await aiDailyResp.json();
                const aiMonthlyData = await aiMonthlyResp.json();
                if (!aiDailyData.error && Array.isArray(aiDailyData)) updateDailyTable(aiDailyData);
                if (!aiMonthlyData.error && Array.isArray(aiMonthlyData)) updateMonthlyTable(aiMonthlyData);
            } catch (error) {
                console.error('Error loading cost data:', error);
            }
        }

        function loadCostDataFromCcusage() {
            const data = CCUSAGE_DATA;

            // Update hero section totals
            const heroValue = document.querySelector('.ai-cost-hero-value');
            if (heroValue) heroValue.textContent = `$${data.totals.totalCost.toFixed(2)}`;

            // Update hero cards
            const today = data.daily[0];
            const thisMonth = data.monthly[0];
            const lastMonth = data.monthly[1];

            updateHeroCards(today, thisMonth, lastMonth);
            updateDonutChart(data.modelStats, data.totals.totalCost);
            updateTokenStats(data.totals);
            updateDailyBarChart(data.daily.slice(0, 14));
            updateWeeklyBars(data.weekly);
            updateSessionList(data.sessions);
            updateDailyTableFromCcusage(data.daily.slice(0, 14));
            updateMonthlyTableFromCcusage(data.monthly);

            // Also load cloud infrastructure costs
            if (typeof CLOUD_COSTS_DATA !== 'undefined') {
                loadCloudCostsData();
            }
        }

        function updateHeroCards(today, thisMonth, lastMonth) {
            const cards = document.querySelectorAll('.ai-cost-card');
            if (cards[0]) {
                cards[0].querySelector('.ai-cost-card-value').textContent = `$${today?.totalCost?.toFixed(2) || '0.00'}`;
            }
            if (cards[1]) {
                cards[1].querySelector('.ai-cost-card-value').textContent = `$${thisMonth?.totalCost?.toFixed(2) || '0.00'}`;
            }
            if (cards[2] && lastMonth) {
                cards[2].querySelector('.ai-cost-card-value').textContent = `$${lastMonth?.totalCost?.toFixed(2) || '0.00'}`;
            }
            if (cards[3]) {
                const avgDaily = thisMonth ? (thisMonth.totalCost / new Date().getDate()) : 0;
                cards[3].querySelector('.ai-cost-card-value').textContent = `$${avgDaily.toFixed(2)}`;
            }
        }

        function updateDonutChart(modelStats, total) {
            // Update SVG donut segments
            const circumference = 251; // 2 * PI * 40
            let offset = 0;

            const opus = modelStats['claude-opus-4-5-20251101'];
            const sonnet = modelStats['claude-sonnet-4-5-20250929'];
            const haiku = modelStats['claude-haiku-4-5-20251001'];

            const opusPct = opus ? opus.percentOfTotal / 100 : 0;
            const sonnetPct = sonnet ? sonnet.percentOfTotal / 100 : 0;
            const haikuPct = haiku ? haiku.percentOfTotal / 100 : 0;

            const opusCircle = document.querySelector('.ai-donut-opus');
            const sonnetCircle = document.querySelector('.ai-donut-sonnet');
            const haikuCircle = document.querySelector('.ai-donut-haiku');

            if (opusCircle) {
                opusCircle.setAttribute('stroke-dasharray', `${opusPct * circumference} ${circumference}`);
                opusCircle.setAttribute('stroke-dashoffset', `${-offset}`);
                offset += opusPct * circumference;
            }
            if (sonnetCircle) {
                sonnetCircle.setAttribute('stroke-dasharray', `${sonnetPct * circumference} ${circumference}`);
                sonnetCircle.setAttribute('stroke-dashoffset', `${-offset}`);
                offset += sonnetPct * circumference;
            }
            if (haikuCircle) {
                haikuCircle.setAttribute('stroke-dasharray', `${haikuPct * circumference} ${circumference}`);
                haikuCircle.setAttribute('stroke-dashoffset', `${-offset}`);
            }

            // Update center
            const centerValue = document.querySelector('.ai-donut-value');
            if (centerValue) centerValue.textContent = `$${total.toFixed(0)}`;

            // Update legend
            const legendItems = document.querySelectorAll('.ai-donut-legend-item');
            if (legendItems[0] && opus) {
                legendItems[0].querySelector('.ai-donut-legend-value').textContent = `$${opus.totalCost.toFixed(2)}`;
                legendItems[0].querySelector('.ai-donut-legend-pct').textContent = `${opus.percentOfTotal.toFixed(1)}%`;
            }
            if (legendItems[1] && sonnet) {
                legendItems[1].querySelector('.ai-donut-legend-value').textContent = `$${sonnet.totalCost.toFixed(2)}`;
                legendItems[1].querySelector('.ai-donut-legend-pct').textContent = `${sonnet.percentOfTotal.toFixed(1)}%`;
            }
            if (legendItems[2] && haiku) {
                legendItems[2].querySelector('.ai-donut-legend-value').textContent = `$${haiku.totalCost.toFixed(2)}`;
                legendItems[2].querySelector('.ai-donut-legend-pct').textContent = `${haiku.percentOfTotal.toFixed(1)}%`;
            }
        }

        function updateTokenStats(totals) {
            const formatTokens = (n) => {
                if (n >= 1e9) return (n / 1e9).toFixed(2) + 'B';
                if (n >= 1e6) return (n / 1e6).toFixed(2) + 'M';
                if (n >= 1e3) return (n / 1e3).toFixed(2) + 'K';
                return n.toString();
            };

            const total = totals.totalTokens || 1;
            const inputPct = (totals.inputTokens / total) * 100;
            const outputPct = (totals.outputTokens / total) * 100;
            const cacheCreatePct = (totals.cacheCreationTokens / total) * 100;
            const cacheReadPct = (totals.cacheReadTokens / total) * 100;

            const tokenCards = document.querySelectorAll('.ai-token-card');
            if (tokenCards[0]) {
                tokenCards[0].querySelector('.ai-token-value').textContent = formatTokens(totals.inputTokens);
                tokenCards[0].querySelector('.ai-token-bar-fill').style.width = `${Math.min(inputPct * 10, 100)}%`;
            }
            if (tokenCards[1]) {
                tokenCards[1].querySelector('.ai-token-value').textContent = formatTokens(totals.outputTokens);
                tokenCards[1].querySelector('.ai-token-bar-fill').style.width = `${Math.min(outputPct * 10, 100)}%`;
            }
            if (tokenCards[2]) {
                tokenCards[2].querySelector('.ai-token-value').textContent = formatTokens(totals.cacheCreationTokens);
                tokenCards[2].querySelector('.ai-token-bar-fill').style.width = `${Math.min(cacheCreatePct, 100)}%`;
            }
            if (tokenCards[3]) {
                tokenCards[3].querySelector('.ai-token-value').textContent = formatTokens(totals.cacheReadTokens);
                tokenCards[3].querySelector('.ai-token-label').textContent = `Cache Read (${cacheReadPct.toFixed(0)}%)`;
                tokenCards[3].querySelector('.ai-token-bar-fill').style.width = `${Math.min(cacheReadPct, 100)}%`;
            }
        }

        function updateDailyBarChart(dailyData) {
            const container = document.querySelector('.ai-bar-chart');
            if (!container) return;

            const maxCost = Math.max(...dailyData.map(d => d.totalCost));
            container.innerHTML = dailyData.map(day => {
                const height = maxCost > 0 ? (day.totalCost / maxCost) * 160 : 4;
                const dateShort = new Date(day.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                return `<div class="ai-bar">
                    <div class="ai-bar-value">$${day.totalCost.toFixed(0)}</div>
                    <div class="ai-bar-fill" style="height: ${height}px;"></div>
                    <div class="ai-bar-label">${dateShort}</div>
                </div>`;
            }).reverse().join('');
        }

        function updateWeeklyBars(weeklyData) {
            const container = document.querySelector('.ai-weekly-bars');
            if (!container) return;

            const maxCost = Math.max(...weeklyData.map(w => w.totalCost));
            container.innerHTML = weeklyData.map(week => {
                const width = maxCost > 0 ? (week.totalCost / maxCost) * 100 : 0;
                const weekLabel = `Week ${new Date(week.week).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}`;
                return `<div class="ai-weekly-row">
                    <div class="ai-weekly-label">${weekLabel}</div>
                    <div class="ai-weekly-bar"><div class="ai-weekly-bar-fill" style="width: ${width}%;"></div></div>
                    <div class="ai-weekly-value">$${week.totalCost.toFixed(2)}</div>
                </div>`;
            }).join('');
        }

        function updateSessionList(sessions) {
            const container = document.querySelector('.ai-session-list');
            if (!container) return;

            const formatTokens = (n) => {
                if (n >= 1e9) return (n / 1e9).toFixed(1) + 'B';
                if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
                if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K';
                return n.toString();
            };

            container.innerHTML = sessions.sort((a, b) => b.totalCost - a.totalCost).map(s => {
                return `<div class="ai-session-item">
                    <div class="ai-session-name" title="${s.sessionId}">${s.projectPath || s.sessionId}</div>
                    <div class="ai-session-tokens">${formatTokens(s.totalTokens)}</div>
                    <div class="ai-session-cost">$${s.totalCost.toFixed(2)}</div>
                </div>`;
            }).join('');
        }

        function updateDailyTableFromCcusage(dailyData) {
            const tbody = document.getElementById('daily-cost-table');
            if (!tbody || !dailyData) return;

            const maxCost = Math.max(...dailyData.map(d => d.totalCost));
            tbody.innerHTML = dailyData.map((day, idx) => {
                const opusCost = day.modelBreakdowns?.find(m => m.modelName.includes('opus'))?.cost || 0;
                const sonnetCost = day.modelBreakdowns?.find(m => m.modelName.includes('sonnet'))?.cost || 0;
                const haikuCost = day.modelBreakdowns?.find(m => m.modelName.includes('haiku'))?.cost || 0;
                const barWidth = maxCost > 0 ? (day.totalCost / maxCost) * 100 : 0;
                const trend = idx < dailyData.length - 1 ? (day.totalCost > dailyData[idx + 1].totalCost ? '' : '') : '-';
                return `<tr>
                    <td>${day.date}</td>
                    <td>$${opusCost.toFixed(2)}</td>
                    <td>$${sonnetCost.toFixed(2)}</td>
                    <td>$${haikuCost.toFixed(2)}</td>
                    <td class="cost">$${day.totalCost.toFixed(2)}</td>
                    <td><div class="ai-mini-bar"><div class="ai-mini-bar-fill" style="width: ${barWidth}%;"></div></div></td>
                    <td>${trend}</td>
                </tr>`;
            }).join('');
        }

        function updateMonthlyTableFromCcusage(monthlyData) {
            const tbody = document.getElementById('monthly-cost-table');
            if (!tbody || !monthlyData) return;

            const maxCost = Math.max(...monthlyData.map(m => m.totalCost));
            tbody.innerHTML = monthlyData.map(month => {
                const opusCost = month.modelBreakdowns?.find(m => m.modelName.includes('opus'))?.cost || 0;
                const sonnetCost = month.modelBreakdowns?.find(m => m.modelName.includes('sonnet'))?.cost || 0;
                const haikuCost = month.modelBreakdowns?.find(m => m.modelName.includes('haiku'))?.cost || 0;
                const barWidth = maxCost > 0 ? (month.totalCost / maxCost) * 100 : 0;
                return `<tr>
                    <td>${month.month}</td>
                    <td>$${opusCost.toFixed(2)}</td>
                    <td>$${sonnetCost.toFixed(2)}</td>
                    <td>$${haikuCost.toFixed(2)}</td>
                    <td class="cost">$${month.totalCost.toFixed(2)}</td>
                    <td><div class="ai-mini-bar"><div class="ai-mini-bar-fill" style="width: ${barWidth}%;"></div></div></td>
                </tr>`;
            }).join('');
        }

        function updateDailyTable(data) {
            const tbody = document.getElementById('daily-cost-table');
            if (!tbody || !data || data.length === 0) return;
            tbody.innerHTML = data.map((day, idx) => {
                const trend = idx < data.length - 1 ? (day.total > data[idx + 1].total ? '' : '') : '-';
                return `<tr><td>${day.date || 'N/A'}</td><td>$${day.opus?.toFixed(2) || '0.00'}</td><td>$${day.sonnet?.toFixed(2) || '0.00'}</td><td>$${day.haiku?.toFixed(2) || '0.00'}</td><td><strong>$${day.total?.toFixed(2) || '0.00'}</strong></td><td>${trend}</td></tr>`;
            }).join('');
        }

        function updateMonthlyTable(data) {
            const tbody = document.getElementById('monthly-cost-table');
            if (!data || data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No data available</td></tr>';
                return;
            }
            tbody.innerHTML = data.map(month => `<tr><td><strong>${month.month || 'N/A'}</strong></td><td>$${month.opus?.toFixed(2) || '0.00'}</td><td>$${month.sonnet?.toFixed(2) || '0.00'}</td><td>$${month.haiku?.toFixed(2) || '0.00'}</td><td><strong>$${month.total?.toFixed(2) || '0.00'}</strong></td></tr>`).join('');
        }

        // ============================================
        // CLOUD INFRASTRUCTURE COSTS FUNCTIONS
        // ============================================

        function loadCloudCostsData() {
            const data = CLOUD_COSTS_DATA;
            if (!data) return;

            // Update last updated timestamp
            const updatedEl = document.getElementById('cloud-costs-updated');
            if (updatedEl && data.lastUpdated) {
                const date = new Date(data.lastUpdated);
                updatedEl.textContent = `Updated: ${date.toLocaleDateString()}`;
            }

            // Use totals (new structure) or summary (old structure) for backwards compatibility
            const totals = data.totals || data.summary || {};

            // Update hero cards
            const totalMonth = document.getElementById('cloud-total-month');
            const projected = document.getElementById('cloud-projected');
            const ytd = document.getElementById('cloud-ytd');
            const savings = document.getElementById('cloud-savings');
            const monthLabel = document.getElementById('cloud-month-label');

            if (totalMonth) totalMonth.textContent = `${(totals.totalMonthly || 0).toFixed(2)}`;
            if (projected) projected.textContent = `${(totals.projectedMonthly || 0).toFixed(2)}`;
            if (ytd) ytd.textContent = `${(totals.totalYTD || 0).toFixed(2)}`;
            if (savings) savings.textContent = `${(totals.freeTierSavings || 0).toFixed(2)}`;
            if (monthLabel) {
                const currentMonth = new Date().toLocaleString('en-US', { month: 'long', year: 'numeric' });
                monthLabel.textContent = currentMonth;
            }

            // Update donut chart
            renderCloudDonut(data.providers, totals.totalMonthly || 0);

            // Render provider breakdown cards
            renderCloudProviderCards(data.providers);

            // Render monthly trend bars
            renderCloudMonthlyBars(data.monthly || []);

            // Render service details table
            renderCloudServicesTable(data.providers);

            // Render free tier usage
            renderFreeTierUsage(data.providers);

            // Render market comparison
            renderMarketComparison(data.marketComparison);
        }

        function renderCloudDonut(providers, total) {
            const ociCircle = document.querySelector('.cloud-donut-oci');
            const gcpCircle = document.querySelector('.cloud-donut-gcp');
            const donutTotal = document.getElementById('cloud-donut-total');

            if (!ociCircle || !gcpCircle) return;

            // Calculate provider costs
            const ociCost = providers?.oci?.monthly?.[0]?.totalCost || 0;
            const gcpCost = providers?.gcloud?.monthly?.[0]?.totalCost || 0;
            const actualTotal = ociCost + gcpCost || 0.01; // Prevent division by zero

            // Calculate percentages
            const ociPercent = (ociCost / actualTotal) * 100;
            const gcpPercent = (gcpCost / actualTotal) * 100;

            // SVG circle properties (circumference = 2 * PI * 40  251)
            const circumference = 251;
            const ociDash = (ociPercent / 100) * circumference;
            const gcpDash = (gcpPercent / 100) * circumference;

            // Set OCI segment
            ociCircle.style.strokeDasharray = `${ociDash} ${circumference}`;
            ociCircle.style.strokeDashoffset = '0';

            // Set GCP segment (starts where OCI ends)
            gcpCircle.style.strokeDasharray = `${gcpDash} ${circumference}`;
            gcpCircle.style.strokeDashoffset = `-${ociDash}`;

            // Update center value
            if (donutTotal) {
                donutTotal.textContent = `${actualTotal.toFixed(2)}`;
            }
        }

        function renderCloudProviderCards(providers) {
            const container = document.getElementById('cloud-providers-container');
            if (!container) return;

            let html = '';
            for (const [key, provider] of Object.entries(providers)) {
                const currentMonth = provider.monthly[0];
                const prevMonth = provider.monthly[1];
                const trend = prevMonth ? (currentMonth.totalCost - prevMonth.totalCost) : 0;
                const trendIcon = trend > 0 ? '' : trend < 0 ? '' : '';
                const trendColor = trend > 0 ? 'var(--accent-red)' : trend < 0 ? 'var(--accent-green)' : 'var(--text-secondary)';
                const instanceCount = provider.instances?.length || 0;
                const region = provider.region || 'N/A';

                html += `
                <div style="background: var(--bg-secondary); border-radius: 12px; padding: 1.25rem; border-left: 4px solid ${provider.color}; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                        <div>
                            <div style="font-weight: 700; font-size: 1.1rem; color: var(--text-primary);">${provider.shortName || provider.name}</div>
                            <div style="font-size: 0.7rem; color: var(--text-secondary);">${provider.name}</div>
                        </div>
                        ${provider.freeTier ? `<span class="status-badge on" style="font-size: 0.65rem;">${provider.freeTierLabel || 'Free Tier'}</span>` : ''}
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.75rem;">
                        <div style="font-size: 2rem; font-weight: bold; color: ${provider.color};">${currentMonth.totalCost.toFixed(2)}</div>
                        <div style="font-size: 0.8rem; color: ${trendColor}; font-weight: 600;">${trendIcon} ${Math.abs(trend).toFixed(2)}</div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.75rem; color: var(--text-secondary); padding-top: 0.75rem; border-top: 1px solid var(--border-color);">
                        <div><strong>${instanceCount}</strong> instance${instanceCount !== 1 ? 's' : ''}</div>
                        <div style="text-align: right;">${region}</div>
                        <div><strong>${currentMonth.services.length}</strong> services</div>
                        <div style="text-align: right;">${currentMonth.month}</div>
                    </div>
                    ${provider.authRequired ? '<div style="margin-top: 0.75rem; font-size: 0.7rem; color: var(--accent-yellow); background: rgba(255,200,0,0.1); padding: 0.4rem 0.6rem; border-radius: 6px;"> ${provider.authMessage || "Requires auth for live data"}</div>' : ''}
                </div>
                `;
            }
            container.innerHTML = html;
        }

        function renderCloudMonthlyBars(monthly) {
            const container = document.getElementById('cloud-monthly-bars');
            if (!container || !monthly || !monthly.length) return;

            // Get last 6 months or available data
            const months = monthly.slice(0, 6).reverse();
            const maxCost = Math.max(...months.map(m => m.totalCost), 1);

            let html = '';
            months.forEach((month, i) => {
                const heightPercent = (month.totalCost / maxCost) * 100;
                const ociPercent = month.breakdown?.oci ? (month.breakdown.oci / month.totalCost) * 100 : 100;
                const gcpPercent = month.breakdown?.gcloud ? (month.breakdown.gcloud / month.totalCost) * 100 : 0;

                html += `
                <div class="ai-bar-group" style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
                    <div style="width: 100%; height: 100%; position: relative; display: flex; flex-direction: column; justify-content: flex-end;">
                        <div style="height: ${Math.max(heightPercent, 5)}%; min-height: 4px; display: flex; flex-direction: column; border-radius: 4px 4px 0 0; overflow: hidden;">
                            <div style="height: ${ociPercent}%; background: linear-gradient(180deg, #F80000, #cc0000);"></div>
                            <div style="height: ${gcpPercent}%; background: linear-gradient(180deg, #4285F4, #2a5db0);"></div>
                        </div>
                    </div>
                    <div style="font-size: 0.7rem; color: var(--text-secondary);">${month.label?.split(' ')[0]?.substring(0,3) || month.month}</div>
                    <div style="font-size: 0.75rem; font-weight: 600; color: var(--text-primary);">${month.totalCost.toFixed(2)}</div>
                </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderCloudServicesTable(providers) {
            const tbody = document.getElementById('cloud-services-tbody');
            if (!tbody) return;

            let html = '';
            for (const [key, provider] of Object.entries(providers)) {
                const currentMonth = provider.monthly[0];

                for (const service of currentMonth.services) {
                    const freeTierBadge = service.freeUsed
                        ? '<span class="status-badge on" style="font-size: 0.65rem;">Free</span>'
                        : '<span class="status-badge" style="font-size: 0.65rem; background: rgba(255,100,100,0.15); color: var(--accent-red); border: 1px solid var(--accent-red);">Paid</span>';

                    const costDisplay = service.cost > 0
                        ? `<span style="color: var(--accent-orange);">${service.cost.toFixed(2)}</span>`
                        : '<span style="color: var(--accent-green);">0.00</span>';

                    html += `
                    <tr>
                        <td><span style="color: ${provider.color}; font-weight: 600;">${provider.shortName || key.toUpperCase()}</span></td>
                        <td style="font-weight: 500;">${service.name}</td>
                        <td style="font-size: 0.75rem; color: var(--text-secondary);">${service.description || ''}</td>
                        <td><code style="background: var(--bg-tertiary); padding: 0.2rem 0.4rem; border-radius: 4px; font-size: 0.75rem;">${service.usage?.toFixed(2) || 0} ${service.unit || ''}</code></td>
                        <td style="font-weight: 600;">${costDisplay}</td>
                        <td>${freeTierBadge}</td>
                    </tr>
                    `;
                }
            }
            tbody.innerHTML = html || '<tr><td colspan="6" style="text-align: center;">No data available</td></tr>';
        }

        function renderFreeTierUsage(providers) {
            const container = document.getElementById('cloud-free-tier-container');
            if (!container) return;

            let html = '';
            for (const [key, provider] of Object.entries(providers)) {
                if (!provider.freeTierLimits) continue;

                html += `<div style="background: var(--bg-secondary); border-radius: 12px; padding: 1.25rem; border-left: 4px solid ${provider.color};">
                    <div style="font-weight: 700; font-size: 1rem; color: ${provider.color}; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                        <span>${provider.shortName || provider.name}</span>
                        <span style="font-size: 0.7rem; color: var(--text-secondary); font-weight: normal;">${provider.freeTierLabel || 'Free Tier'}</span>
                    </div>`;

                for (const [service, limits] of Object.entries(provider.freeTierLimits)) {
                    const percent = limits.percentage || 0;
                    const barColor = percent >= 90 ? 'var(--accent-red)' : percent >= 70 ? 'var(--accent-yellow)' : 'var(--accent-green)';

                    html += `
                    <div style="margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; margin-bottom: 0.4rem;">
                            <span style="color: var(--text-primary); font-weight: 500;">${service}</span>
                            <span style="color: var(--text-secondary);">${limits.used} / ${limits.limit}</span>
                        </div>
                        <div style="height: 8px; background: var(--bg-tertiary); border-radius: 4px; overflow: hidden;">
                            <div style="height: 100%; width: ${percent}%; background: ${barColor}; border-radius: 4px; transition: width 0.3s ease;"></div>
                        </div>
                        ${limits.note ? `<div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.25rem;">${limits.note}</div>` : ''}
                    </div>`;
                }

                html += `</div>`;
            }
            container.innerHTML = html || '<div style="color: var(--text-secondary);">No free tier data available</div>';
        }

        function renderMarketComparison(comparison) {
            const container = document.getElementById('cloud-market-comparison');
            if (!container || !comparison) return;

            const actualCost = comparison.actualCost || 0;
            const awsCost = comparison.equivalentAWS?.monthly || 0;
            const azureCost = comparison.equivalentAzure?.monthly || 0;
            const savings = comparison.savings || 0;
            const savingsPercent = comparison.savingsPercent || 0;

            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                    <div style="text-align: center; padding: 1rem; background: var(--bg-tertiary); border-radius: 8px;">
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Your Cost</div>
                        <div style="font-size: 2rem; font-weight: bold; color: var(--accent-green);">${actualCost.toFixed(2)}</div>
                        <div style="font-size: 0.7rem; color: var(--text-secondary);">OCI + GCP Free Tiers</div>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: var(--bg-tertiary); border-radius: 8px;">
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.5rem;">AWS Equivalent</div>
                        <div style="font-size: 2rem; font-weight: bold; color: var(--accent-orange);">${awsCost.toFixed(2)}</div>
                        <div style="font-size: 0.7rem; color: var(--text-secondary);">${comparison.equivalentAWS?.description || 't3.medium + EBS'}</div>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: var(--bg-tertiary); border-radius: 8px;">
                        <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Azure Equivalent</div>
                        <div style="font-size: 2rem; font-weight: bold; color: var(--accent-blue);">${azureCost.toFixed(2)}</div>
                        <div style="font-size: 0.7rem; color: var(--text-secondary);">${comparison.equivalentAzure?.description || 'B2s + SSD'}</div>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(0,200,100,0.1), rgba(0,150,80,0.1)); border-radius: 8px; border: 1px solid var(--accent-green);">
                        <div style="font-size: 0.75rem; color: var(--accent-green); margin-bottom: 0.5rem;">Your Savings</div>
                        <div style="font-size: 2rem; font-weight: bold; color: var(--accent-green);">${savings.toFixed(2)}</div>
                        <div style="font-size: 0.8rem; font-weight: 600; color: var(--accent-green);">${savingsPercent}% saved</div>
                    </div>
                </div>
            `;
        }

        // ============================================
        // RESOURCES TAB FUNCTIONS (htop-style)
        // ============================================

        async function loadResourcesData() {
            const monitor = document.getElementById('resources-monitor');
            if (!monitor) return;

            try {
                if (typeof CONFIG === 'undefined' || !CONFIG.virtualMachines) {
                    monitor.innerHTML = '<div class="htop-loading">No configuration data available</div>';
                    return;
                }

                const vms = Object.values(CONFIG.virtualMachines);
                const services = CONFIG.services || {};

                // Group services by VM
                const servicesByVM = {};
                Object.values(services).forEach(svc => {
                    if (svc.vmId) {
                        if (!servicesByVM[svc.vmId]) {
                            servicesByVM[svc.vmId] = [];
                        }
                        servicesByVM[svc.vmId].push(svc);
                    }
                });

                // Sort services by RAM usage (descending) within each VM
                Object.keys(servicesByVM).forEach(vmId => {
                    servicesByVM[vmId].sort((a, b) => {
                        const ramA = parseResourceValue(a.resources?.ram?.max || a.resources?.ram?.min || '0');
                        const ramB = parseResourceValue(b.resources?.ram?.max || b.resources?.ram?.min || '0');
                        return ramB - ramA;
                    });
                });

                // Render htop-style VM cards
                let html = '';
                vms.forEach(vm => {
                    const vmServices = servicesByVM[vm.id] || [];
                    const specs = vm.specs || {};

                    // Parse VM specs
                    const cpuText = specs.cpu || 'N/A';
                    const ramText = specs.ram || 'N/A';
                    const storageText = specs.storage || 'N/A';
                    const vramText = specs.vram || null;

                    // Calculate service usage totals
                    const ramTotal = parseResourceValue(ramText);
                    let ramUsed = 0;
                    let storageUsed = 0;

                    vmServices.forEach(svc => {
                        ramUsed += parseResourceValue(svc.resources?.ram?.max || svc.resources?.ram?.min || '0');
                        storageUsed += parseResourceValue(svc.resources?.storage?.max || svc.resources?.storage?.min || '0');
                    });

                    const storageTotal = parseResourceValue(storageText);
                    const ramPercent = ramTotal > 0 ? Math.min((ramUsed / ramTotal) * 100, 100) : 0;
                    const storagePercent = storageTotal > 0 ? Math.min((storageUsed / storageTotal) * 100, 100) : 0;

                    // CPU is simulated as core count for display
                    const cpuMatch = cpuText.match(/(\d+)/);
                    const cpuCores = cpuMatch ? parseInt(cpuMatch[1]) : 1;

                    html += `
                        <div class="htop-vm-card">
                            <div class="htop-vm-header">
                                <div class="htop-vm-title">
                                    <span class="htop-vm-name">${vm.name}</span>
                                    <span class="htop-vm-specs">${cpuText}  ${ramText}  ${storageText}</span>
                                </div>
                                <div class="htop-vm-status">
                                    <span class="htop-vm-badge ${vm.availability === 'wake-on-demand' ? 'dormant' : (vm.status === 'active' ? 'active' : 'stopped')}">${vm.availability === 'wake-on-demand' ? 'dormant' : (vm.status || 'unknown')}</span>
                                </div>
                            </div>

                            <div class="htop-bars-grid">
                                <div class="htop-bar-item">
                                    <div class="htop-bar-label">
                                        <span class="htop-bar-name">CPU</span>
                                        <span class="htop-bar-value">${cpuCores} core${cpuCores > 1 ? 's' : ''}</span>
                                    </div>
                                    <div class="htop-bar">
                                        <div class="htop-bar-fill cpu" style="width: ${vmServices.length > 0 ? 30 : 5}%"></div>
                                    </div>
                                </div>

                                <div class="htop-bar-item">
                                    <div class="htop-bar-label">
                                        <span class="htop-bar-name">RAM</span>
                                        <span class="htop-bar-value">${formatBytesCompact(ramUsed)} / ${ramText}</span>
                                    </div>
                                    <div class="htop-bar">
                                        <div class="htop-bar-fill ram ${getBarLevel(ramPercent)}" style="width: ${Math.max(ramPercent, 2)}%"></div>
                                    </div>
                                </div>

                                <div class="htop-bar-item">
                                    <div class="htop-bar-label">
                                        <span class="htop-bar-name">Storage</span>
                                        <span class="htop-bar-value">${formatBytesCompact(storageUsed)} / ${storageText}</span>
                                    </div>
                                    <div class="htop-bar">
                                        <div class="htop-bar-fill storage ${getBarLevel(storagePercent)}" style="width: ${Math.max(storagePercent, 2)}%"></div>
                                    </div>
                                </div>

                                ${vramText ? `
                                <div class="htop-bar-item">
                                    <div class="htop-bar-label">
                                        <span class="htop-bar-name">VRAM</span>
                                        <span class="htop-bar-value">${vramText}</span>
                                    </div>
                                    <div class="htop-bar">
                                        <div class="htop-bar-fill vram" style="width: 0%"></div>
                                    </div>
                                </div>
                                ` : ''}
                            </div>

                            <div class="htop-services">
                                <div class="htop-services-title">Services (${vmServices.length})  sorted by RAM</div>
                                ${vmServices.length > 0 ? `
                                <div class="htop-service-list">
                                    ${vmServices.map(svc => {
                                        const svcRam = parseResourceValue(svc.resources?.ram?.max || svc.resources?.ram?.min || '0');
                                        const svcStorage = parseResourceValue(svc.resources?.storage?.max || svc.resources?.storage?.min || '0');
                                        const svcRamPercent = ramTotal > 0 ? (svcRam / ramTotal) * 100 : 0;
                                        const svcStoragePercent = storageTotal > 0 ? (svcStorage / storageTotal) * 100 : 0;

                                        return `
                                        <div class="htop-service-row">
                                            <span class="htop-service-name">${svc.displayName || svc.name}</span>
                                            <div class="htop-service-bar" title="RAM: ${formatBytesCompact(svcRam)}">
                                                <div class="htop-service-bar-fill ram" style="width: ${Math.max(svcRamPercent, 2)}%"></div>
                                            </div>
                                            <span class="htop-service-value">${formatBytesCompact(svcRam)}</span>
                                        </div>
                                        `;
                                    }).join('')}
                                </div>
                                ` : '<div class="htop-no-services">No services deployed</div>'}
                            </div>
                        </div>
                    `;
                });

                monitor.innerHTML = html;

            } catch (error) {
                console.error('Error loading resources data:', error);
                monitor.innerHTML = `<div class="htop-loading" style="color: var(--accent-red);">Error: ${error.message}</div>`;
            }
        }

        function getBarLevel(percent) {
            if (percent < 60) return '';
            if (percent < 80) return 'warning';
            return 'danger';
        }

        function formatBytesCompact(bytes) {
            if (!bytes || bytes === 0) return '0';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            const value = bytes / Math.pow(k, i);
            return value < 10 ? value.toFixed(1) + ' ' + sizes[i] : Math.round(value) + ' ' + sizes[i];
        }

        function getGaugeColor(percent) {
            if (percent < 70) return '#51cf66';
            if (percent < 90) return '#ffc107';
            return '#ff6b6b';
        }

        async function killService(serviceId) {
            const isLoggedIn = localStorage.getItem('github_token');
            if (!isLoggedIn) {
                alert('Please login to kill services');
                return;
            }

            if (!confirm(`Are you sure you want to kill ${serviceId}? This will stop the container.`)) {
                return;
            }

            try {
                const token = localStorage.getItem('github_token');
                const response = await fetch(`${apiUrl}/service/${serviceId}/kill`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    showNotification(`${serviceId} killed successfully`);
                    setTimeout(() => loadResourcesData(), 1000);
                } else {
                    const error = await response.text();
                    throw new Error(error);
                }
            } catch (error) {
                alert(`Failed to kill service: ${error.message}`);
            }
        }

        function formatBytes(bytes) {
            if (!bytes || bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];
        }

        function parseResourceValue(value) {
            if (!value) return 0;
            if (typeof value === 'number') return value;
            const match = value.match(/(\d+(?:\.\d+)?)\s*([KMGT]?B)/i);
            if (!match) return 0;
            const num = parseFloat(match[1]);
            const unit = match[2].toUpperCase();
            const multipliers = { 'B': 1, 'KB': 1024, 'MB': 1024*1024, 'GB': 1024*1024*1024, 'TB': 1024*1024*1024*1024 };
            return num * (multipliers[unit] || 1);
        }

        function getUsageLevel(percent) {
            const p = parseFloat(percent);
            if (p < 60) return 'ok';
            if (p < 80) return 'warning';
            return 'danger';
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.classList.add('closing');
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // ============================================
        // INFRASTRUCTURE TAB (Status View)
        // ============================================
        function loadInfraData() {
            if (typeof CONFIG === 'undefined') return;

            // Populate VMs table
            const vmsTbody = document.getElementById('infra-vms-tbody');
            if (vmsTbody) {
                vmsTbody.innerHTML = '';
                Object.values(CONFIG.virtualMachines || {}).forEach(vm => {
                    const statusBadge = vm.status === 'active' ? 'on' : vm.status === 'pending' ? 'tbd' : vm.status === 'hold' ? 'hold' : 'dev';
                    const provider = CONFIG.providers?.[vm.provider];
                    const hostName = provider?.name || vm.provider || 'Unknown';
                    const ip = vm.network?.publicIp || 'pending';
                    const os = vm.specs?.os || vm.os || '-';
                    const sshCommand = vm.ssh?.command || `ssh ${vm.ssh?.user || 'root'}@${ip}`;
                    const consoleUrl = vm.ociInstanceId ? `https://cloud.oracle.com/compute/instances/${vm.ociInstanceId}` : (provider?.consoleUrl || '');

                    vmsTbody.innerHTML += `
                        <tr class="vm-row">
                            <td>${hostName}</td>
                            <td><strong>${vm.name}</strong></td>
                            <td><code class="ip-address">${ip}</code></td>
                            <td>${os}</td>
                            <td>
                                <div class="vm-actions-inline">
                                    <button class="vm-action-btn btn-ssh" onclick="copyToClipboard('${sshCommand.replace(/'/g, "\\'")}', 'SSH command copied!')" title="Copy SSH command">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                                    </button>
                                    <button class="vm-action-btn btn-url" onclick="window.open('${consoleUrl}', '_blank')" ${!consoleUrl ? 'disabled' : ''} title="Open cloud console">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                                    </button>
                                </div>
                            </td>
                        </tr>`;
                });
            }

            // Populate Services by VM
            const servicesContainer = document.getElementById('infra-services-by-vm-container');
            if (servicesContainer) {
                servicesContainer.innerHTML = '';
                const vms = Object.values(CONFIG.virtualMachines || {});
                const services = Object.values(CONFIG.services || {});

                vms.forEach(vm => {
                    const vmServices = services.filter(svc => svc.vmId === vm.id && svc.status === 'on');
                    if (vmServices.length === 0) return;

                    const vmIp = vm.network?.publicIp || '-';

                    let html = `
                        <div class="resources-section" style="margin-bottom: 1.5rem;">
                            <h4 style="color: var(--text-primary); margin-bottom: 0.75rem;">${vm.name}</h4>
                            <div class="resources-table-container">
                                <table class="resources-table status-table" style="font-size: 0.85rem;">
                                    <thead><tr><th>Service</th><th>URL</th><th>IP:PORT</th><th>Container</th><th>Brief</th></tr></thead>
                                    <tbody>`;

                    vmServices.forEach(svc => {
                        const url = svc.urls?.gui || svc.urls?.api || '-';
                        const port = svc.network?.port || '-';
                        const ipPort = port !== '-' ? `${vmIp}:${port}` : '-';
                        const container = svc.container || svc.containerName || svc.id || '-';
                        const brief = svc.description || svc.brief || '-';
                        html += `
                            <tr>
                                <td><strong>${svc.displayName || svc.name}</strong></td>
                                <td>${url !== '-' ? `<a href="${url}" target="_blank" style="color: var(--accent-blue);">${url}</a>` : '-'}</td>
                                <td><code>${ipPort}</code></td>
                                <td><code>${container}</code></td>
                                <td style="color: var(--text-secondary); font-size: 0.8rem;">${brief}</td>
                            </tr>`;
                    });

                    html += `</tbody></table></div></div>`;
                    servicesContainer.innerHTML += html;
                });
            }
        }

        // Populate Infrastructure By Type view
        function loadInfraByTypeData() {
            if (typeof CONFIG === 'undefined') return;

            const services = Object.values(CONFIG.services || {});
            const vms = CONFIG.virtualMachines || {};

            // Define service type categories
            const typeCategories = {
                'security': {
                    container: 'infra-type-security',
                    match: svc => ['backup', 'security', 'vault', 'encryption'].some(k =>
                        (svc.category || '').toLowerCase().includes(k) ||
                        (svc.name || '').toLowerCase().includes(k) ||
                        (svc.displayName || '').toLowerCase().includes(k)
                    )
                },
                'auth-proxy': {
                    container: 'infra-type-auth-proxy',
                    match: svc => ['proxy', 'npm', 'nginx', 'authelia', 'auth', 'oauth', 'vpn', 'tunnel'].some(k =>
                        (svc.category || '').toLowerCase().includes(k) ||
                        (svc.name || '').toLowerCase().includes(k) ||
                        (svc.displayName || '').toLowerCase().includes(k) ||
                        (svc.id || '').toLowerCase().includes(k)
                    )
                },
                'audit': {
                    container: 'infra-type-audit',
                    match: svc => ['matomo', 'analytics', 'audit', 'log', 'monitor'].some(k =>
                        (svc.category || '').toLowerCase().includes(k) ||
                        (svc.name || '').toLowerCase().includes(k) ||
                        (svc.displayName || '').toLowerCase().includes(k)
                    )
                },
                'data-api': {
                    container: 'infra-type-data-api',
                    match: svc => ['api', 'flask', 'cache', 'redis', 'db', 'database', 'mcp', 'postgres', 'mysql', 'maria'].some(k =>
                        (svc.category || '').toLowerCase().includes(k) ||
                        (svc.name || '').toLowerCase().includes(k) ||
                        (svc.displayName || '').toLowerCase().includes(k) ||
                        (svc.technology?.type || '').toLowerCase().includes(k)
                    )
                }
            };

            // Categorize services
            const categorized = {
                'security': [],
                'auth-proxy': [],
                'audit': [],
                'data-api': [],
                'others': []
            };

            services.forEach(svc => {
                if (svc.status !== 'on') return; // Only active services

                let matched = false;
                for (const [catKey, catDef] of Object.entries(typeCategories)) {
                    if (catDef.match(svc)) {
                        categorized[catKey].push(svc);
                        matched = true;
                        break;
                    }
                }
                if (!matched) {
                    categorized['others'].push(svc);
                }
            });

            // Render each category
            function renderTypeTable(containerId, serviceList) {
                const container = document.getElementById(containerId);
                if (!container) return;

                if (serviceList.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-secondary); font-style: italic;">No services in this category</p>';
                    return;
                }

                let html = `
                    <div class="resources-table-container">
                        <table class="infra-type-table">
                            <thead><tr><th>Service</th><th>VM</th><th>URL</th><th>IP:Port</th><th>Container</th><th>Brief</th></tr></thead>
                            <tbody>`;

                serviceList.forEach(svc => {
                    const vm = vms[svc.vmId];
                    const vmName = vm?.name || svc.vmId || '-';
                    const vmIp = vm?.network?.publicIp || '-';
                    const port = svc.network?.internalPort || svc.network?.port || '-';
                    const ipPort = (vmIp !== '-' && port !== '-') ? `${vmIp}:${port}` : '-';
                    const url = svc.urls?.gui || svc.urls?.api || svc.urls?.admin || '-';
                    const container = svc.technology?.image || svc.container || svc.id || '-';
                    const brief = svc.description || svc.brief || svc.notes || '-';

                    html += `
                        <tr>
                            <td><strong>${svc.displayName || svc.name}</strong></td>
                            <td>${vmName}</td>
                            <td>${url !== '-' ? `<a href="${url}" target="_blank" style="color: var(--accent-blue);">${url}</a>` : '-'}</td>
                            <td><code>${ipPort}</code></td>
                            <td><code style="font-size: 0.75rem;">${container}</code></td>
                            <td style="color: var(--text-secondary); font-size: 0.8rem;">${brief}</td>
                        </tr>`;
                });

                html += '</tbody></table></div>';
                container.innerHTML = html;
            }

            renderTypeTable('infra-type-security', categorized['security']);
            renderTypeTable('infra-type-auth-proxy', categorized['auth-proxy']);
            renderTypeTable('infra-type-audit', categorized['audit']);
            renderTypeTable('infra-type-data-api', categorized['data-api']);
            renderTypeTable('infra-type-others', categorized['others']);
        }

        // Infrastructure view toggle (By VM / By Type)
        function initInfraViewToggle() {
            const toggleBtns = document.querySelectorAll('[data-infra-view]');
            const byVmView = document.getElementById('infra-by-vm-view');
            const byTypeView = document.getElementById('infra-by-type-view');
            let byTypeLoaded = false;

            toggleBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const view = this.dataset.infraView;

                    // Update button states
                    toggleBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    // Toggle views
                    if (view === 'by-vm') {
                        byVmView.classList.add('active');
                        byVmView.style.display = 'block';
                        byTypeView.classList.remove('active');
                        byTypeView.style.display = 'none';
                    } else {
                        byVmView.classList.remove('active');
                        byVmView.style.display = 'none';
                        byTypeView.classList.add('active');
                        byTypeView.style.display = 'block';

                        // Lazy load By Type data
                        if (!byTypeLoaded) {
                            loadInfraByTypeData();
                            byTypeLoaded = true;
                        }
                    }
                });
            });
        }

        // Tab Switching with Lazy Loading
        function initTabs() {
            const headerButtons = document.querySelectorAll('[data-dash-tab]');
            const tabContents = document.querySelectorAll('.tab-content');
            const loadedTabs = { resources: true };
            const validTabs = ['status', 'resources', 'orchestrate', 'cost', 'security', 'infra'];
            // Map legacy tab names to new names
            const tabAliases = { 'performance': 'resources' };

            function switchTab(targetTab) {
                // Handle legacy tab names
                if (tabAliases[targetTab]) targetTab = tabAliases[targetTab];
                // Update header buttons and tab contents
                headerButtons.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));

                // Activate the selected tab
                document.querySelectorAll(`[data-dash-tab="${targetTab}"]`).forEach(b => b.classList.add('active'));
                document.getElementById(`${targetTab}-tab`).classList.add('active');

                // Update URL hash
                window.history.replaceState(null, null, `#${targetTab}`);

                if (!loadedTabs[targetTab]) {
                    loadedTabs[targetTab] = true;
                    if (targetTab === 'cost') loadCostData();
                    else if (targetTab === 'resources') loadResourcesData();
                    else if (targetTab === 'infra') loadInfraData();
                }
            }

            // Handle header monitoring buttons
            headerButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetTab = btn.getAttribute('data-dash-tab');
                    switchTab(targetTab);
                });
            });

            // Handle URL hash on page load
            const hash = window.location.hash.slice(1);
            if (hash && (validTabs.includes(hash) || tabAliases[hash])) {
                switchTab(hash);
            }

            // Handle hash changes (browser back/forward)
            window.addEventListener('hashchange', () => {
                const newHash = window.location.hash.slice(1);
                if (newHash && (validTabs.includes(newHash) || tabAliases[newHash])) {
                    switchTab(newHash);
                }
            });
        }

        // Cost Sub-tab Switching
        function initCostSubtabs() {
            const subtabButtons = document.querySelectorAll('.cost-subtab-btn');
            const subtabContents = document.querySelectorAll('.cost-subtab-content');

            subtabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetSubtab = btn.getAttribute('data-subtab');
                    subtabButtons.forEach(b => b.classList.remove('active'));
                    subtabContents.forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(targetSubtab).classList.add('active');
                });
            });
        }

        // Status Sub-tab Switching (Frontend/Backend)
        function initStatusSubtabs() {
            const subtabButtons = document.querySelectorAll('.status-subtab-btn');
            const subtabContents = document.querySelectorAll('.status-subtab-content');

            subtabButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const targetSubtab = btn.getAttribute('data-subtab');
                    subtabButtons.forEach(b => b.classList.remove('active'));
                    subtabContents.forEach(c => c.classList.remove('active'));
                    btn.classList.add('active');
                    document.getElementById(targetSubtab).classList.add('active');
                });
            });
        }

        // View Toggle (Cards/List) - Note: This is a placeholder
        // Actual cards view implementation would require additional HTML structure
        function initViewToggles() {
            const toggleGroups = document.querySelectorAll('.view-toggle-inline');

            toggleGroups.forEach(group => {
                const buttons = group.querySelectorAll('.view-toggle-btn');
                buttons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        buttons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        // View switching logic would go here
                        // For now, just toggle the active state
                    });
                });
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            checkExistingLogin();
            handleOAuthCallback();
            initRebootButtons();
            initTabs();
            initCostSubtabs();
            initInfraViewToggle();

            // Render tables from CONFIG (JSON is source of truth!)
            // Render from local CONFIG first (creates DOM elements)
            if (typeof CONFIG !== 'undefined') {
                renderTablesFromConfig();
            }

            // Check dev server status if not on GitHub Pages
            if (!isGitHubPages) {
                checkDevServerStatus();
            }

            // Refresh data: tries API first, falls back to local .js files on error
            refreshAll();

            // Start auto-refresh if enabled
            if (document.getElementById('auto-refresh').checked) {
                autoRefreshInterval = setInterval(refreshAll, 30000);
            }
        });
    </script>
</body>
</html>
