<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geopolitical Strategic Balance 2025</title>
    <!-- Highcharts/Highmaps Libraries -->
    <script src="https://code.highcharts.com/maps/highmaps.js"></script>
    <!-- Removed data.js as it's not needed for embedded data -->
    <script src="https://code.highcharts.com/maps/modules/exporting.js"></script>
    <script src="https://code.highcharts.com/maps/modules/offline-exporting.js"></script>
    <script src="https://code.highcharts.com/maps/modules/accessibility.js"></script>
    <!-- World Map Data -->
    <script src="https://code.highcharts.com/mapdata/custom/world.js"></script>

    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            margin: 0;
            font-weight: 300;
            color: #ffffff;
            letter-spacing: 1px;
        }

        .subtitle {
            color: #aaaaaa;
            font-size: 0.9rem;
            margin-top: 5px;
        }

        #map-container {
            height: 700px;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            background-color: #2b2b2b;
        }

        /* Legend Styles */
        .legend-wrapper {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 1200px;
            margin: 30px auto;
        }

        .legend-card {
            background: #333;
            padding: 15px;
            border-radius: 6px;
            flex: 1 1 250px;
            border-top: 4px solid #555;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .legend-card h3 {
            margin-top: 0;
            font-size: 1rem;
            border-bottom: 1px solid #444;
            padding-bottom: 8px;
            margin-bottom: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.85rem;
            margin-bottom: 6px;
            color: #ccc;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .error-msg {
            text-align: center;
            color: #ff6b6b;
            display: none;
            padding: 20px;
        }
    </style>
</head>
<body>

    <div class="header">
        <h1>Global Strategic Balance: Late 2025</h1>
        <div class="subtitle">Visualizing the "Stalingrad Spine" and the Red vs. Blue Spheres of Influence</div>
    </div>

    <div id="error-box" class="error-msg">
        ⚠️ <strong>Map cannot load.</strong><br>
        This usually happens in previews that block external scripts.<br>
        Please check your internet connection or try a different browser.
    </div>

    <div id="map-container"></div>

    <div class="legend-wrapper">
        <!-- RUSSIA SPHERE -->
        <div class="legend-card" style="border-color: #8B0000;">
            <h3 style="color:#ff6666">Red Sphere (Russia)</h3>
            <div class="legend-item"><div class="dot" style="background:#8B0000"></div>Russia Core</div>
            <div class="legend-item"><div class="dot" style="background:#CD5C5C"></div>Politically Aligned (Iran, Belarus, DPRK)</div>
            <div class="legend-item"><div class="dot" style="background:#FF8C00"></div>Strong Economic Ties (Kazakhstan, Hungary)</div>
            <div class="legend-item"><div class="dot" style="background:#F0E68C"></div>Weak/Military Controlled (Sahel, Georgia)</div>
        </div>

        <!-- NATO SPHERE -->
        <div class="legend-card" style="border-color: #00008B;">
            <h3 style="color:#6666ff">Blue Sphere (NATO)</h3>
            <div class="legend-item"><div class="dot" style="background:#00008B"></div>NATO Core (USA, EU, Turkey)</div>
            <div class="legend-item"><div class="dot" style="background:#87CEEB"></div>Politically Aligned (Ukraine, Japan, Aus)</div>
            <div class="legend-item"><div class="dot" style="background:#90EE90"></div>Surrounded by NATO (Austria, Swiss)</div>
        </div>

        <!-- NEUTRALS -->
        <div class="legend-card" style="border-color: #666;">
            <h3 style="color:#ccc">Neutrals</h3>
            <div class="legend-item"><div class="dot" style="background:#4F4F4F"></div>Strong Neutral (China, India, Mexico, Brazil)</div>
            <div class="legend-item"><div class="dot" style="background:#2b2b2b; border:1px solid #555"></div>Weak Neutral / Global South</div>
            <div class="legend-item"><div class="dot" style="background:#FFFF00; border: 2px solid red"></div><strong>Volgograd (Stalingrad)</strong></div>
        </div>
    </div>

    <script>
        // Check if Highcharts loaded
        if (typeof Highcharts === 'undefined') {
            document.getElementById('error-box').style.display = 'block';
            document.getElementById('map-container').style.display = 'none';
        }

        // --- DYNAMIC MAP DATA LOADING ---
        let mapGeoJSON = null;
        let mapKeyStr = 'custom/world';

        if (Highcharts.maps) {
            const keys = Object.keys(Highcharts.maps);
            if (keys.length > 0) {
                mapKeyStr = keys[0];
                mapGeoJSON = Highcharts.maps[mapKeyStr];
                console.log("Map loaded via key: " + mapKeyStr);
            } else {
                console.error("Highcharts.maps is empty.");
                document.getElementById('error-box').innerHTML += "<br>ERROR: No map data found in Highcharts.maps.";
            }
        } else {
            console.error("Highcharts.maps is undefined!");
            document.getElementById('error-box').innerHTML += "<br>ERROR: Highcharts.maps object is missing.";
        }

        // --- DATA CONFIGURATION ---

        // Color Palette
        const colors = {
            ru_core: '#8B0000',
            ru_aligned: '#CD5C5C',
            ru_ties: '#FF8C00',
            ru_weak: '#F0E68C',

            nato_core: '#00008B',
            nato_aligned: '#87CEEB',
            nato_surrounded: '#90EE90',

            neutral_strong: '#4F4F4F',
            neutral_weak: '#3a3a3a' // Darker gray for better contrast on dark theme
        };

        // Country Data Classification
        const data = [
            // --- RED SPHERE ---
            { 'hc-key': 'ru', color: colors.ru_core, name: 'Russia', type: 'Core Aggressor' },
            { 'hc-key': 'by', color: colors.ru_aligned, name: 'Belarus', type: 'Political Ally (Union State)' },
            { 'hc-key': 'ir', color: colors.ru_aligned, name: 'Iran', type: 'Military Ally (Drones)' },
            { 'hc-key': 'kp', color: colors.ru_aligned, name: 'north korea', type: 'Military Ally (Ammo)' },
            { 'hc-key': 'sy', color: colors.ru_aligned, name: 'Syria', type: 'Military Base Host' },
            { 'hc-key': 've', color: colors.ru_aligned, name: 'venezuela', type: 'Ideological Ally' },
            { 'hc-key': 'ni', color: colors.ru_aligned, name: 'nicaragua', type: 'Political Ally' },
            { 'hc-key': 'cu', color: colors.ru_aligned, name: 'cuba', type: 'Intelligence Partner' },

            { 'hc-key': 'kz', color: colors.ru_ties, name: 'kazakhstan', type: 'Strong Ties (Pipelines)' },
            { 'hc-key': 'uz', color: colors.ru_ties, name: 'uzbekistan', type: 'Economic Ties' },
            { 'hc-key': 'am', color: colors.ru_ties, name: 'armenia', type: 'Security Dependent' },
            { 'hc-key': 'az', color: colors.ru_ties, name: 'azerbaijan', type: 'Trade Corridor Partner' },
            { 'hc-key': 'rs', color: colors.ru_ties, name: 'serbia', type: 'Cultural/Energy Ties' },
            { 'hc-key': 'hu', color: colors.ru_ties, name: 'hungary', type: 'NATO Member (Russian Energy Ties)' },
            { 'hc-key': 'sk', color: colors.ru_ties, name: 'slovakia', type: 'NATO Member (Political Shift)' },

            { 'hc-key': 'kg', color: colors.ru_weak, name: 'kyrgyzstan', type: 'Weak / Dependent' },
            { 'hc-key': 'tj', color: colors.ru_weak, name: 'tajikistan', type: 'Weak / Mil. Base' },
            { 'hc-key': 'mn', color: colors.ru_weak, name: 'mongolia', type: 'Geographically Trapped' },
            { 'hc-key': 'ge', color: colors.ru_weak, name: 'georgia', type: 'Under Pressure (20% Occupied)' },
            { 'hc-key': 'ml', color: colors.ru_weak, name: 'mali', type: 'Wagner/Africa Corps' },
            { 'hc-key': 'bf', color: colors.ru_weak, name: 'burkina faso', type: 'Wagner/Africa Corps' },
            { 'hc-key': 'cf', color: colors.ru_weak, name: 'central african rep.', type: 'Wagner Controlled' },
            { 'hc-key': 'ne', color: colors.ru_weak, name: 'niger', type: 'Shifted to Russian Orbit' },

            // --- BLUE SPHERE ---
            // NATO Core
            { 'hc-key': 'us', color: colors.nato_core, name: 'united states', type: 'NATO Core' },
            { 'hc-key': 'ca', color: colors.nato_core, name: 'canada', type: 'NATO Core' },
            { 'hc-key': 'gb', color: colors.nato_core, name: 'united kingdom', type: 'NATO Core' },
            { 'hc-key': 'fr', color: colors.nato_core, name: 'france', type: 'NATO Core' },
            { 'hc-key': 'de', color: colors.nato_core, name: 'germany', type: 'NATO Core' },
            { 'hc-key': 'pl', color: colors.nato_core, name: 'poland', type: 'NATO Core (The Shield)' },
            { 'hc-key': 'it', color: colors.nato_core, name: 'italy', type: 'NATO Core' },
            { 'hc-key': 'es', color: colors.nato_core, name: 'spain', type: 'NATO Core' },
            { 'hc-key': 'tr', color: colors.nato_core, name: 'turkey', type: 'NATO Core (The Gatekeeper)' },
            { 'hc-key': 'no', color: colors.nato_core, name: 'norway', type: 'NATO Core' },
            { 'hc-key': 'se', color: colors.nato_core, name: 'sweden', type: 'NATO Core' },
            { 'hc-key': 'fi', color: colors.nato_core, name: 'finland', type: 'NATO Core' },
            { 'hc-key': 'ee', color: colors.nato_core, name: 'estonia', type: 'NATO Core' },
            { 'hc-key': 'lv', color: colors.nato_core, name: 'latvia', type: 'NATO Core' },
            { 'hc-key': 'lt', color: colors.nato_core, name: 'lithuania', type: 'NATO Core' },
            { 'hc-key': 'ro', color: colors.nato_core, name: 'romania', type: 'NATO Core' },
            { 'hc-key': 'bg', color: colors.nato_core, name: 'bulgaria', type: 'NATO Core' },
            { 'hc-key': 'gr', color: colors.nato_core, name: 'greece', type: 'NATO Core' },
            { 'hc-key': 'pt', color: colors.nato_core, name: 'portugal', type: 'NATO Core' },
            { 'hc-key': 'nl', color: colors.nato_core, name: 'netherlands', type: 'NATO Core' },
            { 'hc-key': 'be', color: colors.nato_core, name: 'belgium', type: 'NATO Core' },
            { 'hc-key': 'dk', color: colors.nato_core, name: 'denmark', type: 'NATO Core' },
            { 'hc-key': 'cz', color: colors.nato_core, name: 'czech rep.', type: 'NATO Core' },
            { 'hc-key': 'is', color: colors.nato_core, name: 'iceland', type: 'NATO Core' },
            { 'hc-key': 'al', color: colors.nato_core, name: 'albania', type: 'NATO Core' },
            { 'hc-key': 'hr', color: colors.nato_core, name: 'croatia', type: 'NATO Core' },
            { 'hc-key': 'me', color: colors.nato_core, name: 'montenegro', type: 'NATO Core' },
            { 'hc-key': 'mk', color: colors.nato_core, name: 'north macedonia', type: 'NATO Core' },

            // Blue Aligned
            { 'hc-key': 'ua', color: colors.nato_aligned, name: 'ukraine', type: 'The Frontline / De Facto Ally' },
            { 'hc-key': 'jp', color: colors.nato_aligned, name: 'japan', type: 'Major Non-NATO Ally' },
            { 'hc-key': 'kr', color: colors.nato_aligned, name: 'south korea', type: 'Major Non-NATO Ally' },
            { 'hc-key': 'au', color: colors.nato_aligned, name: 'australia', type: 'AUKUS / Ally' },
            { 'hc-key': 'nz', color: colors.nato_aligned, name: 'new zealand', type: 'Five Eyes' },
            { 'hc-key': 'il', color: colors.nato_aligned, name: 'israel', type: 'Major Non-NATO Ally' },
            { 'hc-key': 'tw', color: colors.nato_aligned, name: 'taiwan', type: 'Strategic Partner' },
            { 'hc-key': 'ph', color: colors.nato_aligned, name: 'philippines', type: 'Treaty Ally' },
            { 'hc-key': 'md', color: colors.nato_aligned, name: 'moldova', type: 'Western Aligned' },

            // Surrounded
            { 'hc-key': 'at', color: colors.nato_surrounded, name: 'austria', type: 'Surrounded by NATO' },
            { 'hc-key': 'ch', color: colors.nato_surrounded, name: 'switzerland', type: 'Surrounded by NATO' },
            { 'hc-key': 'ie', color: colors.nato_surrounded, name: 'ireland', type: 'Surrounded by NATO' },
            { 'hc-key': 'ba', color: colors.nato_surrounded, name: 'bosnia & herz.', type: 'NATO Peacekeeping' },

            // --- NEUTRALS ---
            // Strong Neutrals
            { 'hc-key': 'cn', color: colors.neutral_strong, name: 'china', type: 'Strong Neutral / Superpower' },
            { 'hc-key': 'in', color: colors.neutral_strong, name: 'india', type: 'Strong Neutral (Multi-aligned)' },
            { 'hc-key': 'br', color: colors.neutral_strong, name: 'brazil', type: 'Strong Neutral (BRICS)' },
            { 'hc-key': 'za', color: colors.neutral_strong, name: 'south africa', type: 'Strong Neutral (BRICS)' },
            { 'hc-key': 'sa', color: colors.neutral_strong, name: 'saudi arabia', type: 'Strong Neutral (Energy King)' },
            { 'hc-key': 'id', color: colors.neutral_strong, name: 'indonesia', type: 'Strong Neutral' },
            { 'hc-key': 'mx', color: colors.neutral_strong, name: 'mexico', type: 'Strong Neutral (Non-interventionist)' }
        ];

        // Volgograd Marker (Approximate coords)
        const cityData = [
            {
                name: 'Volgograd (Stalingrad)',
                lat: 48.708,
                lon: 44.513,
                color: '#FFFF00',
                desc: 'The "Dorsal Spine" of Eurasia. Controls the Volga-Don canal and access to the Caspian/Iran.'
            }
        ];


        Highcharts.mapChart('map-container', {
            chart: {
                map: mapGeoJSON || 'custom/world',
                backgroundColor: '#2b2b2b'
            },
            title: { text: '' },
            subtitle: { text: 'Map Source: ' + mapKeyStr },
            mapNavigation: {
                enabled: true,
                enableDoubleClickZoomTo: true,
                buttonOptions: {
                    verticalAlign: 'bottom'
                }
            },
            legend: { enabled: false }, // Using custom HTML legend
            tooltip: {
                backgroundColor: 'rgba(0, 0, 0, 0.85)',
                style: { color: '#F0F0F0' },
                formatter: function () {
                    if (this.point.desc) {
                        return '<b>' + this.point.name + '</b><br>' + this.point.desc;
                    }
                    return '<b>' + this.point.name + '</b><br>' + (this.point.type || 'Weak Neutral');
                }
            },
            series: [{
                name: 'Countries',
                data: data,
                joinBy: 'hc-key',
                nullColor: '#3a3a3a',
                borderColor: '#555',
                borderWidth: 0.5,
                states: {
                    hover: {
                        color: '#a4edba',
                        borderColor: '#fff'
                    }
                }
            }, {
                // City Marker Series for Volgograd
                type: 'mappoint',
                name: 'Strategic Points',
                color: '#FFFF00',
                data: cityData,
                marker: {
                    symbol: 'circle',
                    radius: 6,
                    lineWidth: 2,
                    lineColor: 'red'
                },
                dataLabels: {
                    enabled: true,
                    format: '{point.name}',
                    style: {
                        color: '#FFFF00',
                        textOutline: '2px black',
                        fontWeight: 'normal'
                    },
                    y: -10
                }
            }]
        });
    </script>
    <div style="margin-top: 40px; padding: 20px; border-top: 1px solid #444; font-family: sans-serif; text-align: center; color: #777; font-size: 12px;">
        <h4 style="color: #999; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">Tech Stack & Data</h4>
        <p style="margin: 5px 0;"><strong>JS Library:</strong> <span style="color: #aaa;">Highcharts Maps</span> (SVG Rendering Engine)</p>
        <p style="margin: 5px 0;"><strong>Map Geometry:</strong> <span style="color: #aaa;">Highcharts Map Collection</span> (custom/world.js - Derived from Natural Earth)</p>
        <p style="margin: 5px 0;"><strong>Data Layer:</strong> <span style="color: #aaa;">Custom JSON</span> (Manual Geopolitical Classification)</p>
    </div>
</body>
</html>