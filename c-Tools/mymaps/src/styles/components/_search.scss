// ============================================
// MYMAPS PRO - SEARCH STYLES
// ============================================

@use '../abstracts/variables' as *;
@use '../abstracts/mixins' as *;

// ----------------
// SEARCH CONTAINER
// ----------------

.search-container {
  --menu-offset: 63px; // 44px toggle + 16px spacing + 3px buffer
  position: absolute;
  top: $space-4;
  left: var(--menu-offset);
  z-index: $z-search;
  width: calc(100% - var(--menu-offset) - #{$space-4});
  max-width: 420px;

  @include landscape-mobile {
    max-width: 280px;
  }

  @include mq(sm) {
    width: 340px;
  }

  @include mq(md) {
    width: 380px;
  }

  @include mq(lg) {
    width: 420px;
  }
}

// ----------------
// SEARCH BAR
// ----------------

.search-bar {
  @include glass-panel;
  @include flex-row(flex-start, center, $space-3);
  padding: $space-3 $space-4;
  width: 100%;

  &--focused {
    border-color: $border-accent;
  }

  &--has-results {
    border-radius: $glass-radius $glass-radius 0 0;
  }
}

.search-icon {
  flex-shrink: 0;
  color: $text-muted;
  @include transition(color);

  svg {
    width: 20px;
    height: 20px;
  }

  .search-bar--focused & {
    color: $accent-blue-light;
  }
}

.search-input {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  color: $text-primary;
  font-size: $text-base;

  &::placeholder {
    color: $text-muted;
  }
}

.search-clear {
  flex-shrink: 0;
  @include flex-center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  color: $text-muted;
  background: transparent;
  cursor: pointer;
  @include transition;
  opacity: 0;
  visibility: hidden;

  &--visible {
    opacity: 1;
    visibility: visible;
  }

  &:hover {
    background: $bg-glass-hover;
    color: $text-primary;
  }

  svg {
    width: 14px;
    height: 14px;
  }
}

// ----------------
// SEARCH RESULTS
// ----------------

.search-results {
  @include glass-panel;
  border-radius: 0 0 $glass-radius $glass-radius;
  border-top: none;
  max-height: 60vh;
  overflow-y: auto;
  @include custom-scrollbar;
}

.search-results-header {
  @include flex-row(space-between, center);
  padding: $space-2 $space-4;
  border-bottom: 1px solid $border-glass;
  font-size: $text-xs;
  color: $text-muted;
}

.search-result {
  @include flex-row(flex-start, flex-start, $space-3);
  padding: $space-3 $space-4;
  cursor: pointer;
  @include transition;
  border-bottom: 1px solid rgba($border-glass, 0.5);

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background: $bg-glass-hover;
  }

  &--selected {
    background: rgba($accent-blue, 0.15);
  }
}

.search-result-icon {
  flex-shrink: 0;
  @include flex-center;
  width: 36px;
  height: 36px;
  border-radius: 8px;
  background: rgba($accent-blue, 0.15);
  color: $accent-blue-light;

  svg {
    width: 18px;
    height: 18px;
  }
}

.search-result-content {
  flex: 1;
  min-width: 0;
}

.search-result-name {
  @include flex-row(flex-start, center, $space-2);
  font-weight: 500;
  color: $text-primary;
  margin-bottom: 2px;
}

.search-result-title {
  @include truncate;
}

.search-result-address {
  font-size: $text-sm;
  color: $text-secondary;
  @include truncate;
}

.search-result-meta {
  @include flex-row(flex-start, center, $space-2);
  margin-top: $space-1;
  font-size: $text-xs;
  color: $text-muted;
}

.search-result-distance {
  color: $accent-cyan;
}

.search-result-directions {
  flex-shrink: 0;
}

// ----------------
// LOADING STATE
// ----------------

.search-loading {
  padding: $space-4;
  @include flex-center;
  gap: $space-3;
  color: $text-muted;
}

.search-loading-spinner {
  width: 20px;
  height: 20px;
  border: 2px solid $border-glass;
  border-top-color: $accent-blue;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

// ----------------
// NO RESULTS
// ----------------

.search-no-results {
  padding: $space-6 $space-4;
  text-align: center;
  color: $text-muted;

  svg {
    width: 48px;
    height: 48px;
    margin-bottom: $space-3;
    opacity: 0.5;
  }

  p {
    margin-bottom: $space-2;
  }

  span {
    font-size: $text-sm;
  }
}

// ----------------
// RECENT SEARCHES
// ----------------

.recent-searches {
  padding: $space-2 0;
}

.recent-searches-header {
  @include flex-row(space-between, center);
  padding: $space-2 $space-4;
  font-size: $text-xs;
  color: $text-muted;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.recent-search-item {
  @include flex-row(flex-start, center, $space-3);
  padding: $space-2 $space-4;
  cursor: pointer;
  @include transition;

  &:hover {
    background: $bg-glass-hover;
  }

  svg {
    width: 16px;
    height: 16px;
    color: $text-muted;
  }

  span {
    flex: 1;
    font-size: $text-sm;
    color: $text-secondary;
  }
}

// ----------------
// CATEGORY FILTER
// ----------------

.category-filter {
  @include flex-row(flex-start, center, $space-2);
  padding: $space-3 $space-4;
  overflow-x: auto;
  @include custom-scrollbar;

  &::-webkit-scrollbar {
    height: 4px;
  }
}

.category-chip {
  @include glass-button;
  padding: $space-1 $space-3;
  font-size: $text-xs;
  white-space: nowrap;
  border-radius: 20px;

  &--active {
    background: rgba($accent-blue, 0.25);
    border-color: rgba($accent-blue, 0.4);
    color: $accent-blue-light;
  }
}

// ----------------
// QUICK SEARCH BAR
// ----------------

.quick-search-bar {
  @include flex-row(flex-start, center, $space-2);
  margin-top: $space-2;
}

.quick-search-btn {
  @include glass-panel-sm;
  @include flex-center;
  width: 36px;
  height: 36px;
  padding: 0;
  cursor: pointer;
  @include transition;
  opacity: 0.8;

  &:hover {
    opacity: 1;
    background: $bg-glass-hover;
  }

  &--active {
    opacity: 1;
    background: rgba($accent-blue, 0.25);
    border-color: rgba($accent-blue, 0.4);
    box-shadow: 0 0 0 2px rgba($accent-blue, 0.2);
  }

  &:disabled {
    opacity: 0.4;
    cursor: wait;
  }
}

.quick-search-emoji {
  font-size: 18px;
  line-height: 1;
}
