"use strict";(()=>{function g(){document.querySelectorAll(".card").forEach(e=>{e.addEventListener("mouseenter",()=>{e.style.zIndex="10"}),e.addEventListener("mouseleave",()=>{e.style.zIndex="1",e.style.transform="translateY(0) scale(1) rotateX(0) rotateY(0)"}),e.addEventListener("mousemove",o=>{let n=e.getBoundingClientRect(),i=o.clientX-n.left,s=o.clientY-n.top,a=n.width/2,r=n.height/2,q=(s-r)/10,N=(a-i)/10;e.style.transform=`
                translateY(-12px)
                scale(1.02)
                perspective(1000px)
                rotateX(${q}deg)
                rotateY(${N}deg)
            `})})}function E(){document.querySelectorAll(".card-status").forEach(e=>{setInterval(()=>{Math.random()>.95&&(e.style.animation="pulse 0.5s ease-in-out",setTimeout(()=>{e.style.animation=""},500))},2e3)})}function l(t){let e=document.createElement("div");e.className="notification",e.textContent=t,document.body.appendChild(e),setTimeout(()=>{e.classList.add("closing"),setTimeout(()=>e.remove(),300)},2e3)}function y(t){let e=t.match(/ssh:\/\/(.+)@(.+)/);if(!e)return null;let o=e[1],n=e[2],i=`ssh -i ~/.ssh/matomo_key ${o}@${n}`;return{username:o,host:n,command:i}}function L(t){let e=document.createElement("div");e.className="ssh-modal-overlay",e.innerHTML=`
        <div class="ssh-modal">
            <h3>SSH Connection to ${t.host}</h3>
            <div class="ssh-command">
                <code>${t.command}</code>
                <button class="copy-btn" data-action="copy">Copy</button>
            </div>
            <p class="ssh-instruction">Choose how to connect:</p>
            <div class="ssh-options">
                <button class="ssh-option-btn" data-action="terminal">
                    Open in Terminal
                </button>
                <button class="ssh-option-btn" data-action="vscode">
                    Open in VS Code
                </button>
            </div>
            <button class="close-modal-btn" data-action="close">Close</button>
        </div>
    `,e.addEventListener("click",o=>{let i=o.target.dataset.action;o.target===e||i==="close"?p():i==="copy"?b(t.command):i==="terminal"?V(t.command):i==="vscode"&&O(t)}),document.body.appendChild(e)}function p(){let t=document.querySelector(".ssh-modal-overlay");t&&t.remove()}function b(t){navigator.clipboard.writeText(t).then(()=>{l("SSH command copied to clipboard!")})}function V(t){let e=/Linux/.test(navigator.userAgent),o=/Mac/.test(navigator.userAgent);e?window.location.href=`gnome-terminal://execute/${encodeURIComponent(t)}`:o?window.location.href=`terminal://execute/${encodeURIComponent(t)}`:(b(t),l("Command copied! Paste it in your terminal.")),p()}function O(t){let{username:e,host:o}=t;window.open(`vscode://vscode-remote/ssh-remote+${e}@${o}/home/${e}`,"_blank"),p()}var P={analytics:"https://analytics.diegonmarcos.com",sync:"https://sync.diegonmarcos.com","cloud-dashboard":"#pending",mail:"#pending",terminal:"#pending","agentic-dashboard":"#pending",gitea:"#pending",openvpn:"#pending","vps-oracle":"https://cloud.oracle.com/","vps-gcloud":"https://console.cloud.google.com/","vm-servicesserver1":"ssh://ubuntu@129.151.228.66","vm-webserver1":"ssh://ubuntu@130.110.251.193","vm-arm":"ssh://ubuntu@pending","vm-gcloud":"ssh://diego@pending","npm-services":"http://129.151.228.66:81","npm-web":"http://130.110.251.193:81","npm-arm":"#pending","npm-gcloud":"#pending","matomo-db":"#internal","mail-db":"#pending","n8n-ai-db":"#pending","n8n-infra":"https://n8n.diegonmarcos.com","n8n-ai":"#pending","flask-server":"#pending","flask-cloud-dashboard":"#pending",linktree:"https://linktree.diegonmarcos.com"};function v(t){let e=P[t];e&&(console.log(`Navigating to ${t}: ${e}`),e.startsWith("ssh://")?_(e):e==="#pending"?l("This service is under development."):e.startsWith("http")?window.open(e,"_blank"):window.location.href=e)}function _(t){let e=y(t);if(e){if(e.host==="pending"||e.host.includes("pending")){l("This VM is not yet configured. IP address pending.");return}L(e)}}var h=["cards-front","cards-back","tree","architecture","ai-architecture","backlog","monitoring","resources"];function w(){let t=window.location.hash.slice(1);return h.includes(t)?t:"cards-front"}function m(t,e=!0){let o=document.querySelectorAll(".view-btn"),n={"cards-front":document.getElementById("cards-front-view"),"cards-back":document.getElementById("cards-back-view"),tree:document.getElementById("tree-view"),architecture:document.getElementById("architecture-view"),"ai-architecture":document.getElementById("ai-architecture-view"),backlog:document.getElementById("backlog-view"),monitoring:document.getElementById("monitoring-view"),resources:document.getElementById("resources-view")};o.forEach(i=>{i.dataset.view===t?i.classList.add("active"):i.classList.remove("active")}),Object.keys(n).forEach(i=>{let s=n[i];s&&(i===t?s.classList.add("active"):s.classList.remove("active"))}),e&&window.history.pushState({view:t},"",`#${t}`)}function S(){let t=document.querySelectorAll(".view-btn"),e=w();m(e,!1),window.history.replaceState({view:e},"",`#${e}`),t.forEach(o=>{o.addEventListener("click",()=>{let n=o.dataset.view;n&&h.includes(n)&&m(n)})}),window.addEventListener("popstate",o=>{var n;(n=o.state)!=null&&n.view&&h.includes(o.state.view)?m(o.state.view,!1):m(w(),!1)})}function T(){document.querySelectorAll(".tree-node[data-expanded]").forEach(e=>{let o=e.querySelector(".node-header"),n=e.querySelector(".expand-icon"),i=e.nextElementSibling;o&&(i!=null&&i.classList.contains("tree-children"))&&o.addEventListener("click",s=>{s.stopPropagation(),e.dataset.expanded==="true"?(e.dataset.expanded="false",n==null||n.classList.remove("expanded"),i.classList.remove("expanded")):(e.dataset.expanded="true",n==null||n.classList.add("expanded"),i.classList.add("expanded"))})})}function x(){document.querySelectorAll(".tree-node.service-node.clickable").forEach(e=>{e.addEventListener("click",()=>{let o=e.dataset.service;if(o){let n=new CustomEvent("service-click",{detail:{service:o}});document.dispatchEvent(n)}})})}function z(){document.querySelectorAll(".tree-node[data-expanded]").forEach(e=>{var n;e.dataset.expanded="true",(n=e.querySelector(".expand-icon"))==null||n.classList.add("expanded");let o=e.nextElementSibling;o!=null&&o.classList.contains("tree-children")&&o.classList.add("expanded")})}function U(){document.querySelectorAll(".tree-node[data-expanded]").forEach(e=>{var n;e.dataset.expanded="false",(n=e.querySelector(".expand-icon"))==null||n.classList.remove("expanded");let o=e.nextElementSibling;o!=null&&o.classList.contains("tree-children")&&o.classList.remove("expanded")})}function C(){let t=document.getElementById("expand-all"),e=document.getElementById("collapse-all");t==null||t.addEventListener("click",z),e==null||e.addEventListener("click",U)}function M(){let t=document.querySelectorAll(".tree-filter-btn"),e=document.querySelector(".tree-container");t.forEach(o=>{o.addEventListener("click",()=>{t.forEach(i=>i.classList.remove("active")),o.classList.add("active");let n=o.dataset.filter||"all";e&&(e.dataset.filter=n)})})}var k="cloud-dashboard-theme",R="minimalistic";function H(){let t=localStorage.getItem(k);return t==="minimalistic"||t==="blurred"?t:R}function I(t){document.documentElement.setAttribute("data-theme",t),localStorage.setItem(k,t),Z(t)}function Y(){let e=H()==="minimalistic"?"blurred":"minimalistic";I(e)}function Z(t){let e=document.querySelector(".theme-label");e&&(e.textContent=t==="minimalistic"?"Blurred":"Minimalistic")}function B(){let t=H();I(t);let e=document.getElementById("theme-toggle");e&&e.addEventListener("click",Y)}var d=[100,80,60,40,30,20],f=2,A="cloud-dashboard-zoom",c=f;function $(){let t=document.getElementById("zoom-out"),e=document.getElementById("zoom-in"),o=document.getElementById("zoom-reset"),n=document.getElementById("zoom-level");if(!t||!e||!o||!n)return;let i=localStorage.getItem(A);if(i){let r=d.indexOf(parseInt(i,10));r!==-1&&(c=r)}u(),s(),t.addEventListener("click",()=>{c<d.length-1&&(c++,u(),s(),a())}),e.addEventListener("click",()=>{c>0&&(c--,u(),s(),a())}),o.addEventListener("click",()=>{c=f,u(),s(),a()});function s(){let r=d[c];n.textContent=`${r}%`,e.disabled=c===0,t.disabled=c===d.length-1,o.disabled=c===f}function a(){localStorage.setItem(A,d[c].toString())}}function u(){let e=d[c]/100,o=document.documentElement,n=document.getElementById("cards-view"),s=o.getAttribute("data-theme")==="blurred"?280:220,a=Math.round(s*e),r=1+(1-e)*2.5;o.style.setProperty("--card-min-width",`${a}px`),o.style.setProperty("--zoom-scale",e.toString()),o.style.setProperty("--hover-scale",r.toFixed(2)),n&&n.style.setProperty("--card-content-scale",e.toString())}document.addEventListener("DOMContentLoaded",()=>{B(),$(),g(),E(),document.querySelectorAll(".card").forEach(e=>{e.addEventListener("click",()=>{let o=e.dataset.service;o&&v(o)})}),S(),T(),x(),C(),M(),document.addEventListener("service-click",e=>{let o=e.detail.service;o&&v(o)}),document.querySelectorAll(".node-copy-btn").forEach(e=>{e.addEventListener("click",o=>{o.stopPropagation();let n=e.dataset.copy;n&&navigator.clipboard.writeText(n).then(()=>{e.style.color="var(--accent-green)",e.style.borderColor="var(--accent-green)",setTimeout(()=>{e.style.color="",e.style.borderColor=""},1e3)})})}),document.querySelectorAll(".node-url-btn").forEach(e=>{e.addEventListener("click",o=>{o.stopPropagation();let n=e.dataset.url;n&&window.open(n,"_blank")})}),document.querySelectorAll(".tree-action-btn.url-btn").forEach(e=>{e.addEventListener("click",o=>{o.stopPropagation();let n=e.dataset.url;n&&window.open(n,"_blank")})}),document.querySelectorAll(".vm-action-btn.btn-url").forEach(e=>{e.addEventListener("click",o=>{o.stopPropagation();let n=e.dataset.url;n&&window.open(n,"_blank")})}),document.querySelectorAll(".vm-action-btn.btn-ssh").forEach(e=>{e.addEventListener("click",o=>{o.stopPropagation();let n=e.dataset.copy;n&&navigator.clipboard.writeText(n).then(()=>{e.classList.add("copied"),setTimeout(()=>{e.classList.remove("copied")},1e3)})})})});})();
