"use strict";(()=>{var de=Object.defineProperty,ue=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var q=(t,e,n)=>e in t?de(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,k=(t,e)=>{for(var n in e||(e={}))pe.call(e,n)&&q(t,n,e[n]);if(R)for(var n of R(e))fe.call(e,n)&&q(t,n,e[n]);return t},U=(t,e)=>ue(t,me(e));var m=(t,e,n)=>new Promise((o,i)=>{var r=c=>{try{l(n.next(c))}catch(p){i(p)}},a=c=>{try{l(n.throw(c))}catch(p){i(p)}},l=c=>c.done?o(c.value):Promise.resolve(c.value).then(r,a);l((n=n.apply(t,e)).next())});function V(t,e={}){let{intensity:n=10,scale:o=1.02,lift:i=12}=e;t.addEventListener("mouseenter",()=>{t.style.zIndex="10"}),t.addEventListener("mouseleave",()=>{t.style.zIndex="1",t.style.transform="translateY(0) scale(1) rotateX(0) rotateY(0)"}),t.addEventListener("mousemove",r=>{let a=t.getBoundingClientRect(),l=r.clientX-a.left,c=r.clientY-a.top,p=a.width/2,T=a.height/2,E=(c-T)/n,w=(p-l)/n;t.style.transform=`
            translateY(-${i}px)
            scale(${o})
            perspective(1000px)
            rotateX(${E}deg)
            rotateY(${w}deg)
        `})}function N(){document.querySelectorAll(".card").forEach(e=>{var o;let n=e.dataset.url;if(n&&!e.querySelector(".card-link-overlay")){let i=document.createElement("a");i.href=n,i.target="_blank",i.rel="noopener",i.className="card-link-overlay",i.style.cssText=`
                position: absolute;
                inset: 0;
                z-index: 5;
            `,i.setAttribute("aria-label",((o=e.querySelector("h3"))==null?void 0:o.textContent)||"Open link"),e.style.position="relative",e.appendChild(i)}V(e)})}function z(){document.querySelectorAll(".app-card").forEach(e=>{V(e,{intensity:8,scale:1.01,lift:8})})}function j(){document.querySelectorAll(".card-status").forEach(e=>{setInterval(()=>{Math.random()>.95&&(e.style.animation="pulse 0.5s ease-in-out",setTimeout(()=>{e.style.animation=""},500))},2e3)})}function s(t){let e=document.createElement("div");e.className="notification",e.textContent=t,document.body.appendChild(e),setTimeout(()=>{e.classList.add("closing"),setTimeout(()=>e.remove(),300)},2e3)}function G(t){let e=t.match(/ssh:\/\/(.+)@(.+)/);if(!e)return null;let n=e[1],o=e[2],i=`ssh -i ~/.ssh/matomo_key ${n}@${o}`;return{username:n,host:o,command:i}}function Y(t){let e=document.createElement("div");e.className="ssh-modal-overlay",e.innerHTML=`
        <div class="ssh-modal">
            <h3>SSH Connection to ${t.host}</h3>
            <div class="ssh-command">
                <code>${t.command}</code>
                <button class="copy-btn" data-action="copy">Copy</button>
            </div>
            <p class="ssh-instruction">Choose how to connect:</p>
            <div class="ssh-options">
                <button class="ssh-option-btn" data-action="terminal">
                    Open in Terminal
                </button>
                <button class="ssh-option-btn" data-action="vscode">
                    Open in VS Code
                </button>
            </div>
            <button class="close-modal-btn" data-action="close">Close</button>
        </div>
    `,e.addEventListener("click",n=>{let i=n.target.dataset.action;n.target===e||i==="close"?C():i==="copy"?Z(t.command):i==="terminal"?ge(t.command):i==="vscode"&&ve(t)}),document.body.appendChild(e)}function C(){let t=document.querySelector(".ssh-modal-overlay");t&&t.remove()}function Z(t){navigator.clipboard.writeText(t).then(()=>{s("SSH command copied to clipboard!")})}function ge(t){let e=/Linux/.test(navigator.userAgent),n=/Mac/.test(navigator.userAgent);e?window.location.href=`gnome-terminal://execute/${encodeURIComponent(t)}`:n?window.location.href=`terminal://execute/${encodeURIComponent(t)}`:(Z(t),s("Command copied! Paste it in your terminal.")),C()}function ve(t){let{username:e,host:n}=t;window.open(`vscode://vscode-remote/ssh-remote+${e}@${n}/home/${e}`,"_blank"),C()}var he={analytics:"https://analytics.diegonmarcos.com","cloud-dashboard":"#pending",mail:"#pending",terminal:"#pending","agentic-dashboard":"#pending",gitea:"#pending",openvpn:"#pending","vps-oracle":"https://cloud.oracle.com/","vps-gcloud":"https://console.cloud.google.com/","vm-servicesserver1":"ssh://ubuntu@129.151.228.66","vm-webserver1":"ssh://ubuntu@130.110.251.193","vm-gcloud":"ssh://diego@pending","npm-services":"http://129.151.228.66:81","npm-web":"http://130.110.251.193:81","npm-gcloud":"#pending","matomo-db":"#internal","mail-db":"#pending","n8n-infra":"https://n8n.diegonmarcos.com","flask-server":"#pending","flask-cloud-dashboard":"#pending",linktree:"https://linktree.diegonmarcos.com"};function M(t){let e=he[t];e&&(console.log(`Navigating to ${t}: ${e}`),e.startsWith("ssh://")?ye(e):e==="#pending"?s("This service is under development."):e.startsWith("http")?window.open(e,"_blank"):window.location.href=e)}function ye(t){let e=G(t);if(e){if(e.host==="pending"||e.host.includes("pending")){s("This VM is not yet configured. IP address pending.");return}Y(e)}}var A=["cards-front","cards-back","list-front","list-back","tree","architecture","ai-architecture","backlog","resources"];function W(){let t=window.location.hash.slice(1);return A.includes(t)?t:"cards-front"}function L(t,e=!0){let n=document.querySelectorAll(".view-btn[data-view]"),o={"cards-front":document.getElementById("cards-front-view"),"cards-back":document.getElementById("cards-back-view"),tree:document.getElementById("tree-view"),architecture:document.getElementById("architecture-view"),"ai-architecture":document.getElementById("ai-architecture-view"),backlog:document.getElementById("backlog-view"),"list-front":document.getElementById("list-front-view"),"list-back":document.getElementById("list-back-view"),resources:document.getElementById("resources-view")};n.forEach(i=>{i.dataset.view===t?i.classList.add("active"):i.classList.remove("active")}),Object.keys(o).forEach(i=>{let r=o[i];r&&(i===t?r.classList.add("active"):r.classList.remove("active"))}),e&&window.history.pushState({view:t},"",`#${t}`)}function X(){let t=document.querySelectorAll(".view-btn[data-view]");if(t.length===0)return;let e=W();L(e,!1),window.history.replaceState({view:e},"",`#${e}`),t.forEach(n=>{n.addEventListener("click",()=>{let o=n.dataset.view;o&&A.includes(o)&&L(o)})}),window.addEventListener("popstate",n=>{var o;(o=n.state)!=null&&o.view&&A.includes(n.state.view)?L(n.state.view,!1):L(W(),!1)})}function K(){document.querySelectorAll(".tree-node[data-expanded]").forEach(e=>{let n=e.querySelector(".node-header"),o=e.querySelector(".expand-icon"),i=e.nextElementSibling;n&&(i!=null&&i.classList.contains("tree-children"))&&n.addEventListener("click",r=>{r.stopPropagation(),e.dataset.expanded==="true"?(e.dataset.expanded="false",o==null||o.classList.remove("expanded"),i.classList.remove("expanded")):(e.dataset.expanded="true",o==null||o.classList.add("expanded"),i.classList.add("expanded"))})})}function Q(){document.querySelectorAll(".tree-node.service-node.clickable").forEach(e=>{e.addEventListener("click",()=>{let n=e.dataset.service;if(n){let o=new CustomEvent("service-click",{detail:{service:n}});document.dispatchEvent(o)}})})}function Ee(){document.querySelectorAll(".tree-node[data-expanded]").forEach(e=>{var o;e.dataset.expanded="true",(o=e.querySelector(".expand-icon"))==null||o.classList.add("expanded");let n=e.nextElementSibling;n!=null&&n.classList.contains("tree-children")&&n.classList.add("expanded")})}function we(){document.querySelectorAll(".tree-node[data-expanded]").forEach(e=>{var o;e.dataset.expanded="false",(o=e.querySelector(".expand-icon"))==null||o.classList.remove("expanded");let n=e.nextElementSibling;n!=null&&n.classList.contains("tree-children")&&n.classList.remove("expanded")})}function J(){let t=document.getElementById("expand-all"),e=document.getElementById("collapse-all");t==null||t.addEventListener("click",Ee),e==null||e.addEventListener("click",we)}function ee(){let t=document.querySelectorAll(".tree-filter-btn"),e=document.querySelector(".tree-container");t.forEach(n=>{n.addEventListener("click",()=>{t.forEach(i=>i.classList.remove("active")),n.classList.add("active");let o=n.dataset.filter||"all";e&&(e.dataset.filter=o)})})}var te="cloud-dashboard-theme",Le="blurred";function ne(){let t=localStorage.getItem(te);return t==="minimalistic"||t==="blurred"?t:Le}function oe(t){document.documentElement.setAttribute("data-theme",t),localStorage.setItem(te,t),xe(t)}function Se(){let e=ne()==="minimalistic"?"blurred":"minimalistic";oe(e)}function xe(t){let e=document.querySelector(".theme-label");e&&(e.textContent=t==="minimalistic"?"Blurred":"Minimalistic")}function ie(){let t=ne();oe(t);let e=document.getElementById("theme-toggle");e&&e.addEventListener("click",Se)}var f=[100,80,60,40,30,20],I=2,se="cloud-dashboard-zoom",d=I;function re(){let t=document.getElementById("zoom-out"),e=document.getElementById("zoom-in"),n=document.getElementById("zoom-reset"),o=document.getElementById("zoom-level");if(!t||!e||!n||!o)return;let i=localStorage.getItem(se);if(i){let l=f.indexOf(parseInt(i,10));l!==-1&&(d=l)}S(),r(),t.addEventListener("click",()=>{d<f.length-1&&(d++,S(),r(),a())}),e.addEventListener("click",()=>{d>0&&(d--,S(),r(),a())}),n.addEventListener("click",()=>{d=I,S(),r(),a()});function r(){let l=f[d];o.textContent=`${l}%`,e.disabled=d===0,t.disabled=d===f.length-1,n.disabled=d===I}function a(){localStorage.setItem(se,f[d].toString())}}function S(){let e=f[d]/100,n=document.documentElement,o=document.getElementById("cards-view"),r=n.getAttribute("data-theme")==="blurred"?280:220,a=Math.round(r*e),l=1+(1-e)*2.5;n.style.setProperty("--card-min-width",`${a}px`),n.style.setProperty("--zoom-scale",e.toString()),n.style.setProperty("--hover-scale",l.toFixed(2)),o&&o.style.setProperty("--card-content-scale",e.toString())}var P="local";function be(){return typeof LOCAL_DATA!="undefined"&&LOCAL_DATA!==null}function x(){return P}function Te(){be()?(P="local",console.log("[DataLoader] Initialized with LOCAL_DATA")):(P="api",console.log("[DataLoader] LOCAL_DATA not found, using API mode"))}Te();var ke="https://api.diegonmarcos.com/api",h="https://api.diegonmarcos.com/rust",Ce="Ov23liQPvqLvZgQQrI7C",Me=window.location.origin+"/cloud/oauth-callback.html",Ae=["diegonmarcos"],Ie="github_token",Pe="github_user";function $e(){let t=localStorage.getItem(Pe);if(!t)return null;try{return JSON.parse(t)}catch(e){return null}}function He(){return localStorage.getItem(Ie)}function y(){let t=$e();return t!==null&&Ae.includes(t.login)}function H(){let t=Math.random().toString(36).substring(2);sessionStorage.setItem("oauth_state",t);let e=`https://github.com/login/oauth/authorize?client_id=${Ce}&redirect_uri=${encodeURIComponent(Me)}&scope=read:user&state=${t}`;window.location.href=e}function B(o){return m(this,arguments,function*(t,e={},n=ke){let i=He();if(!i)throw new Error("Not authenticated");let r=k({Authorization:`Bearer ${i}`,"Content-Type":"application/json"},e.headers);return fetch(`${n}${t}`,U(k({},e),{headers:r}))})}function ae(){let t=y();document.querySelectorAll(".admin-actions").forEach(e=>{t?e.classList.remove("disabled"):e.classList.add("disabled")})}function le(){document.addEventListener("auth-changed",ae),ae(),Oe(),console.log("[AdminActions] Initialized, authorized:",y())}var Be="oci-flex",$=null;function b(){return m(this,null,function*(){if($)return $;try{let t=yield fetch(`${h}/health/ids`,{signal:AbortSignal.timeout(5e3)});if(!t.ok)return null;let e=yield t.json();for(let[n,o]of Object.entries(e.vms||{}))if(o.label===Be)return $=n,n}catch(t){}return null})}function u(t,e){let n=document.getElementById("flex-status-indicator");n&&(n.className="flex-server-indicator "+t,n.title=e||`Flex Server: ${t}`)}function v(t,e){let n=document.getElementById(t);n&&(e?(n.classList.add("loading"),n.disabled=!0):(n.classList.remove("loading"),n.disabled=!1))}function ce(){return m(this,null,function*(){try{let t=yield b();if(!t)return"unknown";let e=yield fetch(`${h}/health/${t}`);if(!e.ok)return"unknown";let n=yield e.json();return n.health==="online"||n.ping===!0?"online":n.provider_state==="STOPPED"||n.provider_state==="TERMINATED"?"offline":n.provider_state==="STARTING"?"starting":n.provider_state==="STOPPING"?"stopping":"offline"}catch(t){return"unknown"}})}function De(){return m(this,null,function*(){if(x()==="local")return s("Cannot control VMs in Local mode. Switch to API mode."),!1;if(!y())return s("Login required to control Flex server"),H(),!1;try{let t=yield b();if(!t)return s("Could not discover Flex VM"),!1;v("flex-start",!0),u("starting","Starting Flex Server..."),s("Starting Flex Server...");let e=yield B(`/vms/${t}/start`,{method:"POST"},h),n=yield e.json();return e.ok?(s(n.message||"Flex Server start initiated"),D(),!0):(u("unknown"),s(n.error||"Failed to start Flex Server"),!1)}catch(t){return u("unknown"),s("Error: "+(t instanceof Error?t.message:"Unknown error")),!1}finally{v("flex-start",!1)}})}function Fe(){return m(this,null,function*(){if(x()==="local")return s("Cannot control VMs in Local mode. Switch to API mode."),!1;if(!y())return s("Login required to control Flex server"),H(),!1;try{let t=yield b();if(!t)return s("Could not discover Flex VM"),!1;v("flex-stop",!0),u("stopping","Stopping Flex Server..."),s("Stopping Flex Server...");let e=yield B(`/vms/${t}/stop`,{method:"POST"},h),n=yield e.json();return e.ok?(s(n.message||"Flex Server stop initiated"),D(),!0):(u("unknown"),s(n.error||"Failed to stop Flex Server"),!1)}catch(t){return u("unknown"),s("Error: "+(t instanceof Error?t.message:"Unknown error")),!1}finally{v("flex-stop",!1)}})}function _e(){return m(this,null,function*(){if(x()==="local")return s("Cannot control VMs in Local mode. Switch to API mode."),!1;if(!y())return s("Login required to control Flex server"),H(),!1;if(!confirm("Force reset Flex Server? This is a hard reset and may cause data loss."))return!1;try{let t=yield b();if(!t)return s("Could not discover Flex VM"),!1;v("flex-reset",!0),u("starting","Resetting Flex Server..."),s("Force resetting Flex Server...");let e=yield B(`/vms/${t}/reset`,{method:"POST"},h),n=yield e.json();return e.ok?(s(n.message||"Flex Server reset initiated"),D(),!0):(u("unknown"),s(n.error||"Failed to reset Flex Server"),!1)}catch(t){return u("unknown"),s("Error: "+(t instanceof Error?t.message:"Unknown error")),!1}finally{v("flex-reset",!1)}})}var g=null;function D(){g&&clearInterval(g);let t=0,e=30,n=()=>m(this,null,function*(){t++;let o=yield ce();u(o),(o==="online"||o==="offline"||t>=e)&&(g&&(clearInterval(g),g=null),o==="online"?s("Flex Server is now online"):o==="offline"&&s("Flex Server is now offline"))});g=window.setInterval(n,1e4),n()}function Oe(){let t=document.getElementById("flex-start"),e=document.getElementById("flex-stop"),n=document.getElementById("flex-reset");t&&t.addEventListener("click",()=>De()),e&&e.addEventListener("click",()=>Fe()),n&&n.addEventListener("click",()=>_e()),Re()}function Re(){return m(this,null,function*(){u("unknown","Checking Flex Server status...");let t=yield ce();u(t)})}var qe={ssh:{title:"SSH Access (Port 22)",content:`<p><strong>Key-Only Authentication</strong></p>
            <ul>
                <li>Password auth disabled</li>
                <li>Root login disabled</li>
                <li>Ed25519/RSA keys only</li>
                <li>Fail2ban protection</li>
            </ul>`},http:{title:"HTTP Redirect (Port 80)",content:`<p><strong>Automatic HTTPS Redirect</strong></p>
            <ul>
                <li>301 redirect to HTTPS</li>
                <li>HSTS headers enabled</li>
                <li>No plain HTTP content</li>
            </ul>`},https:{title:"HTTPS Traffic (Port 443)",content:`<p><strong>TLS 1.3 Encryption</strong></p>
            <ul>
                <li>Let's Encrypt certificates</li>
                <li>Auto-renewal via certbot</li>
                <li>A+ SSL Labs rating</li>
                <li>OCSP stapling enabled</li>
            </ul>`},mail:{title:"Mail Ports (25/587/993)",content:`<p><strong>Mailu Mail Server</strong></p>
            <ul>
                <li>SMTP: 25 (relay), 587 (submission)</li>
                <li>IMAPS: 993 (encrypted)</li>
                <li>SPF, DKIM, DMARC configured</li>
                <li>Rspamd anti-spam</li>
            </ul>`},firewall:{title:"Cloud Firewall",content:`<p><strong>Defense in Depth</strong></p>
            <ul>
                <li>OCI/GCP Security Lists</li>
                <li>UFW on host</li>
                <li>Docker network isolation</li>
                <li>Default deny inbound</li>
            </ul>`},server:{title:"Server Host",content:`<p><strong>Hardened Linux Host</strong></p>
            <ul>
                <li>Unattended security updates</li>
                <li>Minimal attack surface</li>
                <li>Docker isolation</li>
                <li>Log monitoring</li>
            </ul>`},nginx:{title:"Nginx Proxy Manager",content:`<p><strong>Reverse Proxy</strong></p>
            <ul>
                <li>SSL termination</li>
                <li>Virtual hosts routing</li>
                <li>Rate limiting</li>
                <li>Security headers</li>
            </ul>`}};window.openModal=function(t){let e=qe[t];if(!e)return;let n=document.getElementById("info-modal");n&&n.remove();let o=document.createElement("div");o.id="info-modal",o.className="arch-modal",o.innerHTML=`
        <div class="arch-modal-backdrop" onclick="closeModal()"></div>
        <div class="arch-modal-content">
            <button class="arch-modal-close" onclick="closeModal()">&times;</button>
            <h3>${e.title}</h3>
            ${e.content}
        </div>
    `,document.body.appendChild(o),requestAnimationFrame(()=>o.classList.add("active"))};window.closeModal=function(){let t=document.getElementById("info-modal");t&&(t.classList.remove("active"),setTimeout(()=>t.remove(),200))};document.addEventListener("DOMContentLoaded",()=>{ie(),re(),Ne(),N(),z(),j(),document.querySelectorAll(".card").forEach(e=>{e.addEventListener("click",()=>{let n=e.dataset.service;n&&M(n)})}),X(),K(),Q(),J(),ee(),le(),document.addEventListener("service-click",e=>{let n=e.detail.service;n&&M(n)}),document.querySelectorAll(".node-copy-btn").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation();let o=e.dataset.copy;o&&navigator.clipboard.writeText(o).then(()=>{e.style.color="var(--accent-green)",e.style.borderColor="var(--accent-green)",setTimeout(()=>{e.style.color="",e.style.borderColor=""},1e3)})})}),document.querySelectorAll(".node-url-btn").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation();let o=e.dataset.url;o&&window.open(o,"_blank")})}),document.querySelectorAll(".tree-action-btn.url-btn").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation();let o=e.dataset.url;o&&window.open(o,"_blank")})}),document.querySelectorAll(".vm-action-btn.btn-url").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation();let o=e.dataset.url;o&&window.open(o,"_blank")})}),document.querySelectorAll(".vm-action-btn.btn-ssh").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation();let o=e.dataset.copy;o&&navigator.clipboard.writeText(o).then(()=>{e.classList.add("copied"),setTimeout(()=>{e.classList.remove("copied")},1e3)})})}),Ue(),Ve()});function Ue(){let t=document.getElementById("wake-hours"),e=document.getElementById("wake-bandwidth");if(!t||!e)return;let n=.0096,o=2.55,i=.0085;function r(){let a=parseFloat(t.value)||0,l=parseFloat(e.value)||0,c=a*n,p=l*i,T=c+o+p,E=document.getElementById("wake-hours-display"),w=document.getElementById("wake-bw-display"),F=document.getElementById("wake-compute-cost"),_=document.getElementById("wake-bandwidth-cost"),O=document.getElementById("wake-total-cost");E&&(E.textContent=a.toString()),w&&(w.textContent=l.toString()),F&&(F.textContent=`$${c.toFixed(2)}`),_&&(_.textContent=`$${p.toFixed(2)}`),O&&(O.textContent=`$${T.toFixed(2)}`)}t.addEventListener("input",r),e.addEventListener("input",r),r()}function Ve(){let t=document.querySelectorAll("[data-product-filter]"),e=document.querySelectorAll(".card[data-product-category]");t.length&&t.forEach(n=>{n.addEventListener("click",()=>{let o=n.dataset.productFilter;t.forEach(i=>i.classList.remove("active")),n.classList.add("active"),e.forEach(i=>{let r=i.dataset.productCategory,a=i.classList.contains("card-placeholder");o==="all"?i.style.display=a?"none":"":r===o?i.style.display="":i.style.display="none"})})})}function Ne(){let t=document.querySelector(".view-toggle");if(t){let e=t.querySelectorAll(".view-group");e.forEach(n=>{n.querySelectorAll(".view-btn").forEach(i=>{i.addEventListener("click",()=>{e.forEach(r=>r.classList.remove("group-active")),n.classList.add("group-active")})})})}ze()}function ze(){let t=document.querySelectorAll(".nav-main-btn"),e=document.getElementById("nav-products"),n=document.getElementById("nav-c3");t.length&&t.forEach(o=>{o.addEventListener("click",()=>{let i=o.dataset.section;t.forEach(r=>r.classList.remove("active")),o.classList.add("active"),i==="products"?(e&&(e.classList.add("active"),e.style.display="flex"),n&&(n.classList.remove("active"),n.style.display="none")):i==="c3"&&(n&&(n.classList.add("active"),n.style.display="flex"),e&&(e.classList.remove("active"),e.style.display="none"))})})}})();
